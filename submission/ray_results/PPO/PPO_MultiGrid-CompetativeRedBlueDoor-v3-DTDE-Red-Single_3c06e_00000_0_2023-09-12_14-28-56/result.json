{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5658658500450353, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0013918964029774846, "policy_loss": -0.016637990285137978, "vf_loss": 0.012644772312099425, "vf_explained_var": 0.19780667753269274, "kl": 0.013006608936181708, "entropy": 1.9331462426731985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.7055011429319, "num_env_steps_trained_throughput_per_sec": 144.7055011429319, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 27642.274, "sample_time_ms": 16652.471, "learn_time_ms": 10928.555, "learn_throughput": 366.014, "synch_weights_time_ms": 60.345}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "3c06e_00000", "date": "2023-09-12_14-29-25", "timestamp": 1694543365, "time_this_iter_s": 27.64857506752014, "time_total_s": 27.64857506752014, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433ff40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 27.64857506752014, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.8375, "ram_util_percent": 17.19}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6916504909905294, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011505583950505145, "policy_loss": -0.016074847887648503, "vf_loss": 0.0027340275730239226, "vf_explained_var": 0.3449969560528795, "kl": 0.009176182023647691, "entropy": 1.9156427764644226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.14187725293183, "num_env_steps_trained_throughput_per_sec": 142.14187725293183, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 27891.569, "sample_time_ms": 16968.928, "learn_time_ms": 10859.813, "learn_throughput": 368.33, "synch_weights_time_ms": 62.021}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "3c06e_00000", "date": "2023-09-12_14-29-54", "timestamp": 1694543394, "time_this_iter_s": 28.146806955337524, "time_total_s": 55.795382022857666, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433df30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 55.795382022857666, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.1375, "ram_util_percent": 17.337500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7515006809961051, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010972017306691366, "policy_loss": -0.012724484893745587, "vf_loss": 0.0003002554955097973, "vf_explained_var": 0.7437192368631561, "kl": 0.00726105983876657, "entropy": 1.8938748758286237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 136.86468219429807, "num_env_steps_trained_throughput_per_sec": 136.86468219429807, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 28336.35, "sample_time_ms": 17328.742, "learn_time_ms": 10943.455, "learn_throughput": 365.515, "synch_weights_time_ms": 63.381}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "3c06e_00000", "date": "2023-09-12_14-30-23", "timestamp": 1694543423, "time_this_iter_s": 29.23207950592041, "time_total_s": 85.02746152877808, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a4c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 85.02746152877808, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.671428571428567, "ram_util_percent": 17.42142857142857}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8919794192848106, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005952471366375296, "policy_loss": -0.020181599287995292, "vf_loss": 0.011326316068637729, "vf_explained_var": 0.41888885827114186, "kl": 0.014514059855313406, "entropy": 1.8759751420468092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 0.49160000000000087, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.49074000000000073, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49160000000000087}, "policy_reward_mean": {"red_0": 0.49074000000000073}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4433358184700083, "mean_inference_ms": 3.4271101144460645, "mean_action_processing_ms": 0.19187985324323512, "mean_env_wait_ms": 0.23314955828712552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398294448852539, "StateBufferConnector_ms": 0.0073719024658203125, "ViewRequirementAgentConnector_ms": 0.14126300811767578}}, "episode_reward_max": 0.49160000000000087, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.49074000000000073, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49160000000000087}, "policy_reward_mean": {"red_0": 0.49074000000000073}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4433358184700083, "mean_inference_ms": 3.4271101144460645, "mean_action_processing_ms": 0.19187985324323512, "mean_env_wait_ms": 0.23314955828712552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398294448852539, "StateBufferConnector_ms": 0.0073719024658203125, "ViewRequirementAgentConnector_ms": 0.14126300811767578}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.59756345813202, "num_env_steps_trained_throughput_per_sec": 129.59756345813202, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 28968.448, "sample_time_ms": 17286.605, "learn_time_ms": 11614.318, "learn_throughput": 344.402, "synch_weights_time_ms": 66.759}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "3c06e_00000", "date": "2023-09-12_14-30-54", "timestamp": 1694543454, "time_this_iter_s": 30.874194860458374, "time_total_s": 115.90165638923645, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b5f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 115.90165638923645, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.559999999999995, "ram_util_percent": 17.544444444444444}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8692156348998348, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01361786467168713, "policy_loss": -0.016061720150416174, "vf_loss": 0.0006054449017710795, "vf_explained_var": 0.7166828398282329, "kl": 0.009192055289844347, "entropy": 1.8600926643858353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 0.49160000000000087, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.49074000000000073, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49160000000000087}, "policy_reward_mean": {"red_0": 0.49074000000000073}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4433358184700083, "mean_inference_ms": 3.4271101144460645, "mean_action_processing_ms": 0.19187985324323512, "mean_env_wait_ms": 0.23314955828712552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398294448852539, "StateBufferConnector_ms": 0.0073719024658203125, "ViewRequirementAgentConnector_ms": 0.14126300811767578}}, "episode_reward_max": 0.49160000000000087, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.49074000000000073, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49160000000000087}, "policy_reward_mean": {"red_0": 0.49074000000000073}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4433358184700083, "mean_inference_ms": 3.4271101144460645, "mean_action_processing_ms": 0.19187985324323512, "mean_env_wait_ms": 0.23314955828712552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398294448852539, "StateBufferConnector_ms": 0.0073719024658203125, "ViewRequirementAgentConnector_ms": 0.14126300811767578}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 123.65772801172122, "num_env_steps_trained_throughput_per_sec": 123.65772801172122, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 29644.222, "sample_time_ms": 17627.011, "learn_time_ms": 11948.375, "learn_throughput": 334.774, "synch_weights_time_ms": 68.07}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "3c06e_00000", "date": "2023-09-12_14-31-27", "timestamp": 1694543487, "time_this_iter_s": 32.35517954826355, "time_total_s": 148.2568359375, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b4af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 148.2568359375, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.839130434782607, "ram_util_percent": 17.621739130434786}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9654838975518942, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011199622358374958, "policy_loss": -0.012905724765732884, "vf_loss": 4.858530848158201e-05, "vf_explained_var": -0.9929392258326213, "kl": 0.008287587998813706, "entropy": 1.8417059178153674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 0.49160000000000087, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.49074000000000073, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49160000000000087}, "policy_reward_mean": {"red_0": 0.49074000000000073}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4433358184700083, "mean_inference_ms": 3.4271101144460645, "mean_action_processing_ms": 0.19187985324323512, "mean_env_wait_ms": 0.23314955828712552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398294448852539, "StateBufferConnector_ms": 0.0073719024658203125, "ViewRequirementAgentConnector_ms": 0.14126300811767578}}, "episode_reward_max": 0.49160000000000087, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.49074000000000073, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49160000000000087}, "policy_reward_mean": {"red_0": 0.49074000000000073}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4433358184700083, "mean_inference_ms": 3.4271101144460645, "mean_action_processing_ms": 0.19187985324323512, "mean_env_wait_ms": 0.23314955828712552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398294448852539, "StateBufferConnector_ms": 0.0073719024658203125, "ViewRequirementAgentConnector_ms": 0.14126300811767578}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.7877999207969, "num_env_steps_trained_throughput_per_sec": 132.7877999207969, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 29724.054, "sample_time_ms": 17636.104, "learn_time_ms": 12019.377, "learn_throughput": 332.796, "synch_weights_time_ms": 67.813}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 10, "training_iteration": 6, "trial_id": "3c06e_00000", "date": "2023-09-12_14-31-57", "timestamp": 1694543517, "time_this_iter_s": 30.13054895401001, "time_total_s": 178.38738489151, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a6680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 178.38738489151, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.11363636363637, "ram_util_percent": 17.681818181818183}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1938812900334597, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01592205132337767, "policy_loss": -0.022599033359923245, "vf_loss": 0.0036429033948782792, "vf_explained_var": 0.7950314686944088, "kl": 0.015170391359622547, "entropy": 1.7735047766317924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911100000000007, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911100000000007}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505883934966173, "mean_inference_ms": 3.4595465623389265, "mean_action_processing_ms": 0.1937831790126769, "mean_env_wait_ms": 0.2338225630386992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0861966609954834, "StateBufferConnector_ms": 0.007477998733520508, "ViewRequirementAgentConnector_ms": 0.14530062675476074}}, "episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911100000000007, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911100000000007}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505883934966173, "mean_inference_ms": 3.4595465623389265, "mean_action_processing_ms": 0.1937831790126769, "mean_env_wait_ms": 0.2338225630386992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0861966609954834, "StateBufferConnector_ms": 0.007477998733520508, "ViewRequirementAgentConnector_ms": 0.14530062675476074}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.70570301902686, "num_env_steps_trained_throughput_per_sec": 131.70570301902686, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 29816.433, "sample_time_ms": 17622.997, "learn_time_ms": 12125.915, "learn_throughput": 329.872, "synch_weights_time_ms": 66.755}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 20, "training_iteration": 7, "trial_id": "3c06e_00000", "date": "2023-09-12_14-32-28", "timestamp": 1694543548, "time_this_iter_s": 30.378333806991577, "time_total_s": 208.7657186985016, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 208.7657186985016, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.393023255813954, "ram_util_percent": 17.7953488372093}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2019511179377635, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016725580719624607, "policy_loss": -0.019323454706560977, "vf_loss": 8.344562015357344e-05, "vf_explained_var": -0.8591146441797416, "kl": 0.012572141069497889, "entropy": 1.7671525546660025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911100000000007, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911100000000007}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505883934966173, "mean_inference_ms": 3.4595465623389265, "mean_action_processing_ms": 0.1937831790126769, "mean_env_wait_ms": 0.2338225630386992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0861966609954834, "StateBufferConnector_ms": 0.007477998733520508, "ViewRequirementAgentConnector_ms": 0.14530062675476074}}, "episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911100000000007, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911100000000007}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505883934966173, "mean_inference_ms": 3.4595465623389265, "mean_action_processing_ms": 0.1937831790126769, "mean_env_wait_ms": 0.2338225630386992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0861966609954834, "StateBufferConnector_ms": 0.007477998733520508, "ViewRequirementAgentConnector_ms": 0.14530062675476074}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.16006465448734, "num_env_steps_trained_throughput_per_sec": 138.16006465448734, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 29708.365, "sample_time_ms": 17556.902, "learn_time_ms": 12084.211, "learn_throughput": 331.01, "synch_weights_time_ms": 66.484}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 20, "training_iteration": 8, "trial_id": "3c06e_00000", "date": "2023-09-12_14-32-57", "timestamp": 1694543577, "time_this_iter_s": 28.959290504455566, "time_total_s": 237.72500920295715, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a5ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 237.72500920295715, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 29.704761904761913, "ram_util_percent": 17.902380952380952}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2520166462287308, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01466183804089572, "policy_loss": -0.01723251477208881, "vf_loss": 2.934252758943027e-05, "vf_explained_var": -0.999612757191062, "kl": 0.01270667504519501, "entropy": 1.738947781175375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911100000000007, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911100000000007}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505883934966173, "mean_inference_ms": 3.4595465623389265, "mean_action_processing_ms": 0.1937831790126769, "mean_env_wait_ms": 0.2338225630386992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0861966609954834, "StateBufferConnector_ms": 0.007477998733520508, "ViewRequirementAgentConnector_ms": 0.14530062675476074}}, "episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911100000000007, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911100000000007}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505883934966173, "mean_inference_ms": 3.4595465623389265, "mean_action_processing_ms": 0.1937831790126769, "mean_env_wait_ms": 0.2338225630386992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0861966609954834, "StateBufferConnector_ms": 0.007477998733520508, "ViewRequirementAgentConnector_ms": 0.14530062675476074}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.67528107655855, "num_env_steps_trained_throughput_per_sec": 130.67528107655855, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 29808.568, "sample_time_ms": 17549.254, "learn_time_ms": 12191.86, "learn_throughput": 328.088, "synch_weights_time_ms": 66.692}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 20, "training_iteration": 9, "trial_id": "3c06e_00000", "date": "2023-09-12_14-33-28", "timestamp": 1694543608, "time_this_iter_s": 30.618057250976562, "time_total_s": 268.3430664539337, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b6a70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 268.3430664539337, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.175, "ram_util_percent": 17.943181818181817}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3932207396874825, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00761474237551738, "policy_loss": -0.01618319249197763, "vf_loss": 0.006601519555745957, "vf_explained_var": 0.6350162046651046, "kl": 0.009834653933996183, "entropy": 1.7245570628593365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911000000000009, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911000000000009}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4530053196927042, "mean_inference_ms": 3.464415473178507, "mean_action_processing_ms": 0.19418107491081474, "mean_env_wait_ms": 0.2331869396890993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0909105936686198, "StateBufferConnector_ms": 0.0075181325276692705, "ViewRequirementAgentConnector_ms": 0.15091419219970703}}, "episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911000000000009, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911000000000009}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4530053196927042, "mean_inference_ms": 3.464415473178507, "mean_action_processing_ms": 0.19418107491081474, "mean_env_wait_ms": 0.2331869396890993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0909105936686198, "StateBufferConnector_ms": 0.0075181325276692705, "ViewRequirementAgentConnector_ms": 0.15091419219970703}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.3398728010415, "num_env_steps_trained_throughput_per_sec": 131.3398728010415, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 29873.241, "sample_time_ms": 17536.329, "learn_time_ms": 12268.692, "learn_throughput": 326.033, "synch_weights_time_ms": 67.455}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "3c06e_00000", "date": "2023-09-12_14-33-59", "timestamp": 1694543639, "time_this_iter_s": 30.465746641159058, "time_total_s": 298.8088130950928, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a7910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 298.8088130950928, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.140909090909087, "ram_util_percent": 18.043181818181818}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.427286362523834, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012257627735865147, "policy_loss": -0.015036173969565424, "vf_loss": 0.00040399736698570145, "vf_explained_var": 0.3903426770741741, "kl": 0.01187274298724007, "entropy": 1.6780044509718814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911000000000009, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911000000000009}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4530053196927042, "mean_inference_ms": 3.464415473178507, "mean_action_processing_ms": 0.19418107491081474, "mean_env_wait_ms": 0.2331869396890993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0909105936686198, "StateBufferConnector_ms": 0.0075181325276692705, "ViewRequirementAgentConnector_ms": 0.15091419219970703}}, "episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911000000000009, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911000000000009}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4530053196927042, "mean_inference_ms": 3.464415473178507, "mean_action_processing_ms": 0.19418107491081474, "mean_env_wait_ms": 0.2331869396890993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0909105936686198, "StateBufferConnector_ms": 0.0075181325276692705, "ViewRequirementAgentConnector_ms": 0.15091419219970703}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.31265593704336, "num_env_steps_trained_throughput_per_sec": 130.31265593704336, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 30178.551, "sample_time_ms": 17640.994, "learn_time_ms": 12468.186, "learn_throughput": 320.817, "synch_weights_time_ms": 68.611}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 30, "training_iteration": 11, "trial_id": "3c06e_00000", "date": "2023-09-12_14-34-30", "timestamp": 1694543670, "time_this_iter_s": 30.703871250152588, "time_total_s": 329.51268434524536, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b4670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 329.51268434524536, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.690909090909088, "ram_util_percent": 18.138636363636365}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4221124911059937, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01680666399576391, "policy_loss": -0.01952006291297342, "vf_loss": 8.299125437739955e-05, "vf_explained_var": -0.8415357158829768, "kl": 0.01315203910434805, "entropy": 1.648306698600451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911000000000009, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911000000000009}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4530053196927042, "mean_inference_ms": 3.464415473178507, "mean_action_processing_ms": 0.19418107491081474, "mean_env_wait_ms": 0.2331869396890993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0909105936686198, "StateBufferConnector_ms": 0.0075181325276692705, "ViewRequirementAgentConnector_ms": 0.15091419219970703}}, "episode_reward_max": 0.49225000000000074, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4911000000000009, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.49225000000000074}, "policy_reward_mean": {"red_0": 0.4911000000000009}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4530053196927042, "mean_inference_ms": 3.464415473178507, "mean_action_processing_ms": 0.19418107491081474, "mean_env_wait_ms": 0.2331869396890993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0909105936686198, "StateBufferConnector_ms": 0.0075181325276692705, "ViewRequirementAgentConnector_ms": 0.15091419219970703}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 135.19575245991737, "num_env_steps_trained_throughput_per_sec": 135.19575245991737, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 30323.134, "sample_time_ms": 17630.655, "learn_time_ms": 12623.608, "learn_throughput": 316.867, "synch_weights_time_ms": 68.102}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 30, "training_iteration": 12, "trial_id": "3c06e_00000", "date": "2023-09-12_14-35-00", "timestamp": 1694543700, "time_this_iter_s": 29.59442114830017, "time_total_s": 359.10710549354553, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433c160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 359.10710549354553, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.420930232558142, "ram_util_percent": 18.223255813953486}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5721911755080025, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010440335909121738, "policy_loss": -0.018832106839787834, "vf_loss": 0.0057010842071576915, "vf_explained_var": 0.6660953693712751, "kl": 0.01345343147805996, "entropy": 1.597583826755484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 0.4943500000000006, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4917412500000008, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.4943500000000006}, "policy_reward_mean": {"red_0": 0.4917412500000008}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4544610360021716, "mean_inference_ms": 3.466356547759152, "mean_action_processing_ms": 0.19439913390912053, "mean_env_wait_ms": 0.2327546895886509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09142935276031494, "StateBufferConnector_ms": 0.007699131965637207, "ViewRequirementAgentConnector_ms": 0.15221714973449707}}, "episode_reward_max": 0.4943500000000006, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.4917412500000008, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 0.4943500000000006}, "policy_reward_mean": {"red_0": 0.4917412500000008}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4544610360021716, "mean_inference_ms": 3.466356547759152, "mean_action_processing_ms": 0.19439913390912053, "mean_env_wait_ms": 0.2327546895886509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09142935276031494, "StateBufferConnector_ms": 0.007699131965637207, "ViewRequirementAgentConnector_ms": 0.15221714973449707}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.32936560850752, "num_env_steps_trained_throughput_per_sec": 129.32936560850752, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 30493.417, "sample_time_ms": 17590.7, "learn_time_ms": 12833.637, "learn_throughput": 311.681, "synch_weights_time_ms": 68.304}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 40, "training_iteration": 13, "trial_id": "3c06e_00000", "date": "2023-09-12_14-35-31", "timestamp": 1694543731, "time_this_iter_s": 30.93865180015564, "time_total_s": 390.0457572937012, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a7b50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 390.0457572937012, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.049999999999997, "ram_util_percent": 18.338636363636365}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.024390243902439025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4663912934561572, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015187768980952872, "policy_loss": -0.02435447123692332, "vf_loss": 0.005809701676359206, "vf_explained_var": 0.3555566925555468, "kl": 0.01678500305491563, "entropy": 1.626203102990985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 1.19023125, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5087775914634154, "episode_len_mean": 1259.4634146341464, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.19023125}, "policy_reward_mean": {"red_0": 0.5087775914634154}, "custom_metrics": {"red_0/door_open_done_mean": 0.024390243902439025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4545164745193085, "mean_inference_ms": 3.465652737909966, "mean_action_processing_ms": 0.19437002303519163, "mean_env_wait_ms": 0.23265586297735846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09162484145745999, "StateBufferConnector_ms": 0.007714294805759337, "ViewRequirementAgentConnector_ms": 0.1526501120590582}}, "episode_reward_max": 1.19023125, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5087775914634154, "episode_len_mean": 1259.4634146341464, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.19023125}, "policy_reward_mean": {"red_0": 0.5087775914634154}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4545164745193085, "mean_inference_ms": 3.465652737909966, "mean_action_processing_ms": 0.19437002303519163, "mean_env_wait_ms": 0.23265586297735846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09162484145745999, "StateBufferConnector_ms": 0.007714294805759337, "ViewRequirementAgentConnector_ms": 0.1526501120590582}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.52747492360837, "num_env_steps_trained_throughput_per_sec": 129.52747492360837, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 30495.088, "sample_time_ms": 17671.446, "learn_time_ms": 12755.235, "learn_throughput": 313.597, "synch_weights_time_ms": 67.625}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 41, "training_iteration": 14, "trial_id": "3c06e_00000", "date": "2023-09-12_14-36-02", "timestamp": 1694543762, "time_this_iter_s": 30.890421390533447, "time_total_s": 420.9361786842346, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b4430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 420.9361786842346, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.964444444444446, "ram_util_percent": 18.419999999999998}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.024390243902439025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4460388031477729, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011939796059717385, "policy_loss": -0.014902016392443328, "vf_loss": 0.00034189471220997804, "vf_explained_var": -0.4390251047288378, "kl": 0.013101627656729098, "entropy": 1.6162030263493459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 1.19023125, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5087775914634154, "episode_len_mean": 1259.4634146341464, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.19023125}, "policy_reward_mean": {"red_0": 0.5087775914634154}, "custom_metrics": {"red_0/door_open_done_mean": 0.024390243902439025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4545164745193085, "mean_inference_ms": 3.465652737909966, "mean_action_processing_ms": 0.19437002303519163, "mean_env_wait_ms": 0.23265586297735846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09162484145745999, "StateBufferConnector_ms": 0.007714294805759337, "ViewRequirementAgentConnector_ms": 0.1526501120590582}}, "episode_reward_max": 1.19023125, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5087775914634154, "episode_len_mean": 1259.4634146341464, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.19023125}, "policy_reward_mean": {"red_0": 0.5087775914634154}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4545164745193085, "mean_inference_ms": 3.465652737909966, "mean_action_processing_ms": 0.19437002303519163, "mean_env_wait_ms": 0.23265586297735846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09162484145745999, "StateBufferConnector_ms": 0.007714294805759337, "ViewRequirementAgentConnector_ms": 0.1526501120590582}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.37343295198465, "num_env_steps_trained_throughput_per_sec": 129.37343295198465, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 30352.177, "sample_time_ms": 17566.623, "learn_time_ms": 12717.239, "learn_throughput": 314.534, "synch_weights_time_ms": 67.532}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 41, "training_iteration": 15, "trial_id": "3c06e_00000", "date": "2023-09-12_14-36-34", "timestamp": 1694543794, "time_this_iter_s": 30.927470445632935, "time_total_s": 451.86364912986755, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a4ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 451.86364912986755, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.963636363636365, "ram_util_percent": 18.438636363636363}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.02, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3666224984452129, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010413665262422, "policy_loss": -0.01303584404377034, "vf_loss": 0.00018136374167928201, "vf_explained_var": -1.0, "kl": 0.01220407286673149, "entropy": 1.6227915057291586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 1.19023125, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5062986250000008, "episode_len_mean": 1263.16, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.19023125}, "policy_reward_mean": {"red_0": 0.5062986250000008}, "custom_metrics": {"red_0/door_open_done_mean": 0.02, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4556680375154717, "mean_inference_ms": 3.468926659119561, "mean_action_processing_ms": 0.19461693662191093, "mean_env_wait_ms": 0.23248563943673406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0982961654663086, "StateBufferConnector_ms": 0.00769805908203125, "ViewRequirementAgentConnector_ms": 0.15156269073486328}}, "episode_reward_max": 1.19023125, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5062986250000008, "episode_len_mean": 1263.16, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.19023125}, "policy_reward_mean": {"red_0": 0.5062986250000008}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4556680375154717, "mean_inference_ms": 3.468926659119561, "mean_action_processing_ms": 0.19461693662191093, "mean_env_wait_ms": 0.23248563943673406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0982961654663086, "StateBufferConnector_ms": 0.00769805908203125, "ViewRequirementAgentConnector_ms": 0.15156269073486328}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.02296909198708, "num_env_steps_trained_throughput_per_sec": 129.02296909198708, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 30440.075, "sample_time_ms": 17537.351, "learn_time_ms": 12833.871, "learn_throughput": 311.675, "synch_weights_time_ms": 68.068}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 50, "training_iteration": 16, "trial_id": "3c06e_00000", "date": "2023-09-12_14-37-05", "timestamp": 1694543825, "time_this_iter_s": 31.01258945465088, "time_total_s": 482.87623858451843, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b6320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 482.87623858451843, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.002222222222226, "ram_util_percent": 18.544444444444444}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0392156862745098, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6323266252254447, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011561922663046668, "policy_loss": -0.02627840280717161, "vf_loss": 0.011919766394324445, "vf_explained_var": 0.5320121319343646, "kl": 0.013983569254459139, "entropy": 1.567639260366559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 1.333465625, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5225175857843144, "episode_len_mean": 1243.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.333465625}, "policy_reward_mean": {"red_0": 0.5225175857843144}, "custom_metrics": {"red_0/door_open_done_mean": 0.0392156862745098, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45575128817471666, "mean_inference_ms": 3.4690272325813805, "mean_action_processing_ms": 0.19462665347686273, "mean_env_wait_ms": 0.23245623181986755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0979460921942019, "StateBufferConnector_ms": 0.007692037844190411, "ViewRequirementAgentConnector_ms": 0.15134624406403185}}, "episode_reward_max": 1.333465625, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5225175857843144, "episode_len_mean": 1243.0, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.333465625}, "policy_reward_mean": {"red_0": 0.5225175857843144}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45575128817471666, "mean_inference_ms": 3.4690272325813805, "mean_action_processing_ms": 0.19462665347686273, "mean_env_wait_ms": 0.23245623181986755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0979460921942019, "StateBufferConnector_ms": 0.007692037844190411, "ViewRequirementAgentConnector_ms": 0.15134624406403185}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.0646204475034, "num_env_steps_trained_throughput_per_sec": 131.0646204475034, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 30454.93, "sample_time_ms": 17554.17, "learn_time_ms": 12830.223, "learn_throughput": 311.764, "synch_weights_time_ms": 69.752}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 51, "training_iteration": 17, "trial_id": "3c06e_00000", "date": "2023-09-12_14-37-36", "timestamp": 1694543856, "time_this_iter_s": 30.530011415481567, "time_total_s": 513.40625, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433ed40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 513.40625, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.584090909090904, "ram_util_percent": 18.638636363636365}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05660377358490566, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.579676479784151, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005682494597203913, "policy_loss": -0.01598089751981509, "vf_loss": 0.00788800431631292, "vf_explained_var": 0.5039304834480087, "kl": 0.012051992144459341, "entropy": 1.5754810314625503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5386760613207554, "episode_len_mean": 1222.754716981132, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.5386760613207554}, "custom_metrics": {"red_0/door_open_done_mean": 0.05660377358490566, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4560295187432523, "mean_inference_ms": 3.4691998837597704, "mean_action_processing_ms": 0.19466467964270892, "mean_env_wait_ms": 0.23240145047238397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09816727548275354, "StateBufferConnector_ms": 0.007698221026726489, "ViewRequirementAgentConnector_ms": 0.15137060633245505}}, "episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5386760613207554, "episode_len_mean": 1222.754716981132, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.5386760613207554}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4560295187432523, "mean_inference_ms": 3.4691998837597704, "mean_action_processing_ms": 0.19466467964270892, "mean_env_wait_ms": 0.23240145047238397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09816727548275354, "StateBufferConnector_ms": 0.007698221026726489, "ViewRequirementAgentConnector_ms": 0.15137060633245505}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.49403215078217, "num_env_steps_trained_throughput_per_sec": 131.49403215078217, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 30601.701, "sample_time_ms": 17633.034, "learn_time_ms": 12897.713, "learn_throughput": 310.133, "synch_weights_time_ms": 70.177}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 53, "training_iteration": 18, "trial_id": "3c06e_00000", "date": "2023-09-12_14-38-07", "timestamp": 1694543887, "time_this_iter_s": 30.429144382476807, "time_total_s": 543.8353943824768, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433e950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 543.8353943824768, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 29.697727272727267, "ram_util_percent": 18.702272727272728}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.09090909090909091, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5643632342418035, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012616189571175104, "policy_loss": -0.018162827839599535, "vf_loss": 0.002586318632832748, "vf_explained_var": 0.4411404006804029, "kl": 0.014801599577296544, "entropy": 1.535491074124972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5505092045454552, "episode_len_mean": 1211.0181818181818, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.5505092045454552}, "custom_metrics": {"red_0/door_open_done_mean": 0.09090909090909091, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4561436416261439, "mean_inference_ms": 3.4692701915703252, "mean_action_processing_ms": 0.19466181317800252, "mean_env_wait_ms": 0.23233625784819018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09753834117542613, "StateBufferConnector_ms": 0.0076892159201882105, "ViewRequirementAgentConnector_ms": 0.15093456615101208}}, "episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5505092045454552, "episode_len_mean": 1211.0181818181818, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.5505092045454552}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4561436416261439, "mean_inference_ms": 3.4692701915703252, "mean_action_processing_ms": 0.19466181317800252, "mean_env_wait_ms": 0.23233625784819018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09753834117542613, "StateBufferConnector_ms": 0.0076892159201882105, "ViewRequirementAgentConnector_ms": 0.15093456615101208}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 133.49485655562782, "num_env_steps_trained_throughput_per_sec": 133.49485655562782, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 30537.048, "sample_time_ms": 17618.895, "learn_time_ms": 12847.418, "learn_throughput": 311.347, "synch_weights_time_ms": 69.955}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 55, "training_iteration": 19, "trial_id": "3c06e_00000", "date": "2023-09-12_14-38-37", "timestamp": 1694543917, "time_this_iter_s": 29.973546266555786, "time_total_s": 573.8089406490326, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b6ef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 573.8089406490326, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 30.230232558139537, "ram_util_percent": 18.811627906976742}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.12307692307692308, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6768185082202156, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0001459244327027894, "policy_loss": -0.01465296126055667, "vf_loss": 0.012377588668702326, "vf_explained_var": 0.4447120159243544, "kl": 0.012106487906341596, "entropy": 1.5349841630707184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5764247115384621, "episode_len_mean": 1179.5384615384614, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.5764247115384621}, "custom_metrics": {"red_0/door_open_done_mean": 0.12307692307692308, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569485081173639, "mean_inference_ms": 3.471210493754655, "mean_action_processing_ms": 0.19482179797862814, "mean_env_wait_ms": 0.2320777309279084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09669267214261569, "StateBufferConnector_ms": 0.007845071645883413, "ViewRequirementAgentConnector_ms": 0.15088814955491286}}, "episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.5764247115384621, "episode_len_mean": 1179.5384615384614, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.5764247115384621}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569485081173639, "mean_inference_ms": 3.471210493754655, "mean_action_processing_ms": 0.19482179797862814, "mean_env_wait_ms": 0.2320777309279084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09669267214261569, "StateBufferConnector_ms": 0.007845071645883413, "ViewRequirementAgentConnector_ms": 0.15088814955491286}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.49544655737233, "num_env_steps_trained_throughput_per_sec": 129.49544655737233, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 30580.426, "sample_time_ms": 17645.493, "learn_time_ms": 12864.566, "learn_throughput": 310.932, "synch_weights_time_ms": 69.592}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 65, "training_iteration": 20, "trial_id": "3c06e_00000", "date": "2023-09-12_14-39-08", "timestamp": 1694543948, "time_this_iter_s": 30.900396823883057, "time_total_s": 604.7093374729156, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b5d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 604.7093374729156, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.42954545454546, "ram_util_percent": 18.881818181818183}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.15942028985507245, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6461247285827993, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0039263235190446725, "policy_loss": -0.015824851254728857, "vf_loss": 0.009287217195378616, "vf_explained_var": 0.45416382333884636, "kl": 0.013056552188948104, "entropy": 1.4796463950226704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6007820199275368, "episode_len_mean": 1150.3333333333333, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6007820199275368}, "custom_metrics": {"red_0/door_open_done_mean": 0.15942028985507245, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4572456784361609, "mean_inference_ms": 3.471300218534773, "mean_action_processing_ms": 0.1948346418423015, "mean_env_wait_ms": 0.23194956754001278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0968587571296139, "StateBufferConnector_ms": 0.00787023184955984, "ViewRequirementAgentConnector_ms": 0.15180110931396484}}, "episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6007820199275368, "episode_len_mean": 1150.3333333333333, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6007820199275368}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4572456784361609, "mean_inference_ms": 3.471300218534773, "mean_action_processing_ms": 0.1948346418423015, "mean_env_wait_ms": 0.23194956754001278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0968587571296139, "StateBufferConnector_ms": 0.00787023184955984, "ViewRequirementAgentConnector_ms": 0.15180110931396484}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.13722431772578, "num_env_steps_trained_throughput_per_sec": 130.13722431772578, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 30584.564, "sample_time_ms": 17666.772, "learn_time_ms": 12847.833, "learn_throughput": 311.337, "synch_weights_time_ms": 69.196}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 69, "training_iteration": 21, "trial_id": "3c06e_00000", "date": "2023-09-12_14-39-39", "timestamp": 1694543979, "time_this_iter_s": 30.747361660003662, "time_total_s": 635.4566991329193, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b7400>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 635.4566991329193, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.638636363636362, "ram_util_percent": 19.020454545454545}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.21621621621621623, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6587598098441958, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005444471296505072, "policy_loss": -0.015296509459343117, "vf_loss": 0.007925542130154402, "vf_explained_var": 0.6110521438221137, "kl": 0.0096324769676097, "entropy": 1.467441831032435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6338752111486492, "episode_len_mean": 1111.7162162162163, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6338752111486492}, "custom_metrics": {"red_0/door_open_done_mean": 0.21621621621621623, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4575420501726193, "mean_inference_ms": 3.4720206646752243, "mean_action_processing_ms": 0.19487033739714077, "mean_env_wait_ms": 0.2318367140311504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09581784944276552, "StateBufferConnector_ms": 0.007842682503365181, "ViewRequirementAgentConnector_ms": 0.1512794881253629}}, "episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6338752111486492, "episode_len_mean": 1111.7162162162163, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6338752111486492}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4575420501726193, "mean_inference_ms": 3.4720206646752243, "mean_action_processing_ms": 0.19487033739714077, "mean_env_wait_ms": 0.2318367140311504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09581784944276552, "StateBufferConnector_ms": 0.007842682503365181, "ViewRequirementAgentConnector_ms": 0.1512794881253629}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.15280344713003, "num_env_steps_trained_throughput_per_sec": 131.15280344713003, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 30675.769, "sample_time_ms": 17719.742, "learn_time_ms": 12884.977, "learn_throughput": 310.439, "synch_weights_time_ms": 70.291}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 74, "training_iteration": 22, "trial_id": "3c06e_00000", "date": "2023-09-12_14-40-10", "timestamp": 1694544010, "time_this_iter_s": 30.50963830947876, "time_total_s": 665.9663374423981, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b56c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 665.9663374423981, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.49545454545454, "ram_util_percent": 19.113636363636367}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.24050632911392406, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7372885348275304, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014507850144642969, "policy_loss": -0.023246837903328318, "vf_loss": 0.006212625907088902, "vf_explained_var": 0.6224493137250344, "kl": 0.01263181068775199, "entropy": 1.4230077291528385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6459473496835448, "episode_len_mean": 1098.1645569620252, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6459473496835448}, "custom_metrics": {"red_0/door_open_done_mean": 0.24050632911392406, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579935631586625, "mean_inference_ms": 3.474343317737266, "mean_action_processing_ms": 0.19501377159780192, "mean_env_wait_ms": 0.23185560268423117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09550142891799347, "StateBufferConnector_ms": 0.007862984379635582, "ViewRequirementAgentConnector_ms": 0.15153703810293465}}, "episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6459473496835448, "episode_len_mean": 1098.1645569620252, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6459473496835448}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579935631586625, "mean_inference_ms": 3.474343317737266, "mean_action_processing_ms": 0.19501377159780192, "mean_env_wait_ms": 0.23185560268423117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09550142891799347, "StateBufferConnector_ms": 0.007862984379635582, "ViewRequirementAgentConnector_ms": 0.15153703810293465}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.60933421145617, "num_env_steps_trained_throughput_per_sec": 128.60933421145617, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 30693.085, "sample_time_ms": 17801.788, "learn_time_ms": 12820.121, "learn_throughput": 312.01, "synch_weights_time_ms": 70.419}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 79, "training_iteration": 23, "trial_id": "3c06e_00000", "date": "2023-09-12_14-40-42", "timestamp": 1694544042, "time_this_iter_s": 31.113023281097412, "time_total_s": 697.0793607234955, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433d870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 697.0793607234955, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.295555555555556, "ram_util_percent": 19.177777777777777}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.25301204819277107, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.694116820767522, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009132248078943424, "policy_loss": -0.017137227707038013, "vf_loss": 0.006038290990788179, "vf_explained_var": 0.7193186263243357, "kl": 0.009833441703563513, "entropy": 1.457465654363235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6547046310240969, "episode_len_mean": 1087.6746987951808, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6547046310240969}, "custom_metrics": {"red_0/door_open_done_mean": 0.25301204819277107, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4583875873797071, "mean_inference_ms": 3.4760097557006864, "mean_action_processing_ms": 0.1951214014642458, "mean_env_wait_ms": 0.23184600513655654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09544498949165804, "StateBufferConnector_ms": 0.00790142151246588, "ViewRequirementAgentConnector_ms": 0.15204412391386837}}, "episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6547046310240969, "episode_len_mean": 1087.6746987951808, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6547046310240969}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4583875873797071, "mean_inference_ms": 3.4760097557006864, "mean_action_processing_ms": 0.1951214014642458, "mean_env_wait_ms": 0.23184600513655654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09544498949165804, "StateBufferConnector_ms": 0.00790142151246588, "ViewRequirementAgentConnector_ms": 0.15204412391386837}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.43178880182492, "num_env_steps_trained_throughput_per_sec": 129.43178880182492, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 30695.368, "sample_time_ms": 17830.966, "learn_time_ms": 12793.325, "learn_throughput": 312.663, "synch_weights_time_ms": 70.316}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 83, "training_iteration": 24, "trial_id": "3c06e_00000", "date": "2023-09-12_14-41-13", "timestamp": 1694544073, "time_this_iter_s": 30.915888786315918, "time_total_s": 727.9952495098114, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b6c20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 727.9952495098114, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.31555555555555, "ram_util_percent": 19.239999999999995}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.30434782608695654, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8548729185014963, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00827542522965814, "policy_loss": -0.01711013995130391, "vf_loss": 0.022704206142225302, "vf_explained_var": 0.4530799578875303, "kl": 0.013406793893473663, "entropy": 1.4090462812532982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6920917459239136, "episode_len_mean": 1042.2934782608695, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6920917459239136}, "custom_metrics": {"red_0/door_open_done_mean": 0.30434782608695654, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45904354663144564, "mean_inference_ms": 3.4784535720519814, "mean_action_processing_ms": 0.1952481092259506, "mean_env_wait_ms": 0.23179398499472093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09465036184891411, "StateBufferConnector_ms": 0.007892691570779552, "ViewRequirementAgentConnector_ms": 0.15204289685124936}}, "episode_reward_max": 1.4059343750000002, "episode_reward_min": 0.489750000000001, "episode_reward_mean": 0.6920917459239136, "episode_len_mean": 1042.2934782608695, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.489750000000001}, "policy_reward_max": {"red_0": 1.4059343750000002}, "policy_reward_mean": {"red_0": 0.6920917459239136}, "hist_stats": {"episode_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523], "policy_red_0_reward": [0.489750000000001, 0.490050000000001, 0.48980000000000035, 0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45904354663144564, "mean_inference_ms": 3.4784535720519814, "mean_action_processing_ms": 0.1952481092259506, "mean_env_wait_ms": 0.23179398499472093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09465036184891411, "StateBufferConnector_ms": 0.007892691570779552, "ViewRequirementAgentConnector_ms": 0.15204289685124936}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.57695317407516, "num_env_steps_trained_throughput_per_sec": 128.57695317407516, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 30714.52, "sample_time_ms": 17852.818, "learn_time_ms": 12790.834, "learn_throughput": 312.724, "synch_weights_time_ms": 70.107}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 92, "training_iteration": 25, "trial_id": "3c06e_00000", "date": "2023-09-12_14-41-44", "timestamp": 1694544104, "time_this_iter_s": 31.122323751449585, "time_total_s": 759.117573261261, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433d7e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 759.117573261261, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 30.027272727272727, "ram_util_percent": 19.34090909090909}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.36, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9102937482918303, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.009841608172936844, "policy_loss": -0.01796387238864554, "vf_loss": 0.025380700551128635, "vf_explained_var": 0.5122975555559, "kl": 0.012123897011416062, "entropy": 1.3624406686673562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 1.417234375, "episode_reward_min": 0.49010000000000103, "episode_reward_mean": 0.7432409687500003, "episode_len_mean": 978.25, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"red_0": 0.49010000000000103}, "policy_reward_max": {"red_0": 1.417234375}, "policy_reward_mean": {"red_0": 0.7432409687500003}, "custom_metrics": {"red_0/door_open_done_mean": 0.36, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280], "policy_red_0_reward": [0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4601123246093766, "mean_inference_ms": 3.4813415087903956, "mean_action_processing_ms": 0.19540862938736517, "mean_env_wait_ms": 0.23159552782187126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09407448768615723, "StateBufferConnector_ms": 0.00789189338684082, "ViewRequirementAgentConnector_ms": 0.15217018127441406}}, "episode_reward_max": 1.417234375, "episode_reward_min": 0.49010000000000103, "episode_reward_mean": 0.7432409687500003, "episode_len_mean": 978.25, "episodes_this_iter": 11, "policy_reward_min": {"red_0": 0.49010000000000103}, "policy_reward_max": {"red_0": 1.417234375}, "policy_reward_mean": {"red_0": 0.7432409687500003}, "hist_stats": {"episode_reward": [0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280], "policy_red_0_reward": [0.4912000000000004, 0.4907000000000008, 0.4905500000000007, 0.49115000000000075, 0.49160000000000087, 0.4916000000000008, 0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4601123246093766, "mean_inference_ms": 3.4813415087903956, "mean_action_processing_ms": 0.19540862938736517, "mean_env_wait_ms": 0.23159552782187126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09407448768615723, "StateBufferConnector_ms": 0.00789189338684082, "ViewRequirementAgentConnector_ms": 0.15217018127441406}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.62374522878525, "num_env_steps_trained_throughput_per_sec": 130.62374522878525, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 30676.527, "sample_time_ms": 17899.404, "learn_time_ms": 12706.475, "learn_throughput": 314.8, "synch_weights_time_ms": 69.87}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 103, "training_iteration": 26, "trial_id": "3c06e_00000", "date": "2023-09-12_14-42-15", "timestamp": 1694544135, "time_this_iter_s": 30.63468861579895, "time_total_s": 789.7522618770599, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433e440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 789.7522618770599, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.644444444444446, "ram_util_percent": 19.42222222222222}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.42, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8964197524512807, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01148317380999894, "policy_loss": -0.017887031762802506, "vf_loss": 0.027200616900033007, "vf_explained_var": 0.42920818670342364, "kl": 0.010847943129784505, "entropy": 1.3928402964025737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 1.41949375, "episode_reward_min": 0.49010000000000103, "episode_reward_mean": 0.7957691250000005, "episode_len_mean": 912.76, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"red_0": 0.49010000000000103}, "policy_reward_max": {"red_0": 1.41949375}, "policy_reward_mean": {"red_0": 0.7957691250000005}, "custom_metrics": {"red_0/door_open_done_mean": 0.42, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280, 320, 134, 178, 118, 267, 114], "policy_red_0_reward": [0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46197720836391243, "mean_inference_ms": 3.4891285264520504, "mean_action_processing_ms": 0.19591166713358873, "mean_env_wait_ms": 0.23177233033910993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09512805938720703, "StateBufferConnector_ms": 0.008010625839233398, "ViewRequirementAgentConnector_ms": 0.15355992317199707}}, "episode_reward_max": 1.41949375, "episode_reward_min": 0.49010000000000103, "episode_reward_mean": 0.7957691250000005, "episode_len_mean": 912.76, "episodes_this_iter": 6, "policy_reward_min": {"red_0": 0.49010000000000103}, "policy_reward_max": {"red_0": 1.41949375}, "policy_reward_mean": {"red_0": 0.7957691250000005}, "hist_stats": {"episode_reward": [0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280, 320, 134, 178, 118, 267, 114], "policy_red_0_reward": [0.4910000000000008, 0.4910500000000007, 0.49225000000000074, 0.490950000000001, 0.4915500000000008, 0.49215000000000075, 0.490650000000001, 0.4915000000000008, 0.4914500000000009, 0.49115000000000086, 0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46197720836391243, "mean_inference_ms": 3.4891285264520504, "mean_action_processing_ms": 0.19591166713358873, "mean_env_wait_ms": 0.23177233033910993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09512805938720703, "StateBufferConnector_ms": 0.008010625839233398, "ViewRequirementAgentConnector_ms": 0.15355992317199707}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.341176584505, "num_env_steps_trained_throughput_per_sec": 129.341176584505, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 30717.193, "sample_time_ms": 17952.287, "learn_time_ms": 12694.54, "learn_throughput": 315.096, "synch_weights_time_ms": 69.588}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 109, "training_iteration": 27, "trial_id": "3c06e_00000", "date": "2023-09-12_14-42-47", "timestamp": 1694544167, "time_this_iter_s": 30.938677549362183, "time_total_s": 820.6909394264221, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433e200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 820.6909394264221, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.086363636363636, "ram_util_percent": 19.46590909090909}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.51, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.785317897113661, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.011340923087906655, "policy_loss": -0.010603780312521849, "vf_loss": 0.02024365964656075, "vf_explained_var": 0.6844993924101194, "kl": 0.00850521801639195, "entropy": 1.348746017863353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 1.4669531249999999, "episode_reward_min": 0.49010000000000103, "episode_reward_mean": 0.8669985000000004, "episode_len_mean": 825.28, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.49010000000000103}, "policy_reward_max": {"red_0": 1.4669531249999999}, "policy_reward_mean": {"red_0": 0.8669985000000004}, "custom_metrics": {"red_0/door_open_done_mean": 0.51, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280, 320, 134, 178, 118, 267, 114, 1280, 90, 47, 1056, 374, 165, 575, 174, 170, 121], "policy_red_0_reward": [0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46342650220716, "mean_inference_ms": 3.493690283923197, "mean_action_processing_ms": 0.19623715258658314, "mean_env_wait_ms": 0.23173543777456693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09635758399963379, "StateBufferConnector_ms": 0.008087396621704102, "ViewRequirementAgentConnector_ms": 0.15552759170532227}}, "episode_reward_max": 1.4669531249999999, "episode_reward_min": 0.49010000000000103, "episode_reward_mean": 0.8669985000000004, "episode_len_mean": 825.28, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.49010000000000103}, "policy_reward_max": {"red_0": 1.4669531249999999}, "policy_reward_mean": {"red_0": 0.8669985000000004}, "hist_stats": {"episode_reward": [0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 438, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280, 320, 134, 178, 118, 267, 114, 1280, 90, 47, 1056, 374, 165, 575, 174, 170, 121], "policy_red_0_reward": [0.49210000000000076, 0.4912000000000009, 0.490700000000001, 0.4916000000000009, 0.49055000000000093, 0.49060000000000104, 0.4911500000000009, 0.49010000000000103, 0.4911500000000009, 0.4920000000000009, 0.4917500000000009, 0.49370000000000064, 0.4940000000000006, 0.4943500000000006, 0.4940000000000006, 0.49320000000000075, 0.4938500000000007, 0.4929500000000007, 0.4941500000000006, 0.49405000000000066, 0.49240000000000084, 1.19023125, 0.4962000000000004, 0.49425000000000063, 0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46342650220716, "mean_inference_ms": 3.493690283923197, "mean_action_processing_ms": 0.19623715258658314, "mean_env_wait_ms": 0.23173543777456693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09635758399963379, "StateBufferConnector_ms": 0.008087396621704102, "ViewRequirementAgentConnector_ms": 0.15552759170532227}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.4013452878934, "num_env_steps_trained_throughput_per_sec": 125.4013452878934, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 30864.988, "sample_time_ms": 18068.351, "learn_time_ms": 12726.384, "learn_throughput": 314.308, "synch_weights_time_ms": 69.464}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 119, "training_iteration": 28, "trial_id": "3c06e_00000", "date": "2023-09-12_14-43-19", "timestamp": 1694544199, "time_this_iter_s": 31.909984350204468, "time_total_s": 852.6009237766266, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433eb00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 852.6009237766266, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.26304347826087, "ram_util_percent": 19.576086956521745}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.71, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.258906616891424, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03750005923272207, "policy_loss": -0.020259002886693148, "vf_loss": 0.054893811953176434, "vf_explained_var": 0.5867132702842355, "kl": 0.014326251607988609, "entropy": 1.334963207319379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 1.48156875, "episode_reward_min": 0.49330000000000074, "episode_reward_mean": 1.0577700625000004, "episode_len_mean": 584.62, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {"red_0": 0.49330000000000074}, "policy_reward_max": {"red_0": 1.48156875}, "policy_reward_mean": {"red_0": 1.0577700625000004}, "custom_metrics": {"red_0/door_open_done_mean": 0.71, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002, 0.4972500000000003, 1.415275, 1.3717812500000002, 0.4965000000000004, 1.445609375, 1.2971531250000001, 1.4504812500000002, 1.4775, 1.48156875, 1.461028125, 1.45339375, 1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280, 320, 134, 178, 118, 267, 114, 1280, 90, 47, 1056, 374, 165, 575, 174, 170, 121, 1280, 120, 182, 1280, 77, 287, 70, 32, 26, 55, 66, 54, 113, 84, 79, 94, 61, 206, 1280, 52, 62, 49, 76, 127], "policy_red_0_reward": [0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002, 0.4972500000000003, 1.415275, 1.3717812500000002, 0.4965000000000004, 1.445609375, 1.2971531250000001, 1.4504812500000002, 1.4775, 1.48156875, 1.461028125, 1.45339375, 1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4655940785721907, "mean_inference_ms": 3.5014491863399337, "mean_action_processing_ms": 0.19663748027057015, "mean_env_wait_ms": 0.23181787750414837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09730315208435059, "StateBufferConnector_ms": 0.008215904235839844, "ViewRequirementAgentConnector_ms": 0.15663361549377441}}, "episode_reward_max": 1.48156875, "episode_reward_min": 0.49330000000000074, "episode_reward_mean": 1.0577700625000004, "episode_len_mean": 584.62, "episodes_this_iter": 24, "policy_reward_min": {"red_0": 0.49330000000000074}, "policy_reward_max": {"red_0": 1.48156875}, "policy_reward_mean": {"red_0": 1.0577700625000004}, "hist_stats": {"episode_reward": [0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002, 0.4972500000000003, 1.415275, 1.3717812500000002, 0.4965000000000004, 1.445609375, 1.2971531250000001, 1.4504812500000002, 1.4775, 1.48156875, 1.461028125, 1.45339375, 1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 235, 1280, 133, 1042, 758, 1280, 1280, 1280, 295, 502, 1280, 307, 1280, 1280, 1280, 1280, 373, 570, 480, 254, 439, 773, 689, 739, 1280, 1202, 181, 1280, 545, 1280, 552, 410, 1280, 281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280, 320, 134, 178, 118, 267, 114, 1280, 90, 47, 1056, 374, 165, 575, 174, 170, 121, 1280, 120, 182, 1280, 77, 287, 70, 32, 26, 55, 66, 54, 113, 84, 79, 94, 61, 206, 1280, 52, 62, 49, 76, 127], "policy_red_0_reward": [0.4946000000000006, 0.4953500000000005, 0.49330000000000074, 0.4944000000000006, 0.4955000000000005, 0.49530000000000046, 0.4961500000000003, 1.333465625, 0.4955000000000005, 1.4059343750000002, 0.7639437500000004, 0.9642312500000003, 0.49550000000000044, 0.49490000000000056, 0.4963500000000004, 1.2910281250000002, 1.14468125, 0.4964500000000004, 1.2830406250000002, 0.4948000000000006, 0.49610000000000043, 0.49675000000000036, 0.4947500000000005, 1.2359343750000003, 1.0957687500000004, 1.1599000000000004, 1.31960625, 1.1888281250000003, 0.9537343750000004, 1.0131968750000002, 0.9774406250000003, 0.4955000000000005, 0.6461437500000009, 1.371584375, 0.4957000000000005, 1.1141468750000003, 0.4967000000000003, 1.1101750000000001, 1.20881875, 0.49495000000000056, 1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002, 0.4972500000000003, 1.415275, 1.3717812500000002, 0.4965000000000004, 1.445609375, 1.2971531250000001, 1.4504812500000002, 1.4775, 1.48156875, 1.461028125, 1.45339375, 1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4655940785721907, "mean_inference_ms": 3.5014491863399337, "mean_action_processing_ms": 0.19663748027057015, "mean_env_wait_ms": 0.23181787750414837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09730315208435059, "StateBufferConnector_ms": 0.008215904235839844, "ViewRequirementAgentConnector_ms": 0.15663361549377441}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 127.56419104157197, "num_env_steps_trained_throughput_per_sec": 127.56419104157197, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 31004.294, "sample_time_ms": 18190.637, "learn_time_ms": 12743.404, "learn_throughput": 313.888, "synch_weights_time_ms": 69.462}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 143, "training_iteration": 29, "trial_id": "3c06e_00000", "date": "2023-09-12_14-43-51", "timestamp": 1694544231, "time_this_iter_s": 31.369115591049194, "time_total_s": 883.9700393676758, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b6200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 883.9700393676758, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.17333333333332, "ram_util_percent": 19.64222222222223}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.9, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2025380646189054, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0335496877287369, "policy_loss": -0.01870231365901418, "vf_loss": 0.04963210957551686, "vf_explained_var": 0.45161874250819284, "kl": 0.013099456641573037, "entropy": 1.204309588422378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 1.48171875, "episode_reward_min": 0.4953500000000005, "episode_reward_mean": 1.2855452187500003, "episode_len_mean": 289.37, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {"red_0": 0.4953500000000005}, "policy_reward_max": {"red_0": 1.48171875}, "policy_reward_mean": {"red_0": 1.2855452187500003}, "custom_metrics": {"red_0/door_open_done_mean": 0.9, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002, 0.4972500000000003, 1.415275, 1.3717812500000002, 0.4965000000000004, 1.445609375, 1.2971531250000001, 1.4504812500000002, 1.4775, 1.48156875, 1.461028125, 1.45339375, 1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125, 1.4690125, 1.4745875000000002, 1.449778125, 1.3871, 1.355409375, 1.3998062500000001, 1.049384375, 1.4352125, 1.43933125, 1.42526875, 1.45073125, 1.473884375, 1.437975, 1.448521875, 1.48171875, 1.4583656249999999, 1.390665625, 1.3662593750000003, 1.471675, 1.4577624999999999, 1.471071875, 0.49605000000000044, 1.423009375, 1.4688125, 1.468309375, 1.45038125, 1.42788125, 1.4202468750000001, 1.45896875, 1.38559375, 1.4465124999999999, 1.213884375, 1.459621875, 1.442896875, 1.4583656249999999, 1.4236625, 1.47604375, 0.6349156250000002, 1.451334375, 1.46765625], "episode_lengths": [281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280, 320, 134, 178, 118, 267, 114, 1280, 90, 47, 1056, 374, 165, 575, 174, 170, 121, 1280, 120, 182, 1280, 77, 287, 70, 32, 26, 55, 66, 54, 113, 84, 79, 94, 61, 206, 1280, 52, 62, 49, 76, 127, 44, 36, 71, 160, 205, 142, 629, 92, 86, 106, 70, 37, 88, 73, 26, 59, 155, 189, 40, 60, 41, 1280, 109, 44, 45, 70, 102, 113, 58, 162, 76, 405, 57, 81, 59, 108, 34, 1227, 69, 46], "policy_red_0_reward": [1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002, 0.4972500000000003, 1.415275, 1.3717812500000002, 0.4965000000000004, 1.445609375, 1.2971531250000001, 1.4504812500000002, 1.4775, 1.48156875, 1.461028125, 1.45339375, 1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125, 1.4690125, 1.4745875000000002, 1.449778125, 1.3871, 1.355409375, 1.3998062500000001, 1.049384375, 1.4352125, 1.43933125, 1.42526875, 1.45073125, 1.473884375, 1.437975, 1.448521875, 1.48171875, 1.4583656249999999, 1.390665625, 1.3662593750000003, 1.471675, 1.4577624999999999, 1.471071875, 0.49605000000000044, 1.423009375, 1.4688125, 1.468309375, 1.45038125, 1.42788125, 1.4202468750000001, 1.45896875, 1.38559375, 1.4465124999999999, 1.213884375, 1.459621875, 1.442896875, 1.4583656249999999, 1.4236625, 1.47604375, 0.6349156250000002, 1.451334375, 1.46765625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46860074653550504, "mean_inference_ms": 3.5136252660971854, "mean_action_processing_ms": 0.19736473306025829, "mean_env_wait_ms": 0.23256944576495162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09261775016784668, "StateBufferConnector_ms": 0.008033275604248047, "ViewRequirementAgentConnector_ms": 0.15417861938476562}}, "episode_reward_max": 1.48171875, "episode_reward_min": 0.4953500000000005, "episode_reward_mean": 1.2855452187500003, "episode_len_mean": 289.37, "episodes_this_iter": 40, "policy_reward_min": {"red_0": 0.4953500000000005}, "policy_reward_max": {"red_0": 1.48171875}, "policy_reward_mean": {"red_0": 1.2855452187500003}, "hist_stats": {"episode_reward": [1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002, 0.4972500000000003, 1.415275, 1.3717812500000002, 0.4965000000000004, 1.445609375, 1.2971531250000001, 1.4504812500000002, 1.4775, 1.48156875, 1.461028125, 1.45339375, 1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125, 1.4690125, 1.4745875000000002, 1.449778125, 1.3871, 1.355409375, 1.3998062500000001, 1.049384375, 1.4352125, 1.43933125, 1.42526875, 1.45073125, 1.473884375, 1.437975, 1.448521875, 1.48171875, 1.4583656249999999, 1.390665625, 1.3662593750000003, 1.471675, 1.4577624999999999, 1.471071875, 0.49605000000000044, 1.423009375, 1.4688125, 1.468309375, 1.45038125, 1.42788125, 1.4202468750000001, 1.45896875, 1.38559375, 1.4465124999999999, 1.213884375, 1.459621875, 1.442896875, 1.4583656249999999, 1.4236625, 1.47604375, 0.6349156250000002, 1.451334375, 1.46765625], "episode_lengths": [281, 344, 1280, 1280, 1151, 146, 407, 202, 523, 204, 1280, 141, 475, 117, 407, 1280, 199, 192, 199, 1280, 320, 134, 178, 118, 267, 114, 1280, 90, 47, 1056, 374, 165, 575, 174, 170, 121, 1280, 120, 182, 1280, 77, 287, 70, 32, 26, 55, 66, 54, 113, 84, 79, 94, 61, 206, 1280, 52, 62, 49, 76, 127, 44, 36, 71, 160, 205, 142, 629, 92, 86, 106, 70, 37, 88, 73, 26, 59, 155, 189, 40, 60, 41, 1280, 109, 44, 45, 70, 102, 113, 58, 162, 76, 405, 57, 81, 59, 108, 34, 1227, 69, 46], "policy_red_0_reward": [1.3011218750000002, 1.2563250000000001, 0.4966000000000004, 0.49585000000000046, 0.6871531250000004, 1.39684375, 1.2118781250000001, 1.35651875, 1.1296656250000003, 1.3559625, 0.4972000000000003, 1.400059375, 1.1634656250000002, 1.417234375, 1.2117781250000004, 0.4961500000000004, 1.3587781250000002, 1.36415, 1.359428125, 0.4970500000000003, 1.2735500000000002, 1.4051312500000002, 1.37384375, 1.41643125, 1.3111656250000001, 1.41949375, 0.4953500000000005, 1.43646875, 1.4669531249999999, 0.7542000000000004, 1.2353312500000002, 1.3832343750000002, 1.0935531250000001, 1.37700625, 1.38001875, 1.4145218750000002, 0.4972500000000003, 1.415275, 1.3717812500000002, 0.4965000000000004, 1.445609375, 1.2971531250000001, 1.4504812500000002, 1.4775, 1.48156875, 1.461028125, 1.45339375, 1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125, 1.4690125, 1.4745875000000002, 1.449778125, 1.3871, 1.355409375, 1.3998062500000001, 1.049384375, 1.4352125, 1.43933125, 1.42526875, 1.45073125, 1.473884375, 1.437975, 1.448521875, 1.48171875, 1.4583656249999999, 1.390665625, 1.3662593750000003, 1.471675, 1.4577624999999999, 1.471071875, 0.49605000000000044, 1.423009375, 1.4688125, 1.468309375, 1.45038125, 1.42788125, 1.4202468750000001, 1.45896875, 1.38559375, 1.4465124999999999, 1.213884375, 1.459621875, 1.442896875, 1.4583656249999999, 1.4236625, 1.47604375, 0.6349156250000002, 1.451334375, 1.46765625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46860074653550504, "mean_inference_ms": 3.5136252660971854, "mean_action_processing_ms": 0.19736473306025829, "mean_env_wait_ms": 0.23256944576495162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09261775016784668, "StateBufferConnector_ms": 0.008033275604248047, "ViewRequirementAgentConnector_ms": 0.15417861938476562}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 134.0241274673908, "num_env_steps_trained_throughput_per_sec": 134.0241274673908, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 30899.92, "sample_time_ms": 18162.34, "learn_time_ms": 12667.27, "learn_throughput": 315.774, "synch_weights_time_ms": 69.511}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 183, "training_iteration": 30, "trial_id": "3c06e_00000", "date": "2023-09-12_14-44-21", "timestamp": 1694544261, "time_this_iter_s": 29.859253644943237, "time_total_s": 913.829293012619, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b4f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 913.829293012619, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.051162790697674, "ram_util_percent": 19.748837209302323}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.98, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1558218435694774, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.009998790425621943, "policy_loss": -0.025073335207465183, "vf_loss": 0.032318303488621795, "vf_explained_var": 0.6756330161044996, "kl": 0.013769112102831589, "entropy": 1.1673670049756766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 1.482421875, "episode_reward_min": 0.49605000000000044, "episode_reward_mean": 1.4074268125000002, "episode_len_mean": 128.22, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {"red_0": 0.49605000000000044}, "policy_reward_max": {"red_0": 1.482421875}, "policy_reward_mean": {"red_0": 1.4074268125000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.98, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125, 1.4690125, 1.4745875000000002, 1.449778125, 1.3871, 1.355409375, 1.3998062500000001, 1.049384375, 1.4352125, 1.43933125, 1.42526875, 1.45073125, 1.473884375, 1.437975, 1.448521875, 1.48171875, 1.4583656249999999, 1.390665625, 1.3662593750000003, 1.471675, 1.4577624999999999, 1.471071875, 0.49605000000000044, 1.423009375, 1.4688125, 1.468309375, 1.45038125, 1.42788125, 1.4202468750000001, 1.45896875, 1.38559375, 1.4465124999999999, 1.213884375, 1.459621875, 1.442896875, 1.4583656249999999, 1.4236625, 1.47604375, 0.6349156250000002, 1.451334375, 1.46765625, 1.387403125, 1.431696875, 1.455, 1.4570093750000002, 1.44485625, 1.45073125, 1.44219375, 1.45344375, 1.460525, 1.471021875, 1.4300406250000002, 1.434309375, 1.4746875, 1.426021875, 1.33065, 1.369321875, 1.437221875, 1.4696156249999999, 1.473934375, 1.42798125, 1.45319375, 1.4290875, 1.475390625, 1.40839375, 1.473934375, 1.44295, 1.4506812500000001, 1.447165625, 1.482421875, 1.447265625, 1.4286343750000001, 1.2328687500000002, 1.4662000000000002, 1.455553125, 1.437071875, 1.433003125, 1.4598718750000002, 1.471825, 1.4408375, 1.472328125, 1.46750625, 1.4295875, 1.45916875, 1.444103125, 1.452790625, 1.47318125, 1.462484375], "episode_lengths": [54, 113, 84, 79, 94, 61, 206, 1280, 52, 62, 49, 76, 127, 44, 36, 71, 160, 205, 142, 629, 92, 86, 106, 70, 37, 88, 73, 26, 59, 155, 189, 40, 60, 41, 1280, 109, 44, 45, 70, 102, 113, 58, 162, 76, 405, 57, 81, 59, 108, 34, 1227, 69, 46, 159, 97, 64, 61, 78, 70, 82, 66, 56, 41, 99, 93, 36, 105, 240, 185, 89, 43, 37, 102, 66, 100, 35, 130, 37, 80, 70, 75, 25, 75, 101, 378, 48, 63, 89, 95, 57, 40, 84, 39, 46, 100, 58, 79, 67, 38, 53], "policy_red_0_reward": [1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125, 1.4690125, 1.4745875000000002, 1.449778125, 1.3871, 1.355409375, 1.3998062500000001, 1.049384375, 1.4352125, 1.43933125, 1.42526875, 1.45073125, 1.473884375, 1.437975, 1.448521875, 1.48171875, 1.4583656249999999, 1.390665625, 1.3662593750000003, 1.471675, 1.4577624999999999, 1.471071875, 0.49605000000000044, 1.423009375, 1.4688125, 1.468309375, 1.45038125, 1.42788125, 1.4202468750000001, 1.45896875, 1.38559375, 1.4465124999999999, 1.213884375, 1.459621875, 1.442896875, 1.4583656249999999, 1.4236625, 1.47604375, 0.6349156250000002, 1.451334375, 1.46765625, 1.387403125, 1.431696875, 1.455, 1.4570093750000002, 1.44485625, 1.45073125, 1.44219375, 1.45344375, 1.460525, 1.471021875, 1.4300406250000002, 1.434309375, 1.4746875, 1.426021875, 1.33065, 1.369321875, 1.437221875, 1.4696156249999999, 1.473934375, 1.42798125, 1.45319375, 1.4290875, 1.475390625, 1.40839375, 1.473934375, 1.44295, 1.4506812500000001, 1.447165625, 1.482421875, 1.447265625, 1.4286343750000001, 1.2328687500000002, 1.4662000000000002, 1.455553125, 1.437071875, 1.433003125, 1.4598718750000002, 1.471825, 1.4408375, 1.472328125, 1.46750625, 1.4295875, 1.45916875, 1.444103125, 1.452790625, 1.47318125, 1.462484375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47054283099583827, "mean_inference_ms": 3.5206606495807566, "mean_action_processing_ms": 0.19785147614353754, "mean_env_wait_ms": 0.23321386696854202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09582185745239258, "StateBufferConnector_ms": 0.008078575134277344, "ViewRequirementAgentConnector_ms": 0.15682530403137207}}, "episode_reward_max": 1.482421875, "episode_reward_min": 0.49605000000000044, "episode_reward_mean": 1.4074268125000002, "episode_len_mean": 128.22, "episodes_this_iter": 47, "policy_reward_min": {"red_0": 0.49605000000000044}, "policy_reward_max": {"red_0": 1.482421875}, "policy_reward_mean": {"red_0": 1.4074268125000002}, "hist_stats": {"episode_reward": [1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125, 1.4690125, 1.4745875000000002, 1.449778125, 1.3871, 1.355409375, 1.3998062500000001, 1.049384375, 1.4352125, 1.43933125, 1.42526875, 1.45073125, 1.473884375, 1.437975, 1.448521875, 1.48171875, 1.4583656249999999, 1.390665625, 1.3662593750000003, 1.471675, 1.4577624999999999, 1.471071875, 0.49605000000000044, 1.423009375, 1.4688125, 1.468309375, 1.45038125, 1.42788125, 1.4202468750000001, 1.45896875, 1.38559375, 1.4465124999999999, 1.213884375, 1.459621875, 1.442896875, 1.4583656249999999, 1.4236625, 1.47604375, 0.6349156250000002, 1.451334375, 1.46765625, 1.387403125, 1.431696875, 1.455, 1.4570093750000002, 1.44485625, 1.45073125, 1.44219375, 1.45344375, 1.460525, 1.471021875, 1.4300406250000002, 1.434309375, 1.4746875, 1.426021875, 1.33065, 1.369321875, 1.437221875, 1.4696156249999999, 1.473934375, 1.42798125, 1.45319375, 1.4290875, 1.475390625, 1.40839375, 1.473934375, 1.44295, 1.4506812500000001, 1.447165625, 1.482421875, 1.447265625, 1.4286343750000001, 1.2328687500000002, 1.4662000000000002, 1.455553125, 1.437071875, 1.433003125, 1.4598718750000002, 1.471825, 1.4408375, 1.472328125, 1.46750625, 1.4295875, 1.45916875, 1.444103125, 1.452790625, 1.47318125, 1.462484375], "episode_lengths": [54, 113, 84, 79, 94, 61, 206, 1280, 52, 62, 49, 76, 127, 44, 36, 71, 160, 205, 142, 629, 92, 86, 106, 70, 37, 88, 73, 26, 59, 155, 189, 40, 60, 41, 1280, 109, 44, 45, 70, 102, 113, 58, 162, 76, 405, 57, 81, 59, 108, 34, 1227, 69, 46, 159, 97, 64, 61, 78, 70, 82, 66, 56, 41, 99, 93, 36, 105, 240, 185, 89, 43, 37, 102, 66, 100, 35, 130, 37, 80, 70, 75, 25, 75, 101, 378, 48, 63, 89, 95, 57, 40, 84, 39, 46, 100, 58, 79, 67, 38, 53], "policy_red_0_reward": [1.46198125, 1.420296875, 1.4407375, 1.4443531250000001, 1.43335625, 1.4570093750000002, 1.35450625, 0.4965500000000004, 1.4632874999999999, 1.45635625, 1.465546875, 1.4458625, 1.410003125, 1.4690125, 1.4745875000000002, 1.449778125, 1.3871, 1.355409375, 1.3998062500000001, 1.049384375, 1.4352125, 1.43933125, 1.42526875, 1.45073125, 1.473884375, 1.437975, 1.448521875, 1.48171875, 1.4583656249999999, 1.390665625, 1.3662593750000003, 1.471675, 1.4577624999999999, 1.471071875, 0.49605000000000044, 1.423009375, 1.4688125, 1.468309375, 1.45038125, 1.42788125, 1.4202468750000001, 1.45896875, 1.38559375, 1.4465124999999999, 1.213884375, 1.459621875, 1.442896875, 1.4583656249999999, 1.4236625, 1.47604375, 0.6349156250000002, 1.451334375, 1.46765625, 1.387403125, 1.431696875, 1.455, 1.4570093750000002, 1.44485625, 1.45073125, 1.44219375, 1.45344375, 1.460525, 1.471021875, 1.4300406250000002, 1.434309375, 1.4746875, 1.426021875, 1.33065, 1.369321875, 1.437221875, 1.4696156249999999, 1.473934375, 1.42798125, 1.45319375, 1.4290875, 1.475390625, 1.40839375, 1.473934375, 1.44295, 1.4506812500000001, 1.447165625, 1.482421875, 1.447265625, 1.4286343750000001, 1.2328687500000002, 1.4662000000000002, 1.455553125, 1.437071875, 1.433003125, 1.4598718750000002, 1.471825, 1.4408375, 1.472328125, 1.46750625, 1.4295875, 1.45916875, 1.444103125, 1.452790625, 1.47318125, 1.462484375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47054283099583827, "mean_inference_ms": 3.5206606495807566, "mean_action_processing_ms": 0.19785147614353754, "mean_env_wait_ms": 0.23321386696854202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09582185745239258, "StateBufferConnector_ms": 0.008078575134277344, "ViewRequirementAgentConnector_ms": 0.15682530403137207}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 124.25602781545392, "num_env_steps_trained_throughput_per_sec": 124.25602781545392, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 31045.401, "sample_time_ms": 18239.669, "learn_time_ms": 12735.29, "learn_throughput": 314.088, "synch_weights_time_ms": 69.635}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 230, "training_iteration": 31, "trial_id": "3c06e_00000", "date": "2023-09-12_14-44-53", "timestamp": 1694544293, "time_this_iter_s": 32.20524048805237, "time_total_s": 946.0345335006714, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a68c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 946.0345335006714, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 30.00638297872341, "ram_util_percent": 19.880851063829788}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0884962177524966, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00969277311087353, "policy_loss": -0.02531468064407818, "vf_loss": 0.031702356170474864, "vf_explained_var": 0.6565036532158653, "kl": 0.016525488207766174, "entropy": 1.0504281092435122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 1.482421875, "episode_reward_min": 1.2328687500000002, "episode_reward_mean": 1.4518949062499997, "episode_len_mean": 68.19, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {"red_0": 1.2328687500000002}, "policy_reward_max": {"red_0": 1.482421875}, "policy_reward_mean": {"red_0": 1.4518949062499997}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.460525, 1.471021875, 1.4300406250000002, 1.434309375, 1.4746875, 1.426021875, 1.33065, 1.369321875, 1.437221875, 1.4696156249999999, 1.473934375, 1.42798125, 1.45319375, 1.4290875, 1.475390625, 1.40839375, 1.473934375, 1.44295, 1.4506812500000001, 1.447165625, 1.482421875, 1.447265625, 1.4286343750000001, 1.2328687500000002, 1.4662000000000002, 1.455553125, 1.437071875, 1.433003125, 1.4598718750000002, 1.471825, 1.4408375, 1.472328125, 1.46750625, 1.4295875, 1.45916875, 1.444103125, 1.452790625, 1.47318125, 1.462484375, 1.45324375, 1.46625, 1.4437, 1.45344375, 1.451384375, 1.472528125, 1.46750625, 1.459771875, 1.468309375, 1.460575, 1.47609375, 1.44500625, 1.442746875, 1.471775, 1.4774, 1.320153125, 1.460575, 1.4803125000000001, 1.476746875, 1.43948125, 1.45635625, 1.473834375, 1.4606249999999998, 1.4512343749999999, 1.457059375, 1.4590687500000001, 1.416028125, 1.471171875, 1.461278125, 1.4365687500000002, 1.46183125, 1.4216531250000002, 1.47026875, 1.4457093749999999, 1.455653125, 1.456959375, 1.4521375, 1.471171875, 1.4647937500000001, 1.465546875, 1.4753406249999999, 1.46615, 1.461178125, 1.44791875, 1.4606249999999998, 1.473834375, 1.47604375, 1.471825, 1.4711218750000001, 1.4724781249999999, 1.461128125, 1.48171875, 1.4732812499999999, 1.4279312499999999, 1.4619312500000001, 1.481015625, 1.455503125, 1.472528125, 1.452640625, 1.476796875, 1.469715625], "episode_lengths": [56, 41, 99, 93, 36, 105, 240, 185, 89, 43, 37, 102, 66, 100, 35, 130, 37, 80, 70, 75, 25, 75, 101, 378, 48, 63, 89, 95, 57, 40, 84, 39, 46, 100, 58, 79, 67, 38, 53, 66, 48, 80, 66, 69, 39, 46, 57, 45, 56, 34, 78, 81, 40, 32, 255, 56, 28, 33, 86, 62, 37, 56, 69, 61, 58, 119, 41, 55, 90, 54, 111, 42, 77, 63, 61, 68, 41, 50, 49, 35, 48, 55, 74, 56, 37, 34, 40, 41, 39, 55, 26, 38, 102, 54, 27, 63, 39, 67, 33, 43], "policy_red_0_reward": [1.460525, 1.471021875, 1.4300406250000002, 1.434309375, 1.4746875, 1.426021875, 1.33065, 1.369321875, 1.437221875, 1.4696156249999999, 1.473934375, 1.42798125, 1.45319375, 1.4290875, 1.475390625, 1.40839375, 1.473934375, 1.44295, 1.4506812500000001, 1.447165625, 1.482421875, 1.447265625, 1.4286343750000001, 1.2328687500000002, 1.4662000000000002, 1.455553125, 1.437071875, 1.433003125, 1.4598718750000002, 1.471825, 1.4408375, 1.472328125, 1.46750625, 1.4295875, 1.45916875, 1.444103125, 1.452790625, 1.47318125, 1.462484375, 1.45324375, 1.46625, 1.4437, 1.45344375, 1.451384375, 1.472528125, 1.46750625, 1.459771875, 1.468309375, 1.460575, 1.47609375, 1.44500625, 1.442746875, 1.471775, 1.4774, 1.320153125, 1.460575, 1.4803125000000001, 1.476746875, 1.43948125, 1.45635625, 1.473834375, 1.4606249999999998, 1.4512343749999999, 1.457059375, 1.4590687500000001, 1.416028125, 1.471171875, 1.461278125, 1.4365687500000002, 1.46183125, 1.4216531250000002, 1.47026875, 1.4457093749999999, 1.455653125, 1.456959375, 1.4521375, 1.471171875, 1.4647937500000001, 1.465546875, 1.4753406249999999, 1.46615, 1.461178125, 1.44791875, 1.4606249999999998, 1.473834375, 1.47604375, 1.471825, 1.4711218750000001, 1.4724781249999999, 1.461128125, 1.48171875, 1.4732812499999999, 1.4279312499999999, 1.4619312500000001, 1.481015625, 1.455503125, 1.472528125, 1.452640625, 1.476796875, 1.469715625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4729841287265859, "mean_inference_ms": 3.529389738388487, "mean_action_processing_ms": 0.19838654830864053, "mean_env_wait_ms": 0.2338738367521529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09854435920715332, "StateBufferConnector_ms": 0.008156299591064453, "ViewRequirementAgentConnector_ms": 0.15706276893615723}}, "episode_reward_max": 1.482421875, "episode_reward_min": 1.2328687500000002, "episode_reward_mean": 1.4518949062499997, "episode_len_mean": 68.19, "episodes_this_iter": 61, "policy_reward_min": {"red_0": 1.2328687500000002}, "policy_reward_max": {"red_0": 1.482421875}, "policy_reward_mean": {"red_0": 1.4518949062499997}, "hist_stats": {"episode_reward": [1.460525, 1.471021875, 1.4300406250000002, 1.434309375, 1.4746875, 1.426021875, 1.33065, 1.369321875, 1.437221875, 1.4696156249999999, 1.473934375, 1.42798125, 1.45319375, 1.4290875, 1.475390625, 1.40839375, 1.473934375, 1.44295, 1.4506812500000001, 1.447165625, 1.482421875, 1.447265625, 1.4286343750000001, 1.2328687500000002, 1.4662000000000002, 1.455553125, 1.437071875, 1.433003125, 1.4598718750000002, 1.471825, 1.4408375, 1.472328125, 1.46750625, 1.4295875, 1.45916875, 1.444103125, 1.452790625, 1.47318125, 1.462484375, 1.45324375, 1.46625, 1.4437, 1.45344375, 1.451384375, 1.472528125, 1.46750625, 1.459771875, 1.468309375, 1.460575, 1.47609375, 1.44500625, 1.442746875, 1.471775, 1.4774, 1.320153125, 1.460575, 1.4803125000000001, 1.476746875, 1.43948125, 1.45635625, 1.473834375, 1.4606249999999998, 1.4512343749999999, 1.457059375, 1.4590687500000001, 1.416028125, 1.471171875, 1.461278125, 1.4365687500000002, 1.46183125, 1.4216531250000002, 1.47026875, 1.4457093749999999, 1.455653125, 1.456959375, 1.4521375, 1.471171875, 1.4647937500000001, 1.465546875, 1.4753406249999999, 1.46615, 1.461178125, 1.44791875, 1.4606249999999998, 1.473834375, 1.47604375, 1.471825, 1.4711218750000001, 1.4724781249999999, 1.461128125, 1.48171875, 1.4732812499999999, 1.4279312499999999, 1.4619312500000001, 1.481015625, 1.455503125, 1.472528125, 1.452640625, 1.476796875, 1.469715625], "episode_lengths": [56, 41, 99, 93, 36, 105, 240, 185, 89, 43, 37, 102, 66, 100, 35, 130, 37, 80, 70, 75, 25, 75, 101, 378, 48, 63, 89, 95, 57, 40, 84, 39, 46, 100, 58, 79, 67, 38, 53, 66, 48, 80, 66, 69, 39, 46, 57, 45, 56, 34, 78, 81, 40, 32, 255, 56, 28, 33, 86, 62, 37, 56, 69, 61, 58, 119, 41, 55, 90, 54, 111, 42, 77, 63, 61, 68, 41, 50, 49, 35, 48, 55, 74, 56, 37, 34, 40, 41, 39, 55, 26, 38, 102, 54, 27, 63, 39, 67, 33, 43], "policy_red_0_reward": [1.460525, 1.471021875, 1.4300406250000002, 1.434309375, 1.4746875, 1.426021875, 1.33065, 1.369321875, 1.437221875, 1.4696156249999999, 1.473934375, 1.42798125, 1.45319375, 1.4290875, 1.475390625, 1.40839375, 1.473934375, 1.44295, 1.4506812500000001, 1.447165625, 1.482421875, 1.447265625, 1.4286343750000001, 1.2328687500000002, 1.4662000000000002, 1.455553125, 1.437071875, 1.433003125, 1.4598718750000002, 1.471825, 1.4408375, 1.472328125, 1.46750625, 1.4295875, 1.45916875, 1.444103125, 1.452790625, 1.47318125, 1.462484375, 1.45324375, 1.46625, 1.4437, 1.45344375, 1.451384375, 1.472528125, 1.46750625, 1.459771875, 1.468309375, 1.460575, 1.47609375, 1.44500625, 1.442746875, 1.471775, 1.4774, 1.320153125, 1.460575, 1.4803125000000001, 1.476746875, 1.43948125, 1.45635625, 1.473834375, 1.4606249999999998, 1.4512343749999999, 1.457059375, 1.4590687500000001, 1.416028125, 1.471171875, 1.461278125, 1.4365687500000002, 1.46183125, 1.4216531250000002, 1.47026875, 1.4457093749999999, 1.455653125, 1.456959375, 1.4521375, 1.471171875, 1.4647937500000001, 1.465546875, 1.4753406249999999, 1.46615, 1.461178125, 1.44791875, 1.4606249999999998, 1.473834375, 1.47604375, 1.471825, 1.4711218750000001, 1.4724781249999999, 1.461128125, 1.48171875, 1.4732812499999999, 1.4279312499999999, 1.4619312500000001, 1.481015625, 1.455503125, 1.472528125, 1.452640625, 1.476796875, 1.469715625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4729841287265859, "mean_inference_ms": 3.529389738388487, "mean_action_processing_ms": 0.19838654830864053, "mean_env_wait_ms": 0.2338738367521529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09854435920715332, "StateBufferConnector_ms": 0.008156299591064453, "ViewRequirementAgentConnector_ms": 0.15706276893615723}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 126.46320079795692, "num_env_steps_trained_throughput_per_sec": 126.46320079795692, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 31158.498, "sample_time_ms": 18303.372, "learn_time_ms": 12783.781, "learn_throughput": 312.896, "synch_weights_time_ms": 70.515}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 291, "training_iteration": 32, "trial_id": "3c06e_00000", "date": "2023-09-12_14-45-25", "timestamp": 1694544325, "time_this_iter_s": 31.64494276046753, "time_total_s": 977.6794762611389, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a4700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 977.6794762611389, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 28.884444444444444, "ram_util_percent": 19.95111111111111}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.141939510467152, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010694635291656596, "policy_loss": -0.030658867588014498, "vf_loss": 0.016392816302444164, "vf_explained_var": 0.5401530259599289, "kl": 0.01785708149108157, "entropy": 0.9954345666492979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 1.48729375, "episode_reward_min": 0.7948750000000002, "episode_reward_mean": 1.4622209999999998, "episode_len_mean": 53.6, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {"red_0": 0.7948750000000002}, "policy_reward_max": {"red_0": 1.48729375}, "policy_reward_mean": {"red_0": 1.4622209999999998}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.481015625, 1.455503125, 1.472528125, 1.452640625, 1.476796875, 1.469715625, 1.481015625, 1.47323125, 1.476796875, 1.47609375, 1.4704187499999999, 1.4647937500000001, 1.4633875, 1.47885625, 1.4619312500000001, 1.462584375, 1.4775, 1.4632375, 1.46625, 1.475290625, 1.47604375, 1.4746875, 1.472578125, 1.471875, 1.47890625, 1.476796875, 1.4682593750000001, 1.46615, 1.4744875, 1.466903125, 1.469765625, 1.457109375, 1.481015625, 1.4632874999999999, 1.47890625, 1.473934375, 1.45615625, 1.4753406249999999, 1.482421875, 1.462634375, 1.476796875, 1.46765625, 1.4711218750000001, 1.4310437500000002, 1.4802625, 1.47604375, 1.479609375, 1.4739843750000001, 1.4564062500000001, 1.4465625, 1.4802625, 1.4420937500000002, 1.47298125, 1.4753406249999999, 0.7948750000000002, 1.4590687500000001, 1.4795093750000001, 1.4689625, 1.469565625, 1.46615, 1.47735, 1.469715625, 1.4576625, 1.4746875, 1.475390625, 1.4627343750000001, 1.455, 1.4606249999999998, 1.4803125000000001, 1.44510625, 1.4732812499999999, 1.459771875, 1.4732812499999999, 1.483125, 1.475390625, 1.480915625, 1.47609375, 1.476796875, 1.471171875, 1.4690125, 1.4598718750000002, 1.4717250000000002, 1.40985, 1.479559375, 1.47885625, 1.4782031249999998, 1.479559375, 1.469715625, 1.46163125, 1.463990625, 1.48729375, 1.465346875, 1.479559375, 1.4711218750000001, 1.479409375, 1.4293875, 1.455353125, 1.468209375, 1.4753406249999999, 1.465546875], "episode_lengths": [27, 63, 39, 67, 33, 43, 27, 38, 33, 34, 42, 50, 52, 30, 54, 53, 32, 52, 48, 35, 34, 36, 39, 40, 30, 33, 45, 48, 36, 47, 43, 61, 27, 52, 30, 37, 62, 35, 25, 53, 33, 46, 41, 98, 28, 34, 29, 37, 62, 76, 28, 82, 38, 35, 1000, 58, 29, 44, 43, 48, 32, 43, 60, 36, 35, 53, 64, 56, 28, 78, 38, 57, 38, 24, 35, 27, 34, 33, 41, 44, 57, 40, 128, 29, 30, 31, 29, 43, 54, 51, 18, 49, 29, 41, 29, 100, 63, 45, 35, 49], "policy_red_0_reward": [1.481015625, 1.455503125, 1.472528125, 1.452640625, 1.476796875, 1.469715625, 1.481015625, 1.47323125, 1.476796875, 1.47609375, 1.4704187499999999, 1.4647937500000001, 1.4633875, 1.47885625, 1.4619312500000001, 1.462584375, 1.4775, 1.4632375, 1.46625, 1.475290625, 1.47604375, 1.4746875, 1.472578125, 1.471875, 1.47890625, 1.476796875, 1.4682593750000001, 1.46615, 1.4744875, 1.466903125, 1.469765625, 1.457109375, 1.481015625, 1.4632874999999999, 1.47890625, 1.473934375, 1.45615625, 1.4753406249999999, 1.482421875, 1.462634375, 1.476796875, 1.46765625, 1.4711218750000001, 1.4310437500000002, 1.4802625, 1.47604375, 1.479609375, 1.4739843750000001, 1.4564062500000001, 1.4465625, 1.4802625, 1.4420937500000002, 1.47298125, 1.4753406249999999, 0.7948750000000002, 1.4590687500000001, 1.4795093750000001, 1.4689625, 1.469565625, 1.46615, 1.47735, 1.469715625, 1.4576625, 1.4746875, 1.475390625, 1.4627343750000001, 1.455, 1.4606249999999998, 1.4803125000000001, 1.44510625, 1.4732812499999999, 1.459771875, 1.4732812499999999, 1.483125, 1.475390625, 1.480915625, 1.47609375, 1.476796875, 1.471171875, 1.4690125, 1.4598718750000002, 1.4717250000000002, 1.40985, 1.479559375, 1.47885625, 1.4782031249999998, 1.479559375, 1.469715625, 1.46163125, 1.463990625, 1.48729375, 1.465346875, 1.479559375, 1.4711218750000001, 1.479409375, 1.4293875, 1.455353125, 1.468209375, 1.4753406249999999, 1.465546875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4752745689002863, "mean_inference_ms": 3.5358515652029485, "mean_action_processing_ms": 0.19877213629101562, "mean_env_wait_ms": 0.23453432219807496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10022926330566406, "StateBufferConnector_ms": 0.008264780044555664, "ViewRequirementAgentConnector_ms": 0.16238141059875488}}, "episode_reward_max": 1.48729375, "episode_reward_min": 0.7948750000000002, "episode_reward_mean": 1.4622209999999998, "episode_len_mean": 53.6, "episodes_this_iter": 94, "policy_reward_min": {"red_0": 0.7948750000000002}, "policy_reward_max": {"red_0": 1.48729375}, "policy_reward_mean": {"red_0": 1.4622209999999998}, "hist_stats": {"episode_reward": [1.481015625, 1.455503125, 1.472528125, 1.452640625, 1.476796875, 1.469715625, 1.481015625, 1.47323125, 1.476796875, 1.47609375, 1.4704187499999999, 1.4647937500000001, 1.4633875, 1.47885625, 1.4619312500000001, 1.462584375, 1.4775, 1.4632375, 1.46625, 1.475290625, 1.47604375, 1.4746875, 1.472578125, 1.471875, 1.47890625, 1.476796875, 1.4682593750000001, 1.46615, 1.4744875, 1.466903125, 1.469765625, 1.457109375, 1.481015625, 1.4632874999999999, 1.47890625, 1.473934375, 1.45615625, 1.4753406249999999, 1.482421875, 1.462634375, 1.476796875, 1.46765625, 1.4711218750000001, 1.4310437500000002, 1.4802625, 1.47604375, 1.479609375, 1.4739843750000001, 1.4564062500000001, 1.4465625, 1.4802625, 1.4420937500000002, 1.47298125, 1.4753406249999999, 0.7948750000000002, 1.4590687500000001, 1.4795093750000001, 1.4689625, 1.469565625, 1.46615, 1.47735, 1.469715625, 1.4576625, 1.4746875, 1.475390625, 1.4627343750000001, 1.455, 1.4606249999999998, 1.4803125000000001, 1.44510625, 1.4732812499999999, 1.459771875, 1.4732812499999999, 1.483125, 1.475390625, 1.480915625, 1.47609375, 1.476796875, 1.471171875, 1.4690125, 1.4598718750000002, 1.4717250000000002, 1.40985, 1.479559375, 1.47885625, 1.4782031249999998, 1.479559375, 1.469715625, 1.46163125, 1.463990625, 1.48729375, 1.465346875, 1.479559375, 1.4711218750000001, 1.479409375, 1.4293875, 1.455353125, 1.468209375, 1.4753406249999999, 1.465546875], "episode_lengths": [27, 63, 39, 67, 33, 43, 27, 38, 33, 34, 42, 50, 52, 30, 54, 53, 32, 52, 48, 35, 34, 36, 39, 40, 30, 33, 45, 48, 36, 47, 43, 61, 27, 52, 30, 37, 62, 35, 25, 53, 33, 46, 41, 98, 28, 34, 29, 37, 62, 76, 28, 82, 38, 35, 1000, 58, 29, 44, 43, 48, 32, 43, 60, 36, 35, 53, 64, 56, 28, 78, 38, 57, 38, 24, 35, 27, 34, 33, 41, 44, 57, 40, 128, 29, 30, 31, 29, 43, 54, 51, 18, 49, 29, 41, 29, 100, 63, 45, 35, 49], "policy_red_0_reward": [1.481015625, 1.455503125, 1.472528125, 1.452640625, 1.476796875, 1.469715625, 1.481015625, 1.47323125, 1.476796875, 1.47609375, 1.4704187499999999, 1.4647937500000001, 1.4633875, 1.47885625, 1.4619312500000001, 1.462584375, 1.4775, 1.4632375, 1.46625, 1.475290625, 1.47604375, 1.4746875, 1.472578125, 1.471875, 1.47890625, 1.476796875, 1.4682593750000001, 1.46615, 1.4744875, 1.466903125, 1.469765625, 1.457109375, 1.481015625, 1.4632874999999999, 1.47890625, 1.473934375, 1.45615625, 1.4753406249999999, 1.482421875, 1.462634375, 1.476796875, 1.46765625, 1.4711218750000001, 1.4310437500000002, 1.4802625, 1.47604375, 1.479609375, 1.4739843750000001, 1.4564062500000001, 1.4465625, 1.4802625, 1.4420937500000002, 1.47298125, 1.4753406249999999, 0.7948750000000002, 1.4590687500000001, 1.4795093750000001, 1.4689625, 1.469565625, 1.46615, 1.47735, 1.469715625, 1.4576625, 1.4746875, 1.475390625, 1.4627343750000001, 1.455, 1.4606249999999998, 1.4803125000000001, 1.44510625, 1.4732812499999999, 1.459771875, 1.4732812499999999, 1.483125, 1.475390625, 1.480915625, 1.47609375, 1.476796875, 1.471171875, 1.4690125, 1.4598718750000002, 1.4717250000000002, 1.40985, 1.479559375, 1.47885625, 1.4782031249999998, 1.479559375, 1.469715625, 1.46163125, 1.463990625, 1.48729375, 1.465346875, 1.479559375, 1.4711218750000001, 1.479409375, 1.4293875, 1.455353125, 1.468209375, 1.4753406249999999, 1.465546875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4752745689002863, "mean_inference_ms": 3.5358515652029485, "mean_action_processing_ms": 0.19877213629101562, "mean_env_wait_ms": 0.23453432219807496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10022926330566406, "StateBufferConnector_ms": 0.008264780044555664, "ViewRequirementAgentConnector_ms": 0.16238141059875488}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 124.72441774697447, "num_env_steps_trained_throughput_per_sec": 124.72441774697447, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 31255.374, "sample_time_ms": 18371.752, "learn_time_ms": 12811.814, "learn_throughput": 312.212, "synch_weights_time_ms": 70.97}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 385, "training_iteration": 33, "trial_id": "3c06e_00000", "date": "2023-09-12_14-45-58", "timestamp": 1694544358, "time_this_iter_s": 32.087013244628906, "time_total_s": 1009.7664895057678, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433f2e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1009.7664895057678, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.91304347826087, "ram_util_percent": 20.03913043478261}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.973700326619049, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0166723821675987, "policy_loss": -0.028042248957111344, "vf_loss": 0.007954853928822558, "vf_explained_var": 0.7894938643400867, "kl": 0.017075064446809545, "entropy": 0.8882974422847231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 1.48734375, "episode_reward_min": 1.4238625, "episode_reward_mean": 1.4761994791666666, "episode_len_mean": 33.766666666666666, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"red_0": 1.4238625}, "policy_reward_max": {"red_0": 1.48734375}, "policy_reward_mean": {"red_0": 1.4761994791666666}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.447115625, 1.48171875, 1.4775, 1.469715625, 1.4690625000000002, 1.47313125, 1.481015625, 1.48156875, 1.4688125, 1.483828125, 1.485184375, 1.482421875, 1.480915625, 1.475190625, 1.483025, 1.473934375, 1.4859375, 1.46474375, 1.48171875, 1.4774, 1.483828125, 1.4774, 1.483125, 1.4802125, 1.476796875, 1.482421875, 1.46625, 1.47890625, 1.4717250000000002, 1.480965625, 1.4774, 1.4802125, 1.47890625, 1.4837781250000002, 1.483125, 1.4845312499999999, 1.481015625, 1.482271875, 1.46198125, 1.483828125, 1.4739843750000001, 1.471575, 1.4816687499999999, 1.47735, 1.479559375, 1.4753406249999999, 1.483125, 1.477953125, 1.4746375, 1.4816687499999999, 1.4711218750000001, 1.473934375, 1.4724781249999999, 1.479609375, 1.465446875, 1.4598718750000002, 1.47609375, 1.479609375, 1.448471875, 1.47046875, 1.47036875, 1.471071875, 1.476746875, 1.4802125, 1.47865625, 1.4803125000000001, 1.482421875, 1.48734375, 1.475390625, 1.485234375, 1.48156875, 1.48171875, 1.48161875, 1.466903125, 1.475390625, 1.4782031249999998, 1.4746875, 1.45916875, 1.4782031249999998, 1.47609375, 1.479559375, 1.47609375, 1.468309375, 1.47890625, 1.4667531249999999, 1.475390625, 1.482421875, 1.479609375, 1.47885625, 1.482421875, 1.47604375, 1.485184375, 1.483075, 1.469765625, 1.4774500000000002, 1.462584375, 1.461278125, 1.4690125, 1.469715625, 1.4753406249999999, 1.476696875, 1.483828125, 1.486590625, 1.483828125, 1.469665625, 1.45339375, 1.4803125000000001, 1.4746375, 1.48448125, 1.479559375, 1.483125, 1.478153125, 1.4859375, 1.478153125, 1.478053125, 1.4238625, 1.483828125, 1.480915625, 1.4808656249999999, 1.4823718750000001], "episode_lengths": [75, 26, 32, 43, 44, 38, 27, 26, 44, 23, 21, 25, 27, 35, 24, 37, 20, 50, 26, 32, 23, 32, 24, 28, 33, 25, 48, 30, 40, 27, 32, 28, 30, 23, 24, 22, 27, 25, 54, 23, 37, 40, 26, 32, 29, 35, 24, 31, 36, 26, 41, 37, 39, 29, 49, 57, 34, 29, 73, 42, 42, 41, 33, 28, 30, 28, 25, 18, 35, 21, 26, 26, 26, 47, 35, 31, 36, 58, 31, 34, 29, 34, 45, 30, 47, 35, 25, 29, 30, 25, 34, 21, 24, 43, 32, 53, 55, 44, 43, 35, 33, 23, 19, 23, 43, 66, 28, 36, 22, 29, 24, 31, 20, 31, 31, 108, 23, 27, 27, 25], "policy_red_0_reward": [1.447115625, 1.48171875, 1.4775, 1.469715625, 1.4690625000000002, 1.47313125, 1.481015625, 1.48156875, 1.4688125, 1.483828125, 1.485184375, 1.482421875, 1.480915625, 1.475190625, 1.483025, 1.473934375, 1.4859375, 1.46474375, 1.48171875, 1.4774, 1.483828125, 1.4774, 1.483125, 1.4802125, 1.476796875, 1.482421875, 1.46625, 1.47890625, 1.4717250000000002, 1.480965625, 1.4774, 1.4802125, 1.47890625, 1.4837781250000002, 1.483125, 1.4845312499999999, 1.481015625, 1.482271875, 1.46198125, 1.483828125, 1.4739843750000001, 1.471575, 1.4816687499999999, 1.47735, 1.479559375, 1.4753406249999999, 1.483125, 1.477953125, 1.4746375, 1.4816687499999999, 1.4711218750000001, 1.473934375, 1.4724781249999999, 1.479609375, 1.465446875, 1.4598718750000002, 1.47609375, 1.479609375, 1.448471875, 1.47046875, 1.47036875, 1.471071875, 1.476746875, 1.4802125, 1.47865625, 1.4803125000000001, 1.482421875, 1.48734375, 1.475390625, 1.485234375, 1.48156875, 1.48171875, 1.48161875, 1.466903125, 1.475390625, 1.4782031249999998, 1.4746875, 1.45916875, 1.4782031249999998, 1.47609375, 1.479559375, 1.47609375, 1.468309375, 1.47890625, 1.4667531249999999, 1.475390625, 1.482421875, 1.479609375, 1.47885625, 1.482421875, 1.47604375, 1.485184375, 1.483075, 1.469765625, 1.4774500000000002, 1.462584375, 1.461278125, 1.4690125, 1.469715625, 1.4753406249999999, 1.476696875, 1.483828125, 1.486590625, 1.483828125, 1.469665625, 1.45339375, 1.4803125000000001, 1.4746375, 1.48448125, 1.479559375, 1.483125, 1.478153125, 1.4859375, 1.478153125, 1.478053125, 1.4238625, 1.483828125, 1.480915625, 1.4808656249999999, 1.4823718750000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47765066818674096, "mean_inference_ms": 3.5381102465246337, "mean_action_processing_ms": 0.1989555282049126, "mean_env_wait_ms": 0.23504310757658733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1002975304921468, "StateBufferConnector_ms": 0.008180538813273111, "ViewRequirementAgentConnector_ms": 0.15970826148986816}}, "episode_reward_max": 1.48734375, "episode_reward_min": 1.4238625, "episode_reward_mean": 1.4761994791666666, "episode_len_mean": 33.766666666666666, "episodes_this_iter": 120, "policy_reward_min": {"red_0": 1.4238625}, "policy_reward_max": {"red_0": 1.48734375}, "policy_reward_mean": {"red_0": 1.4761994791666666}, "hist_stats": {"episode_reward": [1.447115625, 1.48171875, 1.4775, 1.469715625, 1.4690625000000002, 1.47313125, 1.481015625, 1.48156875, 1.4688125, 1.483828125, 1.485184375, 1.482421875, 1.480915625, 1.475190625, 1.483025, 1.473934375, 1.4859375, 1.46474375, 1.48171875, 1.4774, 1.483828125, 1.4774, 1.483125, 1.4802125, 1.476796875, 1.482421875, 1.46625, 1.47890625, 1.4717250000000002, 1.480965625, 1.4774, 1.4802125, 1.47890625, 1.4837781250000002, 1.483125, 1.4845312499999999, 1.481015625, 1.482271875, 1.46198125, 1.483828125, 1.4739843750000001, 1.471575, 1.4816687499999999, 1.47735, 1.479559375, 1.4753406249999999, 1.483125, 1.477953125, 1.4746375, 1.4816687499999999, 1.4711218750000001, 1.473934375, 1.4724781249999999, 1.479609375, 1.465446875, 1.4598718750000002, 1.47609375, 1.479609375, 1.448471875, 1.47046875, 1.47036875, 1.471071875, 1.476746875, 1.4802125, 1.47865625, 1.4803125000000001, 1.482421875, 1.48734375, 1.475390625, 1.485234375, 1.48156875, 1.48171875, 1.48161875, 1.466903125, 1.475390625, 1.4782031249999998, 1.4746875, 1.45916875, 1.4782031249999998, 1.47609375, 1.479559375, 1.47609375, 1.468309375, 1.47890625, 1.4667531249999999, 1.475390625, 1.482421875, 1.479609375, 1.47885625, 1.482421875, 1.47604375, 1.485184375, 1.483075, 1.469765625, 1.4774500000000002, 1.462584375, 1.461278125, 1.4690125, 1.469715625, 1.4753406249999999, 1.476696875, 1.483828125, 1.486590625, 1.483828125, 1.469665625, 1.45339375, 1.4803125000000001, 1.4746375, 1.48448125, 1.479559375, 1.483125, 1.478153125, 1.4859375, 1.478153125, 1.478053125, 1.4238625, 1.483828125, 1.480915625, 1.4808656249999999, 1.4823718750000001], "episode_lengths": [75, 26, 32, 43, 44, 38, 27, 26, 44, 23, 21, 25, 27, 35, 24, 37, 20, 50, 26, 32, 23, 32, 24, 28, 33, 25, 48, 30, 40, 27, 32, 28, 30, 23, 24, 22, 27, 25, 54, 23, 37, 40, 26, 32, 29, 35, 24, 31, 36, 26, 41, 37, 39, 29, 49, 57, 34, 29, 73, 42, 42, 41, 33, 28, 30, 28, 25, 18, 35, 21, 26, 26, 26, 47, 35, 31, 36, 58, 31, 34, 29, 34, 45, 30, 47, 35, 25, 29, 30, 25, 34, 21, 24, 43, 32, 53, 55, 44, 43, 35, 33, 23, 19, 23, 43, 66, 28, 36, 22, 29, 24, 31, 20, 31, 31, 108, 23, 27, 27, 25], "policy_red_0_reward": [1.447115625, 1.48171875, 1.4775, 1.469715625, 1.4690625000000002, 1.47313125, 1.481015625, 1.48156875, 1.4688125, 1.483828125, 1.485184375, 1.482421875, 1.480915625, 1.475190625, 1.483025, 1.473934375, 1.4859375, 1.46474375, 1.48171875, 1.4774, 1.483828125, 1.4774, 1.483125, 1.4802125, 1.476796875, 1.482421875, 1.46625, 1.47890625, 1.4717250000000002, 1.480965625, 1.4774, 1.4802125, 1.47890625, 1.4837781250000002, 1.483125, 1.4845312499999999, 1.481015625, 1.482271875, 1.46198125, 1.483828125, 1.4739843750000001, 1.471575, 1.4816687499999999, 1.47735, 1.479559375, 1.4753406249999999, 1.483125, 1.477953125, 1.4746375, 1.4816687499999999, 1.4711218750000001, 1.473934375, 1.4724781249999999, 1.479609375, 1.465446875, 1.4598718750000002, 1.47609375, 1.479609375, 1.448471875, 1.47046875, 1.47036875, 1.471071875, 1.476746875, 1.4802125, 1.47865625, 1.4803125000000001, 1.482421875, 1.48734375, 1.475390625, 1.485234375, 1.48156875, 1.48171875, 1.48161875, 1.466903125, 1.475390625, 1.4782031249999998, 1.4746875, 1.45916875, 1.4782031249999998, 1.47609375, 1.479559375, 1.47609375, 1.468309375, 1.47890625, 1.4667531249999999, 1.475390625, 1.482421875, 1.479609375, 1.47885625, 1.482421875, 1.47604375, 1.485184375, 1.483075, 1.469765625, 1.4774500000000002, 1.462584375, 1.461278125, 1.4690125, 1.469715625, 1.4753406249999999, 1.476696875, 1.483828125, 1.486590625, 1.483828125, 1.469665625, 1.45339375, 1.4803125000000001, 1.4746375, 1.48448125, 1.479559375, 1.483125, 1.478153125, 1.4859375, 1.478153125, 1.478053125, 1.4238625, 1.483828125, 1.480915625, 1.4808656249999999, 1.4823718750000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47765066818674096, "mean_inference_ms": 3.5381102465246337, "mean_action_processing_ms": 0.1989555282049126, "mean_env_wait_ms": 0.23504310757658733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1002975304921468, "StateBufferConnector_ms": 0.008180538813273111, "ViewRequirementAgentConnector_ms": 0.15970826148986816}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 126.25727926644359, "num_env_steps_trained_throughput_per_sec": 126.25727926644359, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 31333.077, "sample_time_ms": 18433.497, "learn_time_ms": 12827.94, "learn_throughput": 311.819, "synch_weights_time_ms": 70.808}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 505, "training_iteration": 34, "trial_id": "3c06e_00000", "date": "2023-09-12_14-46-30", "timestamp": 1694544390, "time_this_iter_s": 31.698007106781006, "time_total_s": 1041.4644966125488, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc4433e320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1041.4644966125488, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 28.808695652173913, "ram_util_percent": 20.119565217391308}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8411017740145326, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.020154084860162888, "policy_loss": -0.029840939938731027, "vf_loss": 0.006246219311409126, "vf_explained_var": 0.8403043158973257, "kl": 0.01720317447843771, "entropy": 0.803266046072046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 1.488046875, "episode_reward_min": 1.441540625, "episode_reward_mean": 1.4796759821428571, "episode_len_mean": 28.82857142857143, "episode_media": {}, "episodes_this_iter": 140, "policy_reward_min": {"red_0": 1.441540625}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4796759821428571}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4682593750000001, 1.475290625, 1.476746875, 1.479609375, 1.4745875000000002, 1.47589375, 1.4845312499999999, 1.45359375, 1.4766468750000001, 1.48729375, 1.485184375, 1.4837781250000002, 1.48734375, 1.4858375000000001, 1.479609375, 1.4879968749999999, 1.480915625, 1.476746875, 1.4802125, 1.47875625, 1.4837781250000002, 1.485234375, 1.481015625, 1.466853125, 1.4803125000000001, 1.480915625, 1.4845312499999999, 1.483125, 1.482421875, 1.473934375, 1.48729375, 1.4857875, 1.48443125, 1.483678125, 1.4858875, 1.48729375, 1.47885625, 1.480965625, 1.4745875000000002, 1.473834375, 1.4837781250000002, 1.479559375, 1.4802625, 1.471825, 1.48448125, 1.4845312499999999, 1.48171875, 1.4774, 1.473834375, 1.4732812499999999, 1.4859375, 1.483125, 1.441540625, 1.483075, 1.4816687499999999, 1.479559375, 1.485234375, 1.488046875, 1.468359375, 1.481015625, 1.4845312499999999, 1.47609375, 1.473884375, 1.4774500000000002, 1.478153125, 1.479559375, 1.460575, 1.48171875, 1.4845312499999999, 1.4782031249999998, 1.481015625, 1.4570093750000002, 1.483828125, 1.4823718750000001, 1.472428125, 1.483125, 1.480965625, 1.48171875, 1.476696875, 1.4746375, 1.4845312499999999, 1.4795093750000001, 1.483828125, 1.483125, 1.483828125, 1.479559375, 1.4858875, 1.481015625, 1.4837781250000002, 1.47599375, 1.48734375, 1.47599375, 1.479459375, 1.483125, 1.482221875, 1.48448125, 1.4674562500000001, 1.480965625, 1.473884375, 1.4845312499999999, 1.4745875000000002, 1.4802625, 1.483728125, 1.4823718750000001, 1.476796875, 1.483828125, 1.47885625, 1.47589375, 1.4773, 1.461028125, 1.4759437499999999, 1.479609375, 1.479559375, 1.483075, 1.4837781250000002, 1.481015625, 1.4766468750000001, 1.475390625, 1.488046875, 1.483828125, 1.483075, 1.47735, 1.482421875, 1.480965625, 1.4837781250000002, 1.4774500000000002, 1.485234375, 1.478153125, 1.4866406250000002, 1.4866406250000002, 1.485234375, 1.479559375, 1.4816687499999999, 1.47604375, 1.482421875, 1.4845312499999999, 1.4859375, 1.4745375, 1.4803125000000001, 1.4803125000000001], "episode_lengths": [45, 35, 33, 29, 36, 34, 22, 66, 33, 18, 21, 23, 18, 20, 29, 17, 27, 33, 28, 30, 23, 21, 27, 47, 28, 27, 22, 24, 25, 37, 18, 20, 22, 23, 20, 18, 30, 27, 36, 37, 23, 29, 28, 40, 22, 22, 26, 32, 37, 38, 20, 24, 83, 24, 26, 29, 21, 17, 45, 27, 22, 34, 37, 32, 31, 29, 56, 26, 22, 31, 27, 61, 23, 25, 39, 24, 27, 26, 33, 36, 22, 29, 23, 24, 23, 29, 20, 27, 23, 34, 18, 34, 29, 24, 25, 22, 46, 27, 37, 22, 36, 28, 23, 25, 33, 23, 30, 34, 32, 55, 34, 29, 29, 24, 23, 27, 33, 35, 17, 23, 24, 32, 25, 27, 23, 32, 21, 31, 19, 19, 21, 29, 26, 34, 25, 22, 20, 36, 28, 28], "policy_red_0_reward": [1.4682593750000001, 1.475290625, 1.476746875, 1.479609375, 1.4745875000000002, 1.47589375, 1.4845312499999999, 1.45359375, 1.4766468750000001, 1.48729375, 1.485184375, 1.4837781250000002, 1.48734375, 1.4858375000000001, 1.479609375, 1.4879968749999999, 1.480915625, 1.476746875, 1.4802125, 1.47875625, 1.4837781250000002, 1.485234375, 1.481015625, 1.466853125, 1.4803125000000001, 1.480915625, 1.4845312499999999, 1.483125, 1.482421875, 1.473934375, 1.48729375, 1.4857875, 1.48443125, 1.483678125, 1.4858875, 1.48729375, 1.47885625, 1.480965625, 1.4745875000000002, 1.473834375, 1.4837781250000002, 1.479559375, 1.4802625, 1.471825, 1.48448125, 1.4845312499999999, 1.48171875, 1.4774, 1.473834375, 1.4732812499999999, 1.4859375, 1.483125, 1.441540625, 1.483075, 1.4816687499999999, 1.479559375, 1.485234375, 1.488046875, 1.468359375, 1.481015625, 1.4845312499999999, 1.47609375, 1.473884375, 1.4774500000000002, 1.478153125, 1.479559375, 1.460575, 1.48171875, 1.4845312499999999, 1.4782031249999998, 1.481015625, 1.4570093750000002, 1.483828125, 1.4823718750000001, 1.472428125, 1.483125, 1.480965625, 1.48171875, 1.476696875, 1.4746375, 1.4845312499999999, 1.4795093750000001, 1.483828125, 1.483125, 1.483828125, 1.479559375, 1.4858875, 1.481015625, 1.4837781250000002, 1.47599375, 1.48734375, 1.47599375, 1.479459375, 1.483125, 1.482221875, 1.48448125, 1.4674562500000001, 1.480965625, 1.473884375, 1.4845312499999999, 1.4745875000000002, 1.4802625, 1.483728125, 1.4823718750000001, 1.476796875, 1.483828125, 1.47885625, 1.47589375, 1.4773, 1.461028125, 1.4759437499999999, 1.479609375, 1.479559375, 1.483075, 1.4837781250000002, 1.481015625, 1.4766468750000001, 1.475390625, 1.488046875, 1.483828125, 1.483075, 1.47735, 1.482421875, 1.480965625, 1.4837781250000002, 1.4774500000000002, 1.485234375, 1.478153125, 1.4866406250000002, 1.4866406250000002, 1.485234375, 1.479559375, 1.4816687499999999, 1.47604375, 1.482421875, 1.4845312499999999, 1.4859375, 1.4745375, 1.4803125000000001, 1.4803125000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4797055668567025, "mean_inference_ms": 3.5387465873475845, "mean_action_processing_ms": 0.1989278513626693, "mean_env_wait_ms": 0.23519189743554522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09227071489606585, "StateBufferConnector_ms": 0.008073874882289342, "ViewRequirementAgentConnector_ms": 0.15463982309613908}}, "episode_reward_max": 1.488046875, "episode_reward_min": 1.441540625, "episode_reward_mean": 1.4796759821428571, "episode_len_mean": 28.82857142857143, "episodes_this_iter": 140, "policy_reward_min": {"red_0": 1.441540625}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4796759821428571}, "hist_stats": {"episode_reward": [1.4682593750000001, 1.475290625, 1.476746875, 1.479609375, 1.4745875000000002, 1.47589375, 1.4845312499999999, 1.45359375, 1.4766468750000001, 1.48729375, 1.485184375, 1.4837781250000002, 1.48734375, 1.4858375000000001, 1.479609375, 1.4879968749999999, 1.480915625, 1.476746875, 1.4802125, 1.47875625, 1.4837781250000002, 1.485234375, 1.481015625, 1.466853125, 1.4803125000000001, 1.480915625, 1.4845312499999999, 1.483125, 1.482421875, 1.473934375, 1.48729375, 1.4857875, 1.48443125, 1.483678125, 1.4858875, 1.48729375, 1.47885625, 1.480965625, 1.4745875000000002, 1.473834375, 1.4837781250000002, 1.479559375, 1.4802625, 1.471825, 1.48448125, 1.4845312499999999, 1.48171875, 1.4774, 1.473834375, 1.4732812499999999, 1.4859375, 1.483125, 1.441540625, 1.483075, 1.4816687499999999, 1.479559375, 1.485234375, 1.488046875, 1.468359375, 1.481015625, 1.4845312499999999, 1.47609375, 1.473884375, 1.4774500000000002, 1.478153125, 1.479559375, 1.460575, 1.48171875, 1.4845312499999999, 1.4782031249999998, 1.481015625, 1.4570093750000002, 1.483828125, 1.4823718750000001, 1.472428125, 1.483125, 1.480965625, 1.48171875, 1.476696875, 1.4746375, 1.4845312499999999, 1.4795093750000001, 1.483828125, 1.483125, 1.483828125, 1.479559375, 1.4858875, 1.481015625, 1.4837781250000002, 1.47599375, 1.48734375, 1.47599375, 1.479459375, 1.483125, 1.482221875, 1.48448125, 1.4674562500000001, 1.480965625, 1.473884375, 1.4845312499999999, 1.4745875000000002, 1.4802625, 1.483728125, 1.4823718750000001, 1.476796875, 1.483828125, 1.47885625, 1.47589375, 1.4773, 1.461028125, 1.4759437499999999, 1.479609375, 1.479559375, 1.483075, 1.4837781250000002, 1.481015625, 1.4766468750000001, 1.475390625, 1.488046875, 1.483828125, 1.483075, 1.47735, 1.482421875, 1.480965625, 1.4837781250000002, 1.4774500000000002, 1.485234375, 1.478153125, 1.4866406250000002, 1.4866406250000002, 1.485234375, 1.479559375, 1.4816687499999999, 1.47604375, 1.482421875, 1.4845312499999999, 1.4859375, 1.4745375, 1.4803125000000001, 1.4803125000000001], "episode_lengths": [45, 35, 33, 29, 36, 34, 22, 66, 33, 18, 21, 23, 18, 20, 29, 17, 27, 33, 28, 30, 23, 21, 27, 47, 28, 27, 22, 24, 25, 37, 18, 20, 22, 23, 20, 18, 30, 27, 36, 37, 23, 29, 28, 40, 22, 22, 26, 32, 37, 38, 20, 24, 83, 24, 26, 29, 21, 17, 45, 27, 22, 34, 37, 32, 31, 29, 56, 26, 22, 31, 27, 61, 23, 25, 39, 24, 27, 26, 33, 36, 22, 29, 23, 24, 23, 29, 20, 27, 23, 34, 18, 34, 29, 24, 25, 22, 46, 27, 37, 22, 36, 28, 23, 25, 33, 23, 30, 34, 32, 55, 34, 29, 29, 24, 23, 27, 33, 35, 17, 23, 24, 32, 25, 27, 23, 32, 21, 31, 19, 19, 21, 29, 26, 34, 25, 22, 20, 36, 28, 28], "policy_red_0_reward": [1.4682593750000001, 1.475290625, 1.476746875, 1.479609375, 1.4745875000000002, 1.47589375, 1.4845312499999999, 1.45359375, 1.4766468750000001, 1.48729375, 1.485184375, 1.4837781250000002, 1.48734375, 1.4858375000000001, 1.479609375, 1.4879968749999999, 1.480915625, 1.476746875, 1.4802125, 1.47875625, 1.4837781250000002, 1.485234375, 1.481015625, 1.466853125, 1.4803125000000001, 1.480915625, 1.4845312499999999, 1.483125, 1.482421875, 1.473934375, 1.48729375, 1.4857875, 1.48443125, 1.483678125, 1.4858875, 1.48729375, 1.47885625, 1.480965625, 1.4745875000000002, 1.473834375, 1.4837781250000002, 1.479559375, 1.4802625, 1.471825, 1.48448125, 1.4845312499999999, 1.48171875, 1.4774, 1.473834375, 1.4732812499999999, 1.4859375, 1.483125, 1.441540625, 1.483075, 1.4816687499999999, 1.479559375, 1.485234375, 1.488046875, 1.468359375, 1.481015625, 1.4845312499999999, 1.47609375, 1.473884375, 1.4774500000000002, 1.478153125, 1.479559375, 1.460575, 1.48171875, 1.4845312499999999, 1.4782031249999998, 1.481015625, 1.4570093750000002, 1.483828125, 1.4823718750000001, 1.472428125, 1.483125, 1.480965625, 1.48171875, 1.476696875, 1.4746375, 1.4845312499999999, 1.4795093750000001, 1.483828125, 1.483125, 1.483828125, 1.479559375, 1.4858875, 1.481015625, 1.4837781250000002, 1.47599375, 1.48734375, 1.47599375, 1.479459375, 1.483125, 1.482221875, 1.48448125, 1.4674562500000001, 1.480965625, 1.473884375, 1.4845312499999999, 1.4745875000000002, 1.4802625, 1.483728125, 1.4823718750000001, 1.476796875, 1.483828125, 1.47885625, 1.47589375, 1.4773, 1.461028125, 1.4759437499999999, 1.479609375, 1.479559375, 1.483075, 1.4837781250000002, 1.481015625, 1.4766468750000001, 1.475390625, 1.488046875, 1.483828125, 1.483075, 1.47735, 1.482421875, 1.480965625, 1.4837781250000002, 1.4774500000000002, 1.485234375, 1.478153125, 1.4866406250000002, 1.4866406250000002, 1.485234375, 1.479559375, 1.4816687499999999, 1.47604375, 1.482421875, 1.4845312499999999, 1.4859375, 1.4745375, 1.4803125000000001, 1.4803125000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4797055668567025, "mean_inference_ms": 3.5387465873475845, "mean_action_processing_ms": 0.1989278513626693, "mean_env_wait_ms": 0.23519189743554522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09227071489606585, "StateBufferConnector_ms": 0.008073874882289342, "ViewRequirementAgentConnector_ms": 0.15463982309613908}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 122.51437296283318, "num_env_steps_trained_throughput_per_sec": 122.51437296283318, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 31487.023, "sample_time_ms": 18460.124, "learn_time_ms": 12955.089, "learn_throughput": 308.759, "synch_weights_time_ms": 70.977}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 645, "training_iteration": 35, "trial_id": "3c06e_00000", "date": "2023-09-12_14-47-03", "timestamp": 1694544423, "time_this_iter_s": 32.667784214019775, "time_total_s": 1074.1322808265686, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1074.1322808265686, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 29.685106382978713, "ram_util_percent": 20.225531914893615}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.674284694250673, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.03171221803883479, "policy_loss": -0.03876170960672122, "vf_loss": 0.0018678527588538902, "vf_explained_var": 0.9523029586300253, "kl": 0.02590819410231939, "entropy": 0.6400990797206759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 1.488046875, "episode_reward_min": 1.4515875, "episode_reward_mean": 1.4834357433431953, "episode_len_mean": 23.497041420118343, "episode_media": {}, "episodes_this_iter": 169, "policy_reward_min": {"red_0": 1.4515875}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4834357433431953}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.485234375, 1.479459375, 1.482321875, 1.488046875, 1.483828125, 1.4837781250000002, 1.483125, 1.4823718750000001, 1.488046875, 1.488046875, 1.483828125, 1.48448125, 1.483125, 1.483125, 1.47885625, 1.486590625, 1.483125, 1.483828125, 1.483075, 1.4866406250000002, 1.485184375, 1.483828125, 1.485134375, 1.4788062499999999, 1.48734375, 1.4816687499999999, 1.48443125, 1.4816687499999999, 1.4808656249999999, 1.483075, 1.483125, 1.4845312499999999, 1.483828125, 1.4802625, 1.4866406250000002, 1.48156875, 1.48734375, 1.48438125, 1.483828125, 1.483125, 1.48729375, 1.486540625, 1.48171875, 1.480965625, 1.481015625, 1.483125, 1.485234375, 1.483075, 1.480965625, 1.488046875, 1.4866406250000002, 1.488046875, 1.483125, 1.476746875, 1.48448125, 1.48734375, 1.485134375, 1.483075, 1.4816687499999999, 1.4866406250000002, 1.485234375, 1.479559375, 1.485234375, 1.4746375, 1.485234375, 1.4795093750000001, 1.4859375, 1.485134375, 1.4816687499999999, 1.48734375, 1.4515875, 1.483728125, 1.483125, 1.4845312499999999, 1.48734375, 1.48724375, 1.469565625, 1.485184375, 1.485234375, 1.488046875, 1.4858875, 1.483728125, 1.4866406250000002, 1.4857875, 1.48443125, 1.48729375, 1.481015625, 1.483075, 1.483025, 1.4845312499999999, 1.47599375, 1.483728125, 1.478153125, 1.488046875, 1.4845312499999999, 1.483125, 1.4816687499999999, 1.480815625, 1.488046875, 1.47890625, 1.482321875, 1.482421875, 1.485234375, 1.4845312499999999, 1.4802625, 1.4845312499999999, 1.48448125, 1.4845312499999999, 1.488046875, 1.485234375, 1.483828125, 1.482421875, 1.4775, 1.48734375, 1.488046875, 1.479609375, 1.48448125, 1.4859375, 1.488046875, 1.480965625, 1.4858875, 1.4858875, 1.4845312499999999, 1.483828125, 1.475390625, 1.4795093750000001, 1.476746875, 1.483125, 1.4845312499999999, 1.48729375, 1.483125, 1.4866406250000002, 1.48161875, 1.4858875, 1.485234375, 1.483125, 1.4803125000000001, 1.481015625, 1.482421875, 1.4753406249999999, 1.4816687499999999, 1.48448125, 1.48729375, 1.4845312499999999, 1.483628125, 1.4800625, 1.488046875, 1.48448125, 1.4859375, 1.4858875, 1.485184375, 1.4858875, 1.487946875, 1.4858875, 1.4759437499999999, 1.483828125, 1.486590625, 1.485234375, 1.47599375, 1.4859375, 1.488046875, 1.4816687499999999, 1.4837781250000002, 1.488046875, 1.473884375, 1.486590625, 1.477953125, 1.483075, 1.4859375], "episode_lengths": [21, 29, 25, 17, 23, 23, 24, 25, 17, 17, 23, 22, 24, 24, 30, 19, 24, 23, 24, 19, 21, 23, 21, 30, 18, 26, 22, 26, 27, 24, 24, 22, 23, 28, 19, 26, 18, 22, 23, 24, 18, 19, 26, 27, 27, 24, 21, 24, 27, 17, 19, 17, 24, 33, 22, 18, 21, 24, 26, 19, 21, 29, 21, 36, 21, 29, 20, 21, 26, 18, 68, 23, 24, 22, 18, 18, 43, 21, 21, 17, 20, 23, 19, 20, 22, 18, 27, 24, 24, 22, 34, 23, 31, 17, 22, 24, 26, 27, 17, 30, 25, 25, 21, 22, 28, 22, 22, 22, 17, 21, 23, 25, 32, 18, 17, 29, 22, 20, 17, 27, 20, 20, 22, 23, 35, 29, 33, 24, 22, 18, 24, 19, 26, 20, 21, 24, 28, 27, 25, 35, 26, 22, 18, 22, 23, 28, 17, 22, 20, 20, 21, 20, 17, 20, 34, 23, 19, 21, 34, 20, 17, 26, 23, 17, 37, 19, 31, 24, 20], "policy_red_0_reward": [1.485234375, 1.479459375, 1.482321875, 1.488046875, 1.483828125, 1.4837781250000002, 1.483125, 1.4823718750000001, 1.488046875, 1.488046875, 1.483828125, 1.48448125, 1.483125, 1.483125, 1.47885625, 1.486590625, 1.483125, 1.483828125, 1.483075, 1.4866406250000002, 1.485184375, 1.483828125, 1.485134375, 1.4788062499999999, 1.48734375, 1.4816687499999999, 1.48443125, 1.4816687499999999, 1.4808656249999999, 1.483075, 1.483125, 1.4845312499999999, 1.483828125, 1.4802625, 1.4866406250000002, 1.48156875, 1.48734375, 1.48438125, 1.483828125, 1.483125, 1.48729375, 1.486540625, 1.48171875, 1.480965625, 1.481015625, 1.483125, 1.485234375, 1.483075, 1.480965625, 1.488046875, 1.4866406250000002, 1.488046875, 1.483125, 1.476746875, 1.48448125, 1.48734375, 1.485134375, 1.483075, 1.4816687499999999, 1.4866406250000002, 1.485234375, 1.479559375, 1.485234375, 1.4746375, 1.485234375, 1.4795093750000001, 1.4859375, 1.485134375, 1.4816687499999999, 1.48734375, 1.4515875, 1.483728125, 1.483125, 1.4845312499999999, 1.48734375, 1.48724375, 1.469565625, 1.485184375, 1.485234375, 1.488046875, 1.4858875, 1.483728125, 1.4866406250000002, 1.4857875, 1.48443125, 1.48729375, 1.481015625, 1.483075, 1.483025, 1.4845312499999999, 1.47599375, 1.483728125, 1.478153125, 1.488046875, 1.4845312499999999, 1.483125, 1.4816687499999999, 1.480815625, 1.488046875, 1.47890625, 1.482321875, 1.482421875, 1.485234375, 1.4845312499999999, 1.4802625, 1.4845312499999999, 1.48448125, 1.4845312499999999, 1.488046875, 1.485234375, 1.483828125, 1.482421875, 1.4775, 1.48734375, 1.488046875, 1.479609375, 1.48448125, 1.4859375, 1.488046875, 1.480965625, 1.4858875, 1.4858875, 1.4845312499999999, 1.483828125, 1.475390625, 1.4795093750000001, 1.476746875, 1.483125, 1.4845312499999999, 1.48729375, 1.483125, 1.4866406250000002, 1.48161875, 1.4858875, 1.485234375, 1.483125, 1.4803125000000001, 1.481015625, 1.482421875, 1.4753406249999999, 1.4816687499999999, 1.48448125, 1.48729375, 1.4845312499999999, 1.483628125, 1.4800625, 1.488046875, 1.48448125, 1.4859375, 1.4858875, 1.485184375, 1.4858875, 1.487946875, 1.4858875, 1.4759437499999999, 1.483828125, 1.486590625, 1.485234375, 1.47599375, 1.4859375, 1.488046875, 1.4816687499999999, 1.4837781250000002, 1.488046875, 1.473884375, 1.486590625, 1.477953125, 1.483075, 1.4859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.482294387220171, "mean_inference_ms": 3.541336324915997, "mean_action_processing_ms": 0.1991154872160731, "mean_env_wait_ms": 0.23575103395159433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09678566949607352, "StateBufferConnector_ms": 0.008074771723098303, "ViewRequirementAgentConnector_ms": 0.1553055802745932}}, "episode_reward_max": 1.488046875, "episode_reward_min": 1.4515875, "episode_reward_mean": 1.4834357433431953, "episode_len_mean": 23.497041420118343, "episodes_this_iter": 169, "policy_reward_min": {"red_0": 1.4515875}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4834357433431953}, "hist_stats": {"episode_reward": [1.485234375, 1.479459375, 1.482321875, 1.488046875, 1.483828125, 1.4837781250000002, 1.483125, 1.4823718750000001, 1.488046875, 1.488046875, 1.483828125, 1.48448125, 1.483125, 1.483125, 1.47885625, 1.486590625, 1.483125, 1.483828125, 1.483075, 1.4866406250000002, 1.485184375, 1.483828125, 1.485134375, 1.4788062499999999, 1.48734375, 1.4816687499999999, 1.48443125, 1.4816687499999999, 1.4808656249999999, 1.483075, 1.483125, 1.4845312499999999, 1.483828125, 1.4802625, 1.4866406250000002, 1.48156875, 1.48734375, 1.48438125, 1.483828125, 1.483125, 1.48729375, 1.486540625, 1.48171875, 1.480965625, 1.481015625, 1.483125, 1.485234375, 1.483075, 1.480965625, 1.488046875, 1.4866406250000002, 1.488046875, 1.483125, 1.476746875, 1.48448125, 1.48734375, 1.485134375, 1.483075, 1.4816687499999999, 1.4866406250000002, 1.485234375, 1.479559375, 1.485234375, 1.4746375, 1.485234375, 1.4795093750000001, 1.4859375, 1.485134375, 1.4816687499999999, 1.48734375, 1.4515875, 1.483728125, 1.483125, 1.4845312499999999, 1.48734375, 1.48724375, 1.469565625, 1.485184375, 1.485234375, 1.488046875, 1.4858875, 1.483728125, 1.4866406250000002, 1.4857875, 1.48443125, 1.48729375, 1.481015625, 1.483075, 1.483025, 1.4845312499999999, 1.47599375, 1.483728125, 1.478153125, 1.488046875, 1.4845312499999999, 1.483125, 1.4816687499999999, 1.480815625, 1.488046875, 1.47890625, 1.482321875, 1.482421875, 1.485234375, 1.4845312499999999, 1.4802625, 1.4845312499999999, 1.48448125, 1.4845312499999999, 1.488046875, 1.485234375, 1.483828125, 1.482421875, 1.4775, 1.48734375, 1.488046875, 1.479609375, 1.48448125, 1.4859375, 1.488046875, 1.480965625, 1.4858875, 1.4858875, 1.4845312499999999, 1.483828125, 1.475390625, 1.4795093750000001, 1.476746875, 1.483125, 1.4845312499999999, 1.48729375, 1.483125, 1.4866406250000002, 1.48161875, 1.4858875, 1.485234375, 1.483125, 1.4803125000000001, 1.481015625, 1.482421875, 1.4753406249999999, 1.4816687499999999, 1.48448125, 1.48729375, 1.4845312499999999, 1.483628125, 1.4800625, 1.488046875, 1.48448125, 1.4859375, 1.4858875, 1.485184375, 1.4858875, 1.487946875, 1.4858875, 1.4759437499999999, 1.483828125, 1.486590625, 1.485234375, 1.47599375, 1.4859375, 1.488046875, 1.4816687499999999, 1.4837781250000002, 1.488046875, 1.473884375, 1.486590625, 1.477953125, 1.483075, 1.4859375], "episode_lengths": [21, 29, 25, 17, 23, 23, 24, 25, 17, 17, 23, 22, 24, 24, 30, 19, 24, 23, 24, 19, 21, 23, 21, 30, 18, 26, 22, 26, 27, 24, 24, 22, 23, 28, 19, 26, 18, 22, 23, 24, 18, 19, 26, 27, 27, 24, 21, 24, 27, 17, 19, 17, 24, 33, 22, 18, 21, 24, 26, 19, 21, 29, 21, 36, 21, 29, 20, 21, 26, 18, 68, 23, 24, 22, 18, 18, 43, 21, 21, 17, 20, 23, 19, 20, 22, 18, 27, 24, 24, 22, 34, 23, 31, 17, 22, 24, 26, 27, 17, 30, 25, 25, 21, 22, 28, 22, 22, 22, 17, 21, 23, 25, 32, 18, 17, 29, 22, 20, 17, 27, 20, 20, 22, 23, 35, 29, 33, 24, 22, 18, 24, 19, 26, 20, 21, 24, 28, 27, 25, 35, 26, 22, 18, 22, 23, 28, 17, 22, 20, 20, 21, 20, 17, 20, 34, 23, 19, 21, 34, 20, 17, 26, 23, 17, 37, 19, 31, 24, 20], "policy_red_0_reward": [1.485234375, 1.479459375, 1.482321875, 1.488046875, 1.483828125, 1.4837781250000002, 1.483125, 1.4823718750000001, 1.488046875, 1.488046875, 1.483828125, 1.48448125, 1.483125, 1.483125, 1.47885625, 1.486590625, 1.483125, 1.483828125, 1.483075, 1.4866406250000002, 1.485184375, 1.483828125, 1.485134375, 1.4788062499999999, 1.48734375, 1.4816687499999999, 1.48443125, 1.4816687499999999, 1.4808656249999999, 1.483075, 1.483125, 1.4845312499999999, 1.483828125, 1.4802625, 1.4866406250000002, 1.48156875, 1.48734375, 1.48438125, 1.483828125, 1.483125, 1.48729375, 1.486540625, 1.48171875, 1.480965625, 1.481015625, 1.483125, 1.485234375, 1.483075, 1.480965625, 1.488046875, 1.4866406250000002, 1.488046875, 1.483125, 1.476746875, 1.48448125, 1.48734375, 1.485134375, 1.483075, 1.4816687499999999, 1.4866406250000002, 1.485234375, 1.479559375, 1.485234375, 1.4746375, 1.485234375, 1.4795093750000001, 1.4859375, 1.485134375, 1.4816687499999999, 1.48734375, 1.4515875, 1.483728125, 1.483125, 1.4845312499999999, 1.48734375, 1.48724375, 1.469565625, 1.485184375, 1.485234375, 1.488046875, 1.4858875, 1.483728125, 1.4866406250000002, 1.4857875, 1.48443125, 1.48729375, 1.481015625, 1.483075, 1.483025, 1.4845312499999999, 1.47599375, 1.483728125, 1.478153125, 1.488046875, 1.4845312499999999, 1.483125, 1.4816687499999999, 1.480815625, 1.488046875, 1.47890625, 1.482321875, 1.482421875, 1.485234375, 1.4845312499999999, 1.4802625, 1.4845312499999999, 1.48448125, 1.4845312499999999, 1.488046875, 1.485234375, 1.483828125, 1.482421875, 1.4775, 1.48734375, 1.488046875, 1.479609375, 1.48448125, 1.4859375, 1.488046875, 1.480965625, 1.4858875, 1.4858875, 1.4845312499999999, 1.483828125, 1.475390625, 1.4795093750000001, 1.476746875, 1.483125, 1.4845312499999999, 1.48729375, 1.483125, 1.4866406250000002, 1.48161875, 1.4858875, 1.485234375, 1.483125, 1.4803125000000001, 1.481015625, 1.482421875, 1.4753406249999999, 1.4816687499999999, 1.48448125, 1.48729375, 1.4845312499999999, 1.483628125, 1.4800625, 1.488046875, 1.48448125, 1.4859375, 1.4858875, 1.485184375, 1.4858875, 1.487946875, 1.4858875, 1.4759437499999999, 1.483828125, 1.486590625, 1.485234375, 1.47599375, 1.4859375, 1.488046875, 1.4816687499999999, 1.4837781250000002, 1.488046875, 1.473884375, 1.486590625, 1.477953125, 1.483075, 1.4859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.482294387220171, "mean_inference_ms": 3.541336324915997, "mean_action_processing_ms": 0.1991154872160731, "mean_env_wait_ms": 0.23575103395159433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09678566949607352, "StateBufferConnector_ms": 0.008074771723098303, "ViewRequirementAgentConnector_ms": 0.1553055802745932}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.0852013649243, "num_env_steps_trained_throughput_per_sec": 102.0852013649243, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 32343.088, "sample_time_ms": 18537.578, "learn_time_ms": 13733.296, "learn_throughput": 291.263, "synch_weights_time_ms": 71.388}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 814, "training_iteration": 36, "trial_id": "3c06e_00000", "date": "2023-09-12_14-47-42", "timestamp": 1694544462, "time_this_iter_s": 39.2050518989563, "time_total_s": 1113.337332725525, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a64d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1113.337332725525, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 40.035714285714285, "ram_util_percent": 21.23392857142857}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3119673448614777, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.02585214901191648, "policy_loss": -0.0311828943954121, "vf_loss": 0.001094643643652186, "vf_explained_var": 0.973536984436214, "kl": 0.014120336861753839, "entropy": 0.5086406211679181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4753406249999999, "episode_reward_mean": 1.485801984375, "episode_len_mean": 20.165, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {"red_0": 1.4753406249999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.485801984375}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.483828125, 1.48875, 1.48734375, 1.486540625, 1.4879968749999999, 1.485234375, 1.4858875, 1.4866406250000002, 1.480965625, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.48156875, 1.489453125, 1.4845312499999999, 1.485234375, 1.4866406250000002, 1.48729375, 1.488046875, 1.4795093750000001, 1.48734375, 1.488046875, 1.4859375, 1.4859375, 1.486590625, 1.4859375, 1.488046875, 1.487946875, 1.488046875, 1.483828125, 1.4858875, 1.48734375, 1.488046875, 1.4858375000000001, 1.485234375, 1.488046875, 1.4859375, 1.4753406249999999, 1.483125, 1.48448125, 1.48734375, 1.485184375, 1.488046875, 1.4788062499999999, 1.486590625, 1.4866406250000002, 1.48875, 1.48734375, 1.48734375, 1.48729375, 1.485234375, 1.4887000000000001, 1.488046875, 1.4858875, 1.4879968749999999, 1.4859375, 1.4858875, 1.4859375, 1.489453125, 1.4802625, 1.488046875, 1.4845312499999999, 1.482421875, 1.489453125, 1.485234375, 1.489453125, 1.483075, 1.48875, 1.48875, 1.48734375, 1.4823718750000001, 1.48734375, 1.4866406250000002, 1.488046875, 1.488046875, 1.4859375, 1.488046875, 1.483075, 1.485184375, 1.485134375, 1.48734375, 1.4866406250000002, 1.4775, 1.48729375, 1.488046875, 1.488046875, 1.48724375, 1.488046875, 1.4837781250000002, 1.4866406250000002, 1.489453125, 1.48734375, 1.485184375, 1.485234375, 1.487946875, 1.4845312499999999, 1.4866406250000002, 1.483828125, 1.485234375, 1.488046875, 1.485234375, 1.48734375, 1.485234375, 1.4859375, 1.48448125, 1.483728125, 1.4859375, 1.485234375, 1.48734375, 1.48875, 1.48448125, 1.4858875, 1.4859375, 1.48443125, 1.4859375, 1.4845312499999999, 1.4859375, 1.482421875, 1.4845312499999999, 1.488046875, 1.4866406250000002, 1.4879968749999999, 1.4858875, 1.48734375, 1.4866406250000002, 1.4845312499999999, 1.486590625, 1.48448125, 1.488046875, 1.48734375, 1.4859375, 1.48729375, 1.48448125, 1.488046875, 1.483125, 1.48729375, 1.48875, 1.485234375, 1.48734375, 1.482421875, 1.4845312499999999, 1.47890625, 1.489453125, 1.483828125, 1.48875, 1.482321875, 1.4845312499999999, 1.4866406250000002, 1.4845312499999999, 1.48734375, 1.482421875, 1.4845312499999999, 1.47885625, 1.4816687499999999, 1.48171875, 1.483125, 1.489453125, 1.485234375, 1.4859375, 1.485234375, 1.47890625, 1.48734375, 1.48734375, 1.4866406250000002, 1.48729375, 1.48171875, 1.4887000000000001, 1.48729375, 1.483828125, 1.4845312499999999, 1.482421875, 1.4859375, 1.4858875, 1.4887000000000001, 1.488046875, 1.48734375, 1.4845312499999999, 1.488046875, 1.483828125, 1.489453125, 1.4816687499999999, 1.479459375, 1.485134375, 1.489453125, 1.4879968749999999, 1.4866406250000002, 1.483828125, 1.4859375, 1.483125, 1.48729375, 1.4866406250000002, 1.485234375, 1.486590625, 1.48875, 1.4859375, 1.4866406250000002, 1.4857875, 1.4802625, 1.4775], "episode_lengths": [23, 16, 18, 19, 17, 21, 20, 19, 27, 20, 17, 15, 15, 26, 15, 22, 21, 19, 18, 17, 29, 18, 17, 20, 20, 19, 20, 17, 17, 17, 23, 20, 18, 17, 20, 21, 17, 20, 35, 24, 22, 18, 21, 17, 30, 19, 19, 16, 18, 18, 18, 21, 16, 17, 20, 17, 20, 20, 20, 15, 28, 17, 22, 25, 15, 21, 15, 24, 16, 16, 18, 25, 18, 19, 17, 17, 20, 17, 24, 21, 21, 18, 19, 32, 18, 17, 17, 18, 17, 23, 19, 15, 18, 21, 21, 17, 22, 19, 23, 21, 17, 21, 18, 21, 20, 22, 23, 20, 21, 18, 16, 22, 20, 20, 22, 20, 22, 20, 25, 22, 17, 19, 17, 20, 18, 19, 22, 19, 22, 17, 18, 20, 18, 22, 17, 24, 18, 16, 21, 18, 25, 22, 30, 15, 23, 16, 25, 22, 19, 22, 18, 25, 22, 30, 26, 26, 24, 15, 21, 20, 21, 30, 18, 18, 19, 18, 26, 16, 18, 23, 22, 25, 20, 20, 16, 17, 18, 22, 17, 23, 15, 26, 29, 21, 15, 17, 19, 23, 20, 24, 18, 19, 21, 19, 16, 20, 19, 20, 28, 32], "policy_red_0_reward": [1.483828125, 1.48875, 1.48734375, 1.486540625, 1.4879968749999999, 1.485234375, 1.4858875, 1.4866406250000002, 1.480965625, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.48156875, 1.489453125, 1.4845312499999999, 1.485234375, 1.4866406250000002, 1.48729375, 1.488046875, 1.4795093750000001, 1.48734375, 1.488046875, 1.4859375, 1.4859375, 1.486590625, 1.4859375, 1.488046875, 1.487946875, 1.488046875, 1.483828125, 1.4858875, 1.48734375, 1.488046875, 1.4858375000000001, 1.485234375, 1.488046875, 1.4859375, 1.4753406249999999, 1.483125, 1.48448125, 1.48734375, 1.485184375, 1.488046875, 1.4788062499999999, 1.486590625, 1.4866406250000002, 1.48875, 1.48734375, 1.48734375, 1.48729375, 1.485234375, 1.4887000000000001, 1.488046875, 1.4858875, 1.4879968749999999, 1.4859375, 1.4858875, 1.4859375, 1.489453125, 1.4802625, 1.488046875, 1.4845312499999999, 1.482421875, 1.489453125, 1.485234375, 1.489453125, 1.483075, 1.48875, 1.48875, 1.48734375, 1.4823718750000001, 1.48734375, 1.4866406250000002, 1.488046875, 1.488046875, 1.4859375, 1.488046875, 1.483075, 1.485184375, 1.485134375, 1.48734375, 1.4866406250000002, 1.4775, 1.48729375, 1.488046875, 1.488046875, 1.48724375, 1.488046875, 1.4837781250000002, 1.4866406250000002, 1.489453125, 1.48734375, 1.485184375, 1.485234375, 1.487946875, 1.4845312499999999, 1.4866406250000002, 1.483828125, 1.485234375, 1.488046875, 1.485234375, 1.48734375, 1.485234375, 1.4859375, 1.48448125, 1.483728125, 1.4859375, 1.485234375, 1.48734375, 1.48875, 1.48448125, 1.4858875, 1.4859375, 1.48443125, 1.4859375, 1.4845312499999999, 1.4859375, 1.482421875, 1.4845312499999999, 1.488046875, 1.4866406250000002, 1.4879968749999999, 1.4858875, 1.48734375, 1.4866406250000002, 1.4845312499999999, 1.486590625, 1.48448125, 1.488046875, 1.48734375, 1.4859375, 1.48729375, 1.48448125, 1.488046875, 1.483125, 1.48729375, 1.48875, 1.485234375, 1.48734375, 1.482421875, 1.4845312499999999, 1.47890625, 1.489453125, 1.483828125, 1.48875, 1.482321875, 1.4845312499999999, 1.4866406250000002, 1.4845312499999999, 1.48734375, 1.482421875, 1.4845312499999999, 1.47885625, 1.4816687499999999, 1.48171875, 1.483125, 1.489453125, 1.485234375, 1.4859375, 1.485234375, 1.47890625, 1.48734375, 1.48734375, 1.4866406250000002, 1.48729375, 1.48171875, 1.4887000000000001, 1.48729375, 1.483828125, 1.4845312499999999, 1.482421875, 1.4859375, 1.4858875, 1.4887000000000001, 1.488046875, 1.48734375, 1.4845312499999999, 1.488046875, 1.483828125, 1.489453125, 1.4816687499999999, 1.479459375, 1.485134375, 1.489453125, 1.4879968749999999, 1.4866406250000002, 1.483828125, 1.4859375, 1.483125, 1.48729375, 1.4866406250000002, 1.485234375, 1.486590625, 1.48875, 1.4859375, 1.4866406250000002, 1.4857875, 1.4802625, 1.4775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4857291741819287, "mean_inference_ms": 3.5464498522507, "mean_action_processing_ms": 0.199439216969698, "mean_env_wait_ms": 0.23661232221755582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10114002227783203, "StateBufferConnector_ms": 0.008354544639587402, "ViewRequirementAgentConnector_ms": 0.16127455234527588}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4753406249999999, "episode_reward_mean": 1.485801984375, "episode_len_mean": 20.165, "episodes_this_iter": 200, "policy_reward_min": {"red_0": 1.4753406249999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.485801984375}, "hist_stats": {"episode_reward": [1.483828125, 1.48875, 1.48734375, 1.486540625, 1.4879968749999999, 1.485234375, 1.4858875, 1.4866406250000002, 1.480965625, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.48156875, 1.489453125, 1.4845312499999999, 1.485234375, 1.4866406250000002, 1.48729375, 1.488046875, 1.4795093750000001, 1.48734375, 1.488046875, 1.4859375, 1.4859375, 1.486590625, 1.4859375, 1.488046875, 1.487946875, 1.488046875, 1.483828125, 1.4858875, 1.48734375, 1.488046875, 1.4858375000000001, 1.485234375, 1.488046875, 1.4859375, 1.4753406249999999, 1.483125, 1.48448125, 1.48734375, 1.485184375, 1.488046875, 1.4788062499999999, 1.486590625, 1.4866406250000002, 1.48875, 1.48734375, 1.48734375, 1.48729375, 1.485234375, 1.4887000000000001, 1.488046875, 1.4858875, 1.4879968749999999, 1.4859375, 1.4858875, 1.4859375, 1.489453125, 1.4802625, 1.488046875, 1.4845312499999999, 1.482421875, 1.489453125, 1.485234375, 1.489453125, 1.483075, 1.48875, 1.48875, 1.48734375, 1.4823718750000001, 1.48734375, 1.4866406250000002, 1.488046875, 1.488046875, 1.4859375, 1.488046875, 1.483075, 1.485184375, 1.485134375, 1.48734375, 1.4866406250000002, 1.4775, 1.48729375, 1.488046875, 1.488046875, 1.48724375, 1.488046875, 1.4837781250000002, 1.4866406250000002, 1.489453125, 1.48734375, 1.485184375, 1.485234375, 1.487946875, 1.4845312499999999, 1.4866406250000002, 1.483828125, 1.485234375, 1.488046875, 1.485234375, 1.48734375, 1.485234375, 1.4859375, 1.48448125, 1.483728125, 1.4859375, 1.485234375, 1.48734375, 1.48875, 1.48448125, 1.4858875, 1.4859375, 1.48443125, 1.4859375, 1.4845312499999999, 1.4859375, 1.482421875, 1.4845312499999999, 1.488046875, 1.4866406250000002, 1.4879968749999999, 1.4858875, 1.48734375, 1.4866406250000002, 1.4845312499999999, 1.486590625, 1.48448125, 1.488046875, 1.48734375, 1.4859375, 1.48729375, 1.48448125, 1.488046875, 1.483125, 1.48729375, 1.48875, 1.485234375, 1.48734375, 1.482421875, 1.4845312499999999, 1.47890625, 1.489453125, 1.483828125, 1.48875, 1.482321875, 1.4845312499999999, 1.4866406250000002, 1.4845312499999999, 1.48734375, 1.482421875, 1.4845312499999999, 1.47885625, 1.4816687499999999, 1.48171875, 1.483125, 1.489453125, 1.485234375, 1.4859375, 1.485234375, 1.47890625, 1.48734375, 1.48734375, 1.4866406250000002, 1.48729375, 1.48171875, 1.4887000000000001, 1.48729375, 1.483828125, 1.4845312499999999, 1.482421875, 1.4859375, 1.4858875, 1.4887000000000001, 1.488046875, 1.48734375, 1.4845312499999999, 1.488046875, 1.483828125, 1.489453125, 1.4816687499999999, 1.479459375, 1.485134375, 1.489453125, 1.4879968749999999, 1.4866406250000002, 1.483828125, 1.4859375, 1.483125, 1.48729375, 1.4866406250000002, 1.485234375, 1.486590625, 1.48875, 1.4859375, 1.4866406250000002, 1.4857875, 1.4802625, 1.4775], "episode_lengths": [23, 16, 18, 19, 17, 21, 20, 19, 27, 20, 17, 15, 15, 26, 15, 22, 21, 19, 18, 17, 29, 18, 17, 20, 20, 19, 20, 17, 17, 17, 23, 20, 18, 17, 20, 21, 17, 20, 35, 24, 22, 18, 21, 17, 30, 19, 19, 16, 18, 18, 18, 21, 16, 17, 20, 17, 20, 20, 20, 15, 28, 17, 22, 25, 15, 21, 15, 24, 16, 16, 18, 25, 18, 19, 17, 17, 20, 17, 24, 21, 21, 18, 19, 32, 18, 17, 17, 18, 17, 23, 19, 15, 18, 21, 21, 17, 22, 19, 23, 21, 17, 21, 18, 21, 20, 22, 23, 20, 21, 18, 16, 22, 20, 20, 22, 20, 22, 20, 25, 22, 17, 19, 17, 20, 18, 19, 22, 19, 22, 17, 18, 20, 18, 22, 17, 24, 18, 16, 21, 18, 25, 22, 30, 15, 23, 16, 25, 22, 19, 22, 18, 25, 22, 30, 26, 26, 24, 15, 21, 20, 21, 30, 18, 18, 19, 18, 26, 16, 18, 23, 22, 25, 20, 20, 16, 17, 18, 22, 17, 23, 15, 26, 29, 21, 15, 17, 19, 23, 20, 24, 18, 19, 21, 19, 16, 20, 19, 20, 28, 32], "policy_red_0_reward": [1.483828125, 1.48875, 1.48734375, 1.486540625, 1.4879968749999999, 1.485234375, 1.4858875, 1.4866406250000002, 1.480965625, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.48156875, 1.489453125, 1.4845312499999999, 1.485234375, 1.4866406250000002, 1.48729375, 1.488046875, 1.4795093750000001, 1.48734375, 1.488046875, 1.4859375, 1.4859375, 1.486590625, 1.4859375, 1.488046875, 1.487946875, 1.488046875, 1.483828125, 1.4858875, 1.48734375, 1.488046875, 1.4858375000000001, 1.485234375, 1.488046875, 1.4859375, 1.4753406249999999, 1.483125, 1.48448125, 1.48734375, 1.485184375, 1.488046875, 1.4788062499999999, 1.486590625, 1.4866406250000002, 1.48875, 1.48734375, 1.48734375, 1.48729375, 1.485234375, 1.4887000000000001, 1.488046875, 1.4858875, 1.4879968749999999, 1.4859375, 1.4858875, 1.4859375, 1.489453125, 1.4802625, 1.488046875, 1.4845312499999999, 1.482421875, 1.489453125, 1.485234375, 1.489453125, 1.483075, 1.48875, 1.48875, 1.48734375, 1.4823718750000001, 1.48734375, 1.4866406250000002, 1.488046875, 1.488046875, 1.4859375, 1.488046875, 1.483075, 1.485184375, 1.485134375, 1.48734375, 1.4866406250000002, 1.4775, 1.48729375, 1.488046875, 1.488046875, 1.48724375, 1.488046875, 1.4837781250000002, 1.4866406250000002, 1.489453125, 1.48734375, 1.485184375, 1.485234375, 1.487946875, 1.4845312499999999, 1.4866406250000002, 1.483828125, 1.485234375, 1.488046875, 1.485234375, 1.48734375, 1.485234375, 1.4859375, 1.48448125, 1.483728125, 1.4859375, 1.485234375, 1.48734375, 1.48875, 1.48448125, 1.4858875, 1.4859375, 1.48443125, 1.4859375, 1.4845312499999999, 1.4859375, 1.482421875, 1.4845312499999999, 1.488046875, 1.4866406250000002, 1.4879968749999999, 1.4858875, 1.48734375, 1.4866406250000002, 1.4845312499999999, 1.486590625, 1.48448125, 1.488046875, 1.48734375, 1.4859375, 1.48729375, 1.48448125, 1.488046875, 1.483125, 1.48729375, 1.48875, 1.485234375, 1.48734375, 1.482421875, 1.4845312499999999, 1.47890625, 1.489453125, 1.483828125, 1.48875, 1.482321875, 1.4845312499999999, 1.4866406250000002, 1.4845312499999999, 1.48734375, 1.482421875, 1.4845312499999999, 1.47885625, 1.4816687499999999, 1.48171875, 1.483125, 1.489453125, 1.485234375, 1.4859375, 1.485234375, 1.47890625, 1.48734375, 1.48734375, 1.4866406250000002, 1.48729375, 1.48171875, 1.4887000000000001, 1.48729375, 1.483828125, 1.4845312499999999, 1.482421875, 1.4859375, 1.4858875, 1.4887000000000001, 1.488046875, 1.48734375, 1.4845312499999999, 1.488046875, 1.483828125, 1.489453125, 1.4816687499999999, 1.479459375, 1.485134375, 1.489453125, 1.4879968749999999, 1.4866406250000002, 1.483828125, 1.4859375, 1.483125, 1.48729375, 1.4866406250000002, 1.485234375, 1.486590625, 1.48875, 1.4859375, 1.4866406250000002, 1.4857875, 1.4802625, 1.4775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4857291741819287, "mean_inference_ms": 3.5464498522507, "mean_action_processing_ms": 0.199439216969698, "mean_env_wait_ms": 0.23661232221755582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10114002227783203, "StateBufferConnector_ms": 0.008354544639587402, "ViewRequirementAgentConnector_ms": 0.16127455234527588}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 122.0685650091067, "num_env_steps_trained_throughput_per_sec": 122.0685650091067, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 32527.339, "sample_time_ms": 18659.312, "learn_time_ms": 13796.537, "learn_throughput": 289.928, "synch_weights_time_ms": 70.656}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1014, "training_iteration": 37, "trial_id": "3c06e_00000", "date": "2023-09-12_14-48-16", "timestamp": 1694544496, "time_this_iter_s": 32.7907931804657, "time_total_s": 1146.1281259059906, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147ba680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1146.1281259059906, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 29.556249999999995, "ram_util_percent": 23.287500000000005}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6616812360317756, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014242876786011039, "policy_loss": -0.023645682521358444, "vf_loss": 0.006476235411052282, "vf_explained_var": 0.8674913654103875, "kl": 0.009755234670531191, "entropy": 0.4560125007915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.44786875, "episode_reward_mean": 1.4871851635514022, "episode_len_mean": 18.205607476635514, "episode_media": {}, "episodes_this_iter": 214, "policy_reward_min": {"red_0": 1.44786875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4871851635514022}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.47609375, 1.488046875, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.4866406250000002, 1.485234375, 1.489453125, 1.488046875, 1.489453125, 1.4858875, 1.48734375, 1.4866406250000002, 1.48734375, 1.4858875, 1.485234375, 1.488046875, 1.48734375, 1.48729375, 1.489453125, 1.4866406250000002, 1.485184375, 1.4858875, 1.488046875, 1.485234375, 1.486590625, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48729375, 1.489453125, 1.486590625, 1.4845312499999999, 1.488046875, 1.486490625, 1.489453125, 1.486540625, 1.489453125, 1.488046875, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.488046875, 1.4859375, 1.48734375, 1.489453125, 1.4845312499999999, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.48729375, 1.488046875, 1.4858875, 1.48734375, 1.48875, 1.4859375, 1.488046875, 1.48734375, 1.488046875, 1.4866406250000002, 1.4859375, 1.488046875, 1.4866406250000002, 1.489453125, 1.485234375, 1.489453125, 1.4866406250000002, 1.485184375, 1.489453125, 1.489453125, 1.4866406250000002, 1.485184375, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.48875, 1.4859375, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.4879968749999999, 1.482421875, 1.48729375, 1.48875, 1.485134375, 1.48734375, 1.48734375, 1.485234375, 1.489453125, 1.48875, 1.4845312499999999, 1.4866406250000002, 1.4866406250000002, 1.48448125, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.488046875, 1.4879968749999999, 1.485234375, 1.44786875, 1.48734375, 1.4823718750000001, 1.48443125, 1.48729375, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.4887000000000001, 1.486590625, 1.4858875, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.4774500000000002, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.4879968749999999, 1.48875, 1.48734375, 1.487946875, 1.488046875, 1.4859375, 1.48875, 1.486540625, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4859375, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4887000000000001, 1.475390625, 1.483678125, 1.4879968749999999, 1.4858875, 1.488046875, 1.4858875, 1.488046875, 1.48734375, 1.489453125, 1.4879968749999999, 1.4866406250000002, 1.481015625, 1.488046875, 1.483125, 1.485184375, 1.48724375, 1.4866406250000002, 1.4866406250000002, 1.48875, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.485184375, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.485134375, 1.48734375, 1.48875, 1.489453125, 1.486590625, 1.48734375, 1.488046875, 1.48729375, 1.48875, 1.48875, 1.48734375, 1.483728125, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.48734375, 1.483075, 1.4845312499999999, 1.486540625, 1.489453125], "episode_lengths": [34, 17, 15, 16, 19, 15, 15, 19, 21, 15, 17, 15, 20, 18, 19, 18, 20, 21, 17, 18, 18, 15, 19, 21, 20, 17, 21, 19, 16, 15, 15, 15, 18, 15, 18, 15, 19, 22, 17, 19, 15, 19, 15, 17, 15, 20, 15, 16, 17, 20, 18, 15, 22, 18, 15, 15, 15, 16, 19, 18, 17, 20, 18, 16, 20, 17, 18, 17, 19, 20, 17, 19, 15, 21, 15, 19, 21, 15, 15, 19, 21, 18, 16, 15, 18, 16, 17, 17, 16, 16, 16, 20, 17, 17, 15, 19, 15, 17, 25, 18, 16, 21, 18, 18, 21, 15, 16, 22, 19, 19, 22, 15, 16, 17, 16, 17, 17, 21, 74, 18, 25, 22, 18, 17, 18, 16, 15, 18, 16, 19, 20, 17, 18, 16, 15, 32, 16, 15, 17, 15, 16, 17, 19, 19, 18, 17, 16, 18, 17, 17, 20, 16, 19, 15, 15, 18, 16, 20, 17, 16, 16, 17, 15, 16, 35, 23, 17, 20, 17, 20, 17, 18, 15, 17, 19, 27, 17, 24, 21, 18, 19, 19, 16, 21, 15, 15, 15, 21, 15, 19, 19, 18, 21, 18, 16, 15, 19, 18, 17, 18, 16, 16, 18, 23, 17, 17, 15, 19, 15, 18, 24, 22, 19, 15], "policy_red_0_reward": [1.47609375, 1.488046875, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.4866406250000002, 1.485234375, 1.489453125, 1.488046875, 1.489453125, 1.4858875, 1.48734375, 1.4866406250000002, 1.48734375, 1.4858875, 1.485234375, 1.488046875, 1.48734375, 1.48729375, 1.489453125, 1.4866406250000002, 1.485184375, 1.4858875, 1.488046875, 1.485234375, 1.486590625, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48729375, 1.489453125, 1.486590625, 1.4845312499999999, 1.488046875, 1.486490625, 1.489453125, 1.486540625, 1.489453125, 1.488046875, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.488046875, 1.4859375, 1.48734375, 1.489453125, 1.4845312499999999, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.48729375, 1.488046875, 1.4858875, 1.48734375, 1.48875, 1.4859375, 1.488046875, 1.48734375, 1.488046875, 1.4866406250000002, 1.4859375, 1.488046875, 1.4866406250000002, 1.489453125, 1.485234375, 1.489453125, 1.4866406250000002, 1.485184375, 1.489453125, 1.489453125, 1.4866406250000002, 1.485184375, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.48875, 1.4859375, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.4879968749999999, 1.482421875, 1.48729375, 1.48875, 1.485134375, 1.48734375, 1.48734375, 1.485234375, 1.489453125, 1.48875, 1.4845312499999999, 1.4866406250000002, 1.4866406250000002, 1.48448125, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.488046875, 1.4879968749999999, 1.485234375, 1.44786875, 1.48734375, 1.4823718750000001, 1.48443125, 1.48729375, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.4887000000000001, 1.486590625, 1.4858875, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.4774500000000002, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.4879968749999999, 1.48875, 1.48734375, 1.487946875, 1.488046875, 1.4859375, 1.48875, 1.486540625, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4859375, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4887000000000001, 1.475390625, 1.483678125, 1.4879968749999999, 1.4858875, 1.488046875, 1.4858875, 1.488046875, 1.48734375, 1.489453125, 1.4879968749999999, 1.4866406250000002, 1.481015625, 1.488046875, 1.483125, 1.485184375, 1.48724375, 1.4866406250000002, 1.4866406250000002, 1.48875, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.485184375, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.485134375, 1.48734375, 1.48875, 1.489453125, 1.486590625, 1.48734375, 1.488046875, 1.48729375, 1.48875, 1.48875, 1.48734375, 1.483728125, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.48734375, 1.483075, 1.4845312499999999, 1.486540625, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4883099980411408, "mean_inference_ms": 3.5467236880098882, "mean_action_processing_ms": 0.19944855240649334, "mean_env_wait_ms": 0.2370040910015393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09419361007547825, "StateBufferConnector_ms": 0.008068017870466286, "ViewRequirementAgentConnector_ms": 0.15119280770560292}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.44786875, "episode_reward_mean": 1.4871851635514022, "episode_len_mean": 18.205607476635514, "episodes_this_iter": 214, "policy_reward_min": {"red_0": 1.44786875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4871851635514022}, "hist_stats": {"episode_reward": [1.47609375, 1.488046875, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.4866406250000002, 1.485234375, 1.489453125, 1.488046875, 1.489453125, 1.4858875, 1.48734375, 1.4866406250000002, 1.48734375, 1.4858875, 1.485234375, 1.488046875, 1.48734375, 1.48729375, 1.489453125, 1.4866406250000002, 1.485184375, 1.4858875, 1.488046875, 1.485234375, 1.486590625, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48729375, 1.489453125, 1.486590625, 1.4845312499999999, 1.488046875, 1.486490625, 1.489453125, 1.486540625, 1.489453125, 1.488046875, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.488046875, 1.4859375, 1.48734375, 1.489453125, 1.4845312499999999, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.48729375, 1.488046875, 1.4858875, 1.48734375, 1.48875, 1.4859375, 1.488046875, 1.48734375, 1.488046875, 1.4866406250000002, 1.4859375, 1.488046875, 1.4866406250000002, 1.489453125, 1.485234375, 1.489453125, 1.4866406250000002, 1.485184375, 1.489453125, 1.489453125, 1.4866406250000002, 1.485184375, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.48875, 1.4859375, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.4879968749999999, 1.482421875, 1.48729375, 1.48875, 1.485134375, 1.48734375, 1.48734375, 1.485234375, 1.489453125, 1.48875, 1.4845312499999999, 1.4866406250000002, 1.4866406250000002, 1.48448125, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.488046875, 1.4879968749999999, 1.485234375, 1.44786875, 1.48734375, 1.4823718750000001, 1.48443125, 1.48729375, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.4887000000000001, 1.486590625, 1.4858875, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.4774500000000002, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.4879968749999999, 1.48875, 1.48734375, 1.487946875, 1.488046875, 1.4859375, 1.48875, 1.486540625, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4859375, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4887000000000001, 1.475390625, 1.483678125, 1.4879968749999999, 1.4858875, 1.488046875, 1.4858875, 1.488046875, 1.48734375, 1.489453125, 1.4879968749999999, 1.4866406250000002, 1.481015625, 1.488046875, 1.483125, 1.485184375, 1.48724375, 1.4866406250000002, 1.4866406250000002, 1.48875, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.485184375, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.485134375, 1.48734375, 1.48875, 1.489453125, 1.486590625, 1.48734375, 1.488046875, 1.48729375, 1.48875, 1.48875, 1.48734375, 1.483728125, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.48734375, 1.483075, 1.4845312499999999, 1.486540625, 1.489453125], "episode_lengths": [34, 17, 15, 16, 19, 15, 15, 19, 21, 15, 17, 15, 20, 18, 19, 18, 20, 21, 17, 18, 18, 15, 19, 21, 20, 17, 21, 19, 16, 15, 15, 15, 18, 15, 18, 15, 19, 22, 17, 19, 15, 19, 15, 17, 15, 20, 15, 16, 17, 20, 18, 15, 22, 18, 15, 15, 15, 16, 19, 18, 17, 20, 18, 16, 20, 17, 18, 17, 19, 20, 17, 19, 15, 21, 15, 19, 21, 15, 15, 19, 21, 18, 16, 15, 18, 16, 17, 17, 16, 16, 16, 20, 17, 17, 15, 19, 15, 17, 25, 18, 16, 21, 18, 18, 21, 15, 16, 22, 19, 19, 22, 15, 16, 17, 16, 17, 17, 21, 74, 18, 25, 22, 18, 17, 18, 16, 15, 18, 16, 19, 20, 17, 18, 16, 15, 32, 16, 15, 17, 15, 16, 17, 19, 19, 18, 17, 16, 18, 17, 17, 20, 16, 19, 15, 15, 18, 16, 20, 17, 16, 16, 17, 15, 16, 35, 23, 17, 20, 17, 20, 17, 18, 15, 17, 19, 27, 17, 24, 21, 18, 19, 19, 16, 21, 15, 15, 15, 21, 15, 19, 19, 18, 21, 18, 16, 15, 19, 18, 17, 18, 16, 16, 18, 23, 17, 17, 15, 19, 15, 18, 24, 22, 19, 15], "policy_red_0_reward": [1.47609375, 1.488046875, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.4866406250000002, 1.485234375, 1.489453125, 1.488046875, 1.489453125, 1.4858875, 1.48734375, 1.4866406250000002, 1.48734375, 1.4858875, 1.485234375, 1.488046875, 1.48734375, 1.48729375, 1.489453125, 1.4866406250000002, 1.485184375, 1.4858875, 1.488046875, 1.485234375, 1.486590625, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48729375, 1.489453125, 1.486590625, 1.4845312499999999, 1.488046875, 1.486490625, 1.489453125, 1.486540625, 1.489453125, 1.488046875, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.488046875, 1.4859375, 1.48734375, 1.489453125, 1.4845312499999999, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.48729375, 1.488046875, 1.4858875, 1.48734375, 1.48875, 1.4859375, 1.488046875, 1.48734375, 1.488046875, 1.4866406250000002, 1.4859375, 1.488046875, 1.4866406250000002, 1.489453125, 1.485234375, 1.489453125, 1.4866406250000002, 1.485184375, 1.489453125, 1.489453125, 1.4866406250000002, 1.485184375, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.48875, 1.4859375, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.4879968749999999, 1.482421875, 1.48729375, 1.48875, 1.485134375, 1.48734375, 1.48734375, 1.485234375, 1.489453125, 1.48875, 1.4845312499999999, 1.4866406250000002, 1.4866406250000002, 1.48448125, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.488046875, 1.4879968749999999, 1.485234375, 1.44786875, 1.48734375, 1.4823718750000001, 1.48443125, 1.48729375, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.4887000000000001, 1.486590625, 1.4858875, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.4774500000000002, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.4879968749999999, 1.48875, 1.48734375, 1.487946875, 1.488046875, 1.4859375, 1.48875, 1.486540625, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4859375, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4887000000000001, 1.475390625, 1.483678125, 1.4879968749999999, 1.4858875, 1.488046875, 1.4858875, 1.488046875, 1.48734375, 1.489453125, 1.4879968749999999, 1.4866406250000002, 1.481015625, 1.488046875, 1.483125, 1.485184375, 1.48724375, 1.4866406250000002, 1.4866406250000002, 1.48875, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.485184375, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.485134375, 1.48734375, 1.48875, 1.489453125, 1.486590625, 1.48734375, 1.488046875, 1.48729375, 1.48875, 1.48875, 1.48734375, 1.483728125, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.48734375, 1.483075, 1.4845312499999999, 1.486540625, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4883099980411408, "mean_inference_ms": 3.5467236880098882, "mean_action_processing_ms": 0.19944855240649334, "mean_env_wait_ms": 0.2370040910015393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09419361007547825, "StateBufferConnector_ms": 0.008068017870466286, "ViewRequirementAgentConnector_ms": 0.15119280770560292}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.40624668749797, "num_env_steps_trained_throughput_per_sec": 125.40624668749797, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 32527.215, "sample_time_ms": 18583.01, "learn_time_ms": 13872.158, "learn_throughput": 288.347, "synch_weights_time_ms": 71.215}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 1228, "training_iteration": 38, "trial_id": "3c06e_00000", "date": "2023-09-12_14-48-48", "timestamp": 1694544528, "time_this_iter_s": 31.921100854873657, "time_total_s": 1178.0492267608643, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b9240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1178.0492267608643, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.019565217391307, "ram_util_percent": 22.55652173913043}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7629735599427174, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011736134258899255, "policy_loss": -0.017863621919726333, "vf_loss": 0.0039392084727902935, "vf_explained_var": 0.9340092020109296, "kl": 0.00729426500908111, "entropy": 0.3929345186799765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.28280625, "episode_reward_mean": 1.4871150165929206, "episode_len_mean": 18.27433628318584, "episode_media": {}, "episodes_this_iter": 226, "policy_reward_min": {"red_0": 1.28280625}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4871150165929206}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.48734375, 1.48729375, 1.4866406250000002, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.489453125, 1.4845312499999999, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.485234375, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.486590625, 1.48734375, 1.489453125, 1.487946875, 1.48729375, 1.486590625, 1.4866406250000002, 1.488046875, 1.4879968749999999, 1.48875, 1.488046875, 1.4879968749999999, 1.48875, 1.486590625, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.48729375, 1.488046875, 1.48729375, 1.48734375, 1.4866406250000002, 1.4887000000000001, 1.48729375, 1.4866406250000002, 1.48875, 1.488046875, 1.4866406250000002, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4879968749999999, 1.48724375, 1.488046875, 1.489453125, 1.48734375, 1.4866406250000002, 1.48734375, 1.489453125, 1.4829750000000002, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.48729375, 1.48875, 1.487946875, 1.48875, 1.48875, 1.48734375, 1.48443125, 1.489453125, 1.4859375, 1.4879968749999999, 1.4858875, 1.48734375, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48734375, 1.4859375, 1.48875, 1.488046875, 1.4879968749999999, 1.4887000000000001, 1.482421875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.485184375, 1.48448125, 1.485184375, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.4866406250000002, 1.48875, 1.48875, 1.489453125, 1.48729375, 1.4858875, 1.489453125, 1.489453125, 1.486590625, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.4887000000000001, 1.48448125, 1.489453125, 1.48729375, 1.4879968749999999, 1.489453125, 1.487946875, 1.4879968749999999, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4858875, 1.489453125, 1.488046875, 1.4879968749999999, 1.28280625, 1.4887000000000001, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.4803125000000001, 1.48734375, 1.4859375, 1.489453125, 1.48734375, 1.48875, 1.4879968749999999, 1.48734375, 1.488046875, 1.4887000000000001, 1.4879968749999999, 1.488046875, 1.489453125, 1.4859375, 1.48875, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.486590625, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4858375000000001, 1.4858875, 1.488046875, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.4858375000000001, 1.488046875, 1.487946875, 1.488046875, 1.488046875, 1.485234375, 1.48875, 1.488046875, 1.48734375, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.4879968749999999, 1.48729375, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4859375, 1.483828125, 1.4879968749999999, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.48734375, 1.489453125], "episode_lengths": [18, 18, 19, 17, 15, 15, 19, 19, 15, 22, 16, 17, 15, 15, 21, 16, 15, 17, 15, 16, 17, 19, 18, 15, 17, 18, 19, 19, 17, 17, 16, 17, 17, 16, 19, 15, 15, 16, 16, 18, 17, 18, 18, 19, 16, 18, 19, 16, 17, 19, 16, 15, 17, 16, 15, 17, 18, 17, 15, 18, 19, 18, 15, 24, 18, 15, 15, 16, 15, 17, 18, 16, 17, 16, 16, 18, 22, 15, 20, 17, 20, 18, 19, 15, 15, 15, 17, 18, 20, 16, 17, 17, 16, 25, 20, 15, 15, 16, 16, 21, 22, 21, 16, 16, 17, 15, 17, 16, 15, 18, 15, 17, 19, 16, 16, 15, 18, 20, 15, 15, 19, 16, 15, 15, 16, 16, 22, 15, 18, 17, 15, 17, 17, 17, 16, 16, 17, 15, 20, 15, 17, 17, 302, 16, 16, 16, 16, 15, 16, 15, 17, 17, 28, 18, 20, 15, 18, 16, 17, 18, 17, 16, 17, 17, 15, 20, 16, 16, 16, 15, 15, 20, 15, 19, 17, 15, 15, 15, 16, 16, 15, 17, 17, 15, 18, 15, 15, 15, 16, 16, 20, 20, 17, 16, 17, 17, 17, 20, 17, 17, 17, 17, 21, 16, 17, 18, 17, 15, 18, 15, 17, 18, 16, 15, 15, 16, 15, 20, 23, 17, 15, 16, 18, 17, 18, 15], "policy_red_0_reward": [1.48734375, 1.48729375, 1.4866406250000002, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.489453125, 1.4845312499999999, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.485234375, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.486590625, 1.48734375, 1.489453125, 1.487946875, 1.48729375, 1.486590625, 1.4866406250000002, 1.488046875, 1.4879968749999999, 1.48875, 1.488046875, 1.4879968749999999, 1.48875, 1.486590625, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.48729375, 1.488046875, 1.48729375, 1.48734375, 1.4866406250000002, 1.4887000000000001, 1.48729375, 1.4866406250000002, 1.48875, 1.488046875, 1.4866406250000002, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4879968749999999, 1.48724375, 1.488046875, 1.489453125, 1.48734375, 1.4866406250000002, 1.48734375, 1.489453125, 1.4829750000000002, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.48729375, 1.48875, 1.487946875, 1.48875, 1.48875, 1.48734375, 1.48443125, 1.489453125, 1.4859375, 1.4879968749999999, 1.4858875, 1.48734375, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48734375, 1.4859375, 1.48875, 1.488046875, 1.4879968749999999, 1.4887000000000001, 1.482421875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.485184375, 1.48448125, 1.485184375, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.4866406250000002, 1.48875, 1.48875, 1.489453125, 1.48729375, 1.4858875, 1.489453125, 1.489453125, 1.486590625, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.4887000000000001, 1.48448125, 1.489453125, 1.48729375, 1.4879968749999999, 1.489453125, 1.487946875, 1.4879968749999999, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4858875, 1.489453125, 1.488046875, 1.4879968749999999, 1.28280625, 1.4887000000000001, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.4803125000000001, 1.48734375, 1.4859375, 1.489453125, 1.48734375, 1.48875, 1.4879968749999999, 1.48734375, 1.488046875, 1.4887000000000001, 1.4879968749999999, 1.488046875, 1.489453125, 1.4859375, 1.48875, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.486590625, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4858375000000001, 1.4858875, 1.488046875, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.4858375000000001, 1.488046875, 1.487946875, 1.488046875, 1.488046875, 1.485234375, 1.48875, 1.488046875, 1.48734375, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.4879968749999999, 1.48729375, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4859375, 1.483828125, 1.4879968749999999, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.48734375, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4910191476136823, "mean_inference_ms": 3.548481503967047, "mean_action_processing_ms": 0.1994913766132134, "mean_env_wait_ms": 0.23751587802829122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09501128070122372, "StateBufferConnector_ms": 0.008080385427559372, "ViewRequirementAgentConnector_ms": 0.15460010123463858}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.28280625, "episode_reward_mean": 1.4871150165929206, "episode_len_mean": 18.27433628318584, "episodes_this_iter": 226, "policy_reward_min": {"red_0": 1.28280625}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4871150165929206}, "hist_stats": {"episode_reward": [1.48734375, 1.48729375, 1.4866406250000002, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.489453125, 1.4845312499999999, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.485234375, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.486590625, 1.48734375, 1.489453125, 1.487946875, 1.48729375, 1.486590625, 1.4866406250000002, 1.488046875, 1.4879968749999999, 1.48875, 1.488046875, 1.4879968749999999, 1.48875, 1.486590625, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.48729375, 1.488046875, 1.48729375, 1.48734375, 1.4866406250000002, 1.4887000000000001, 1.48729375, 1.4866406250000002, 1.48875, 1.488046875, 1.4866406250000002, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4879968749999999, 1.48724375, 1.488046875, 1.489453125, 1.48734375, 1.4866406250000002, 1.48734375, 1.489453125, 1.4829750000000002, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.48729375, 1.48875, 1.487946875, 1.48875, 1.48875, 1.48734375, 1.48443125, 1.489453125, 1.4859375, 1.4879968749999999, 1.4858875, 1.48734375, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48734375, 1.4859375, 1.48875, 1.488046875, 1.4879968749999999, 1.4887000000000001, 1.482421875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.485184375, 1.48448125, 1.485184375, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.4866406250000002, 1.48875, 1.48875, 1.489453125, 1.48729375, 1.4858875, 1.489453125, 1.489453125, 1.486590625, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.4887000000000001, 1.48448125, 1.489453125, 1.48729375, 1.4879968749999999, 1.489453125, 1.487946875, 1.4879968749999999, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4858875, 1.489453125, 1.488046875, 1.4879968749999999, 1.28280625, 1.4887000000000001, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.4803125000000001, 1.48734375, 1.4859375, 1.489453125, 1.48734375, 1.48875, 1.4879968749999999, 1.48734375, 1.488046875, 1.4887000000000001, 1.4879968749999999, 1.488046875, 1.489453125, 1.4859375, 1.48875, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.486590625, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4858375000000001, 1.4858875, 1.488046875, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.4858375000000001, 1.488046875, 1.487946875, 1.488046875, 1.488046875, 1.485234375, 1.48875, 1.488046875, 1.48734375, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.4879968749999999, 1.48729375, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4859375, 1.483828125, 1.4879968749999999, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.48734375, 1.489453125], "episode_lengths": [18, 18, 19, 17, 15, 15, 19, 19, 15, 22, 16, 17, 15, 15, 21, 16, 15, 17, 15, 16, 17, 19, 18, 15, 17, 18, 19, 19, 17, 17, 16, 17, 17, 16, 19, 15, 15, 16, 16, 18, 17, 18, 18, 19, 16, 18, 19, 16, 17, 19, 16, 15, 17, 16, 15, 17, 18, 17, 15, 18, 19, 18, 15, 24, 18, 15, 15, 16, 15, 17, 18, 16, 17, 16, 16, 18, 22, 15, 20, 17, 20, 18, 19, 15, 15, 15, 17, 18, 20, 16, 17, 17, 16, 25, 20, 15, 15, 16, 16, 21, 22, 21, 16, 16, 17, 15, 17, 16, 15, 18, 15, 17, 19, 16, 16, 15, 18, 20, 15, 15, 19, 16, 15, 15, 16, 16, 22, 15, 18, 17, 15, 17, 17, 17, 16, 16, 17, 15, 20, 15, 17, 17, 302, 16, 16, 16, 16, 15, 16, 15, 17, 17, 28, 18, 20, 15, 18, 16, 17, 18, 17, 16, 17, 17, 15, 20, 16, 16, 16, 15, 15, 20, 15, 19, 17, 15, 15, 15, 16, 16, 15, 17, 17, 15, 18, 15, 15, 15, 16, 16, 20, 20, 17, 16, 17, 17, 17, 20, 17, 17, 17, 17, 21, 16, 17, 18, 17, 15, 18, 15, 17, 18, 16, 15, 15, 16, 15, 20, 23, 17, 15, 16, 18, 17, 18, 15], "policy_red_0_reward": [1.48734375, 1.48729375, 1.4866406250000002, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.489453125, 1.4845312499999999, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.485234375, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.486590625, 1.48734375, 1.489453125, 1.487946875, 1.48729375, 1.486590625, 1.4866406250000002, 1.488046875, 1.4879968749999999, 1.48875, 1.488046875, 1.4879968749999999, 1.48875, 1.486590625, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.48729375, 1.488046875, 1.48729375, 1.48734375, 1.4866406250000002, 1.4887000000000001, 1.48729375, 1.4866406250000002, 1.48875, 1.488046875, 1.4866406250000002, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4879968749999999, 1.48724375, 1.488046875, 1.489453125, 1.48734375, 1.4866406250000002, 1.48734375, 1.489453125, 1.4829750000000002, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.48729375, 1.48875, 1.487946875, 1.48875, 1.48875, 1.48734375, 1.48443125, 1.489453125, 1.4859375, 1.4879968749999999, 1.4858875, 1.48734375, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48734375, 1.4859375, 1.48875, 1.488046875, 1.4879968749999999, 1.4887000000000001, 1.482421875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.485184375, 1.48448125, 1.485184375, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.4866406250000002, 1.48875, 1.48875, 1.489453125, 1.48729375, 1.4858875, 1.489453125, 1.489453125, 1.486590625, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.4887000000000001, 1.48448125, 1.489453125, 1.48729375, 1.4879968749999999, 1.489453125, 1.487946875, 1.4879968749999999, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4858875, 1.489453125, 1.488046875, 1.4879968749999999, 1.28280625, 1.4887000000000001, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.4803125000000001, 1.48734375, 1.4859375, 1.489453125, 1.48734375, 1.48875, 1.4879968749999999, 1.48734375, 1.488046875, 1.4887000000000001, 1.4879968749999999, 1.488046875, 1.489453125, 1.4859375, 1.48875, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.486590625, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4858375000000001, 1.4858875, 1.488046875, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.4858375000000001, 1.488046875, 1.487946875, 1.488046875, 1.488046875, 1.485234375, 1.48875, 1.488046875, 1.48734375, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.4879968749999999, 1.48729375, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4859375, 1.483828125, 1.4879968749999999, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.48734375, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4910191476136823, "mean_inference_ms": 3.548481503967047, "mean_action_processing_ms": 0.1994913766132134, "mean_env_wait_ms": 0.23751587802829122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09501128070122372, "StateBufferConnector_ms": 0.008080385427559372, "ViewRequirementAgentConnector_ms": 0.15460010123463858}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 124.12500287058955, "num_env_steps_trained_throughput_per_sec": 124.12500287058955, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 32614.096, "sample_time_ms": 18614.852, "learn_time_ms": 13926.957, "learn_throughput": 287.213, "synch_weights_time_ms": 71.45}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 1454, "training_iteration": 39, "trial_id": "3c06e_00000", "date": "2023-09-12_14-49-21", "timestamp": 1694544561, "time_this_iter_s": 32.2496075630188, "time_total_s": 1210.298834323883, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147ba9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1210.298834323883, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.81739130434782, "ram_util_percent": 22.754347826086956}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0675100967443238, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016243502468569204, "policy_loss": -0.01978289259580682, "vf_loss": 0.0006708393672549088, "vf_explained_var": 0.9845768353591363, "kl": 0.009561834422743816, "entropy": 0.26934144358771545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4788062499999999, "episode_reward_mean": 1.4883524018595042, "episode_len_mean": 16.553719008264462, "episode_media": {}, "episodes_this_iter": 242, "policy_reward_min": {"red_0": 1.4788062499999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4883524018595042}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4887000000000001, 1.48734375, 1.489453125, 1.4858375000000001, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4887000000000001, 1.48875, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48729375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.48875, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.4859375, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48729375, 1.4887000000000001, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.482421875, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.4866406250000002, 1.489453125, 1.48448125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.4859375, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.4879968749999999, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.488046875, 1.48875, 1.4845312499999999, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.4866406250000002, 1.48724375, 1.488046875, 1.48734375, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.4879968749999999, 1.48875, 1.4887000000000001, 1.48729375, 1.485234375, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.4887000000000001, 1.489453125, 1.4859375, 1.486590625, 1.489453125, 1.4879968749999999, 1.489453125, 1.48875, 1.482421875, 1.48875, 1.48734375, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.4845312499999999, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.488046875, 1.485134375, 1.483828125, 1.48724375, 1.489453125, 1.489453125, 1.486540625, 1.489453125, 1.4859375, 1.486590625, 1.4879968749999999, 1.4858875, 1.489453125, 1.489453125, 1.48729375, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.486590625, 1.48729375, 1.489453125, 1.48734375, 1.4887000000000001, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4887000000000001, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.4788062499999999, 1.48729375, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 16, 16, 18, 15, 20, 19, 15, 17, 15, 15, 17, 17, 16, 16, 19, 16, 15, 15, 15, 18, 15, 15, 15, 15, 15, 17, 16, 17, 17, 18, 15, 15, 17, 20, 16, 16, 15, 15, 18, 18, 16, 18, 16, 16, 15, 15, 18, 16, 15, 16, 15, 16, 19, 15, 15, 15, 25, 15, 17, 16, 17, 15, 17, 19, 15, 22, 18, 15, 15, 16, 15, 15, 17, 15, 17, 15, 15, 17, 17, 16, 16, 17, 15, 15, 16, 15, 17, 18, 16, 15, 15, 15, 15, 19, 17, 20, 15, 19, 15, 15, 17, 17, 15, 15, 16, 19, 17, 16, 22, 16, 16, 17, 15, 16, 19, 18, 17, 18, 19, 15, 15, 17, 15, 17, 17, 16, 16, 18, 21, 19, 15, 16, 15, 16, 16, 15, 15, 15, 17, 17, 15, 15, 17, 15, 17, 16, 18, 17, 15, 16, 15, 17, 16, 15, 20, 19, 15, 17, 15, 16, 25, 16, 18, 23, 15, 15, 15, 15, 16, 16, 16, 15, 16, 22, 16, 17, 17, 17, 17, 21, 23, 18, 15, 15, 19, 15, 20, 19, 17, 20, 15, 15, 18, 17, 15, 17, 16, 19, 18, 15, 18, 16, 16, 18, 16, 17, 15, 15, 17, 16, 15, 16, 17, 18, 15, 15, 15, 16, 15, 15, 15, 15, 17, 30, 18, 15, 16, 16, 15, 20, 15, 16, 15, 15, 16, 15, 16, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4887000000000001, 1.48734375, 1.489453125, 1.4858375000000001, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4887000000000001, 1.48875, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48729375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.48875, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.4859375, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48729375, 1.4887000000000001, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.482421875, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.4866406250000002, 1.489453125, 1.48448125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.4859375, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.4879968749999999, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.488046875, 1.48875, 1.4845312499999999, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.4866406250000002, 1.48724375, 1.488046875, 1.48734375, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.4879968749999999, 1.48875, 1.4887000000000001, 1.48729375, 1.485234375, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.4887000000000001, 1.489453125, 1.4859375, 1.486590625, 1.489453125, 1.4879968749999999, 1.489453125, 1.48875, 1.482421875, 1.48875, 1.48734375, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.4845312499999999, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.488046875, 1.485134375, 1.483828125, 1.48724375, 1.489453125, 1.489453125, 1.486540625, 1.489453125, 1.4859375, 1.486590625, 1.4879968749999999, 1.4858875, 1.489453125, 1.489453125, 1.48729375, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.486590625, 1.48729375, 1.489453125, 1.48734375, 1.4887000000000001, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4887000000000001, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.4788062499999999, 1.48729375, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49323719731334004, "mean_inference_ms": 3.5458666571325606, "mean_action_processing_ms": 0.1993942929750197, "mean_env_wait_ms": 0.23763124073127007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08945750796105251, "StateBufferConnector_ms": 0.007753332784353209, "ViewRequirementAgentConnector_ms": 0.14811606446573558}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4788062499999999, "episode_reward_mean": 1.4883524018595042, "episode_len_mean": 16.553719008264462, "episodes_this_iter": 242, "policy_reward_min": {"red_0": 1.4788062499999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4883524018595042}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4887000000000001, 1.48734375, 1.489453125, 1.4858375000000001, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4887000000000001, 1.48875, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48729375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.48875, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.4859375, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48729375, 1.4887000000000001, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.482421875, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.4866406250000002, 1.489453125, 1.48448125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.4859375, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.4879968749999999, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.488046875, 1.48875, 1.4845312499999999, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.4866406250000002, 1.48724375, 1.488046875, 1.48734375, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.4879968749999999, 1.48875, 1.4887000000000001, 1.48729375, 1.485234375, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.4887000000000001, 1.489453125, 1.4859375, 1.486590625, 1.489453125, 1.4879968749999999, 1.489453125, 1.48875, 1.482421875, 1.48875, 1.48734375, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.4845312499999999, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.488046875, 1.485134375, 1.483828125, 1.48724375, 1.489453125, 1.489453125, 1.486540625, 1.489453125, 1.4859375, 1.486590625, 1.4879968749999999, 1.4858875, 1.489453125, 1.489453125, 1.48729375, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.486590625, 1.48729375, 1.489453125, 1.48734375, 1.4887000000000001, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4887000000000001, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.4788062499999999, 1.48729375, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 16, 16, 18, 15, 20, 19, 15, 17, 15, 15, 17, 17, 16, 16, 19, 16, 15, 15, 15, 18, 15, 15, 15, 15, 15, 17, 16, 17, 17, 18, 15, 15, 17, 20, 16, 16, 15, 15, 18, 18, 16, 18, 16, 16, 15, 15, 18, 16, 15, 16, 15, 16, 19, 15, 15, 15, 25, 15, 17, 16, 17, 15, 17, 19, 15, 22, 18, 15, 15, 16, 15, 15, 17, 15, 17, 15, 15, 17, 17, 16, 16, 17, 15, 15, 16, 15, 17, 18, 16, 15, 15, 15, 15, 19, 17, 20, 15, 19, 15, 15, 17, 17, 15, 15, 16, 19, 17, 16, 22, 16, 16, 17, 15, 16, 19, 18, 17, 18, 19, 15, 15, 17, 15, 17, 17, 16, 16, 18, 21, 19, 15, 16, 15, 16, 16, 15, 15, 15, 17, 17, 15, 15, 17, 15, 17, 16, 18, 17, 15, 16, 15, 17, 16, 15, 20, 19, 15, 17, 15, 16, 25, 16, 18, 23, 15, 15, 15, 15, 16, 16, 16, 15, 16, 22, 16, 17, 17, 17, 17, 21, 23, 18, 15, 15, 19, 15, 20, 19, 17, 20, 15, 15, 18, 17, 15, 17, 16, 19, 18, 15, 18, 16, 16, 18, 16, 17, 15, 15, 17, 16, 15, 16, 17, 18, 15, 15, 15, 16, 15, 15, 15, 15, 17, 30, 18, 15, 16, 16, 15, 20, 15, 16, 15, 15, 16, 15, 16, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4887000000000001, 1.48734375, 1.489453125, 1.4858375000000001, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4887000000000001, 1.48875, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48729375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.48875, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.4859375, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48729375, 1.4887000000000001, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.482421875, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.4866406250000002, 1.489453125, 1.48448125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.4859375, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.4879968749999999, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.488046875, 1.48875, 1.4845312499999999, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.4866406250000002, 1.48724375, 1.488046875, 1.48734375, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.4879968749999999, 1.48875, 1.4887000000000001, 1.48729375, 1.485234375, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.4887000000000001, 1.489453125, 1.4859375, 1.486590625, 1.489453125, 1.4879968749999999, 1.489453125, 1.48875, 1.482421875, 1.48875, 1.48734375, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.4845312499999999, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.488046875, 1.485134375, 1.483828125, 1.48724375, 1.489453125, 1.489453125, 1.486540625, 1.489453125, 1.4859375, 1.486590625, 1.4879968749999999, 1.4858875, 1.489453125, 1.489453125, 1.48729375, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.486590625, 1.48729375, 1.489453125, 1.48734375, 1.4887000000000001, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4887000000000001, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.4788062499999999, 1.48729375, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49323719731334004, "mean_inference_ms": 3.5458666571325606, "mean_action_processing_ms": 0.1993942929750197, "mean_env_wait_ms": 0.23763124073127007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08945750796105251, "StateBufferConnector_ms": 0.007753332784353209, "ViewRequirementAgentConnector_ms": 0.14811606446573558}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.97575602962738, "num_env_steps_trained_throughput_per_sec": 128.97575602962738, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 32730.917, "sample_time_ms": 18680.003, "learn_time_ms": 13978.404, "learn_throughput": 286.156, "synch_weights_time_ms": 71.671}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 1696, "training_iteration": 40, "trial_id": "3c06e_00000", "date": "2023-09-12_14-49-52", "timestamp": 1694544592, "time_this_iter_s": 31.039124727249146, "time_total_s": 1241.3379590511322, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a5ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1241.3379590511322, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.92666666666667, "ram_util_percent": 22.65333333333334}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8784902435261757, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01535236649979197, "policy_loss": -0.017399752004712353, "vf_loss": 0.00019510365496747302, "vf_explained_var": 0.9956582383563121, "kl": 0.0061742745583179695, "entropy": 0.20038593787079056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.485184375, "episode_reward_mean": 1.4888281498015874, "episode_len_mean": 15.880952380952381, "episode_media": {}, "episodes_this_iter": 252, "policy_reward_min": {"red_0": 1.485184375}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4888281498015874}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4887000000000001, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.48729375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4887000000000001, 1.487946875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.488046875, 1.489453125, 1.4887000000000001, 1.48734375, 1.48729375, 1.485234375, 1.489453125, 1.488046875, 1.488046875, 1.48729375, 1.4887000000000001, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4879968749999999, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4879968749999999, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4859375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.4887000000000001, 1.48734375, 1.488046875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.4879968749999999, 1.489453125, 1.48729375, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.485184375, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48729375, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.4879968749999999, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002], "episode_lengths": [16, 15, 17, 15, 18, 15, 15, 15, 15, 16, 15, 18, 16, 15, 15, 15, 17, 15, 16, 17, 15, 15, 15, 15, 15, 16, 15, 16, 15, 16, 15, 16, 15, 17, 15, 16, 18, 18, 21, 15, 17, 17, 18, 16, 15, 15, 18, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 17, 16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 16, 16, 15, 15, 17, 16, 17, 16, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 17, 16, 15, 16, 15, 15, 15, 15, 15, 17, 17, 20, 15, 15, 15, 16, 16, 18, 16, 18, 17, 16, 18, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 16, 17, 15, 15, 15, 17, 15, 18, 15, 17, 15, 16, 17, 17, 15, 18, 17, 15, 19, 15, 17, 15, 15, 19, 17, 15, 16, 15, 15, 21, 16, 15, 15, 15, 15, 16, 18, 16, 17, 15, 15, 19, 15, 18, 15, 16, 16, 15, 15, 18, 15, 17, 15, 17, 16, 17, 15, 15, 15, 15, 18, 17, 16, 15, 17, 16, 17, 17, 15, 16, 15, 16, 18, 15, 15, 15, 16, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 19, 15, 15, 18, 15, 15, 16, 15, 15, 15, 18, 17, 15, 16, 16, 15, 17, 16, 15, 17, 15, 15, 17, 15, 17, 18, 16, 16, 15, 15, 15, 15, 15, 15, 16, 19, 16, 15, 15, 16, 19], "policy_red_0_reward": [1.4887000000000001, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.48729375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4887000000000001, 1.487946875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.488046875, 1.489453125, 1.4887000000000001, 1.48734375, 1.48729375, 1.485234375, 1.489453125, 1.488046875, 1.488046875, 1.48729375, 1.4887000000000001, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4879968749999999, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4879968749999999, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4859375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.4887000000000001, 1.48734375, 1.488046875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.4879968749999999, 1.489453125, 1.48729375, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.485184375, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48729375, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.4879968749999999, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49590391259364525, "mean_inference_ms": 3.545788684595391, "mean_action_processing_ms": 0.19939283794291607, "mean_env_wait_ms": 0.23801727318725363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09077503567650205, "StateBufferConnector_ms": 0.007894587895226858, "ViewRequirementAgentConnector_ms": 0.15214587014818948}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.485184375, "episode_reward_mean": 1.4888281498015874, "episode_len_mean": 15.880952380952381, "episodes_this_iter": 252, "policy_reward_min": {"red_0": 1.485184375}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4888281498015874}, "hist_stats": {"episode_reward": [1.4887000000000001, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.48729375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4887000000000001, 1.487946875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.488046875, 1.489453125, 1.4887000000000001, 1.48734375, 1.48729375, 1.485234375, 1.489453125, 1.488046875, 1.488046875, 1.48729375, 1.4887000000000001, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4879968749999999, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4879968749999999, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4859375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.4887000000000001, 1.48734375, 1.488046875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.4879968749999999, 1.489453125, 1.48729375, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.485184375, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48729375, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.4879968749999999, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002], "episode_lengths": [16, 15, 17, 15, 18, 15, 15, 15, 15, 16, 15, 18, 16, 15, 15, 15, 17, 15, 16, 17, 15, 15, 15, 15, 15, 16, 15, 16, 15, 16, 15, 16, 15, 17, 15, 16, 18, 18, 21, 15, 17, 17, 18, 16, 15, 15, 18, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 17, 16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 16, 16, 15, 15, 17, 16, 17, 16, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 17, 16, 15, 16, 15, 15, 15, 15, 15, 17, 17, 20, 15, 15, 15, 16, 16, 18, 16, 18, 17, 16, 18, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 16, 17, 15, 15, 15, 17, 15, 18, 15, 17, 15, 16, 17, 17, 15, 18, 17, 15, 19, 15, 17, 15, 15, 19, 17, 15, 16, 15, 15, 21, 16, 15, 15, 15, 15, 16, 18, 16, 17, 15, 15, 19, 15, 18, 15, 16, 16, 15, 15, 18, 15, 17, 15, 17, 16, 17, 15, 15, 15, 15, 18, 17, 16, 15, 17, 16, 17, 17, 15, 16, 15, 16, 18, 15, 15, 15, 16, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 19, 15, 15, 18, 15, 15, 16, 15, 15, 15, 18, 17, 15, 16, 16, 15, 17, 16, 15, 17, 15, 15, 17, 15, 17, 18, 16, 16, 15, 15, 15, 15, 15, 15, 16, 19, 16, 15, 15, 16, 19], "policy_red_0_reward": [1.4887000000000001, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.48729375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4887000000000001, 1.487946875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.488046875, 1.489453125, 1.4887000000000001, 1.48734375, 1.48729375, 1.485234375, 1.489453125, 1.488046875, 1.488046875, 1.48729375, 1.4887000000000001, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4879968749999999, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4879968749999999, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4859375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.4887000000000001, 1.48734375, 1.488046875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.4879968749999999, 1.489453125, 1.48729375, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.485184375, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48729375, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.4879968749999999, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49590391259364525, "mean_inference_ms": 3.545788684595391, "mean_action_processing_ms": 0.19939283794291607, "mean_env_wait_ms": 0.23801727318725363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09077503567650205, "StateBufferConnector_ms": 0.007894587895226858, "ViewRequirementAgentConnector_ms": 0.15214587014818948}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.5625300309269, "num_env_steps_trained_throughput_per_sec": 125.5625300309269, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 32697.421, "sample_time_ms": 18657.68, "learn_time_ms": 13967.244, "learn_throughput": 286.384, "synch_weights_time_ms": 71.666}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 1948, "training_iteration": 41, "trial_id": "3c06e_00000", "date": "2023-09-12_14-50-24", "timestamp": 1694544624, "time_this_iter_s": 31.882309913635254, "time_total_s": 1273.2202689647675, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147bb760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1273.2202689647675, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.247826086956525, "ram_util_percent": 22.756521739130427}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5239451285762091, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014448803314068451, "policy_loss": -0.018590354934713105, "vf_loss": 0.002705000001803152, "vf_explained_var": 0.9422800403709213, "kl": 0.0047885040383833545, "entropy": 0.19205235081414382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4308468749999999, "episode_reward_mean": 1.488654016064257, "episode_len_mean": 16.1285140562249, "episode_media": {}, "episodes_this_iter": 249, "policy_reward_min": {"red_0": 1.4308468749999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.488654016064257}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4866406250000002, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4887000000000001, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.483828125, 1.489453125, 1.4879968749999999, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4879968749999999, 1.489453125, 1.47046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.4866406250000002, 1.48734375, 1.4866406250000002, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4308468749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4887000000000001, 1.4859375, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.4879968749999999, 1.48875, 1.489453125, 1.489453125], "episode_lengths": [19, 17, 15, 15, 15, 15, 15, 15, 16, 16, 17, 15, 15, 16, 16, 15, 15, 16, 16, 17, 15, 17, 16, 15, 18, 15, 15, 15, 16, 15, 17, 15, 16, 16, 16, 15, 15, 15, 15, 16, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 16, 16, 15, 17, 16, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 15, 16, 16, 17, 15, 15, 15, 15, 16, 17, 15, 15, 19, 15, 15, 15, 15, 15, 15, 23, 15, 17, 15, 18, 16, 16, 16, 15, 16, 16, 15, 15, 15, 17, 16, 15, 17, 16, 16, 16, 17, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 16, 15, 15, 15, 17, 17, 15, 17, 15, 16, 15, 15, 15, 18, 17, 15, 16, 15, 15, 15, 15, 15, 19, 15, 19, 15, 15, 16, 15, 15, 15, 15, 15, 15, 17, 15, 17, 15, 42, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 17, 15, 15, 15, 15, 16, 17, 15, 16, 15, 19, 15, 17, 15, 15, 15, 15, 15, 15, 15, 16, 15, 18, 19, 18, 19, 17, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 97, 15, 15, 15, 15, 17, 16, 15, 15, 19, 15, 15, 15, 17, 15, 15, 15, 15, 18, 15, 16, 16, 20, 15, 16, 16, 17, 15, 15, 16, 17, 16, 15, 15], "policy_red_0_reward": [1.4866406250000002, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4887000000000001, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.483828125, 1.489453125, 1.4879968749999999, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4879968749999999, 1.489453125, 1.47046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.4866406250000002, 1.48734375, 1.4866406250000002, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4308468749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4887000000000001, 1.4859375, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.4879968749999999, 1.48875, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49824985713987285, "mean_inference_ms": 3.5454188568206613, "mean_action_processing_ms": 0.19937027036100188, "mean_env_wait_ms": 0.23835057406741073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09274971054260989, "StateBufferConnector_ms": 0.007823480659699344, "ViewRequirementAgentConnector_ms": 0.15045016644948936}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4308468749999999, "episode_reward_mean": 1.488654016064257, "episode_len_mean": 16.1285140562249, "episodes_this_iter": 249, "policy_reward_min": {"red_0": 1.4308468749999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.488654016064257}, "hist_stats": {"episode_reward": [1.4866406250000002, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4887000000000001, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.483828125, 1.489453125, 1.4879968749999999, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4879968749999999, 1.489453125, 1.47046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.4866406250000002, 1.48734375, 1.4866406250000002, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4308468749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4887000000000001, 1.4859375, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.4879968749999999, 1.48875, 1.489453125, 1.489453125], "episode_lengths": [19, 17, 15, 15, 15, 15, 15, 15, 16, 16, 17, 15, 15, 16, 16, 15, 15, 16, 16, 17, 15, 17, 16, 15, 18, 15, 15, 15, 16, 15, 17, 15, 16, 16, 16, 15, 15, 15, 15, 16, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 16, 16, 15, 17, 16, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 15, 16, 16, 17, 15, 15, 15, 15, 16, 17, 15, 15, 19, 15, 15, 15, 15, 15, 15, 23, 15, 17, 15, 18, 16, 16, 16, 15, 16, 16, 15, 15, 15, 17, 16, 15, 17, 16, 16, 16, 17, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 16, 15, 15, 15, 17, 17, 15, 17, 15, 16, 15, 15, 15, 18, 17, 15, 16, 15, 15, 15, 15, 15, 19, 15, 19, 15, 15, 16, 15, 15, 15, 15, 15, 15, 17, 15, 17, 15, 42, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 17, 15, 15, 15, 15, 16, 17, 15, 16, 15, 19, 15, 17, 15, 15, 15, 15, 15, 15, 15, 16, 15, 18, 19, 18, 19, 17, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 97, 15, 15, 15, 15, 17, 16, 15, 15, 19, 15, 15, 15, 17, 15, 15, 15, 15, 18, 15, 16, 16, 20, 15, 16, 16, 17, 15, 15, 16, 17, 16, 15, 15], "policy_red_0_reward": [1.4866406250000002, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4887000000000001, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.483828125, 1.489453125, 1.4879968749999999, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4879968749999999, 1.489453125, 1.47046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.4866406250000002, 1.48734375, 1.4866406250000002, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4308468749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.486590625, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4887000000000001, 1.4859375, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.4879968749999999, 1.48875, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49824985713987285, "mean_inference_ms": 3.5454188568206613, "mean_action_processing_ms": 0.19937027036100188, "mean_env_wait_ms": 0.23835057406741073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09274971054260989, "StateBufferConnector_ms": 0.007823480659699344, "ViewRequirementAgentConnector_ms": 0.15045016644948936}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.26137333275045, "num_env_steps_trained_throughput_per_sec": 129.26137333275045, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 32628.95, "sample_time_ms": 18654.713, "learn_time_ms": 13902.79, "learn_throughput": 287.712, "synch_weights_time_ms": 70.631}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2197, "training_iteration": 42, "trial_id": "3c06e_00000", "date": "2023-09-12_14-50-56", "timestamp": 1694544656, "time_this_iter_s": 30.97106671333313, "time_total_s": 1304.1913356781006, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a6cb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1304.1913356781006, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 29.16136363636364, "ram_util_percent": 22.845454545454547}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7839690536881486, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015389051030191088, "policy_loss": -0.01677414476919997, "vf_loss": 0.00038293380453827315, "vf_explained_var": 0.9913383776942889, "kl": 0.006681073848025493, "entropy": 0.13766252738423645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4732812499999999, "episode_reward_mean": 1.489132064688716, "episode_len_mean": 15.45136186770428, "episode_media": {}, "episodes_this_iter": 257, "policy_reward_min": {"red_0": 1.4732812499999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.489132064688716}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.488046875, 1.48875, 1.489453125, 1.4887000000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.487946875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.486590625, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4879968749999999, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4732812499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 17, 15, 15, 15, 17, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 17, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 17, 16, 15, 16, 16, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 17, 16, 17, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 16, 15, 15, 16, 17, 17, 17, 17, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 19, 15, 17, 15, 15, 15, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 16, 15, 15, 16, 15, 17, 17, 15, 15, 16, 15, 16, 16, 15, 16, 15, 15, 16, 17, 17, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 18, 15, 15, 38, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 15, 15], "policy_red_0_reward": [1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.488046875, 1.48875, 1.489453125, 1.4887000000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.487946875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.486590625, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4879968749999999, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4732812499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5012109455039956, "mean_inference_ms": 3.5479079483884384, "mean_action_processing_ms": 0.19954918422032195, "mean_env_wait_ms": 0.2389701308768307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09644903561484489, "StateBufferConnector_ms": 0.008223492811626034, "ViewRequirementAgentConnector_ms": 0.15822746410444088}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4732812499999999, "episode_reward_mean": 1.489132064688716, "episode_len_mean": 15.45136186770428, "episodes_this_iter": 257, "policy_reward_min": {"red_0": 1.4732812499999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.489132064688716}, "hist_stats": {"episode_reward": [1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.488046875, 1.48875, 1.489453125, 1.4887000000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.487946875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.486590625, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4879968749999999, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4732812499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 17, 15, 15, 15, 17, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 17, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 17, 16, 15, 16, 16, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 17, 16, 17, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 16, 15, 15, 16, 17, 17, 17, 17, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 19, 15, 17, 15, 15, 15, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 16, 15, 15, 16, 15, 17, 17, 15, 15, 16, 15, 16, 16, 15, 16, 15, 15, 16, 17, 17, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 18, 15, 15, 38, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 15, 15], "policy_red_0_reward": [1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.488046875, 1.48875, 1.489453125, 1.4887000000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.4879968749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.487946875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.486590625, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4879968749999999, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4732812499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5012109455039956, "mean_inference_ms": 3.5479079483884384, "mean_action_processing_ms": 0.19954918422032195, "mean_env_wait_ms": 0.2389701308768307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09644903561484489, "StateBufferConnector_ms": 0.008223492811626034, "ViewRequirementAgentConnector_ms": 0.15822746410444088}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 113.3119168440504, "num_env_steps_trained_throughput_per_sec": 113.3119168440504, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 32951.958, "sample_time_ms": 18666.362, "learn_time_ms": 14213.502, "learn_throughput": 281.423, "synch_weights_time_ms": 71.262}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2454, "training_iteration": 43, "trial_id": "3c06e_00000", "date": "2023-09-12_14-51-31", "timestamp": 1694544691, "time_this_iter_s": 35.34742546081543, "time_total_s": 1339.538761138916, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a7010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1339.538761138916, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 34.219607843137254, "ram_util_percent": 23.476470588235294}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0380237407128636, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006248901154140185, "policy_loss": -0.006933347002632218, "vf_loss": 0.00032503940042450573, "vf_explained_var": 0.9928189665079117, "kl": 0.002396041010510282, "entropy": 0.11718770599303147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4732812499999999, "episode_reward_mean": 1.4891135859073361, "episode_len_mean": 15.482625482625483, "episode_media": {}, "episodes_this_iter": 259, "policy_reward_min": {"red_0": 1.4732812499999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4891135859073361}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4732812499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125], "episode_lengths": [18, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 16, 17, 15, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 15, 17, 15, 16, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 15, 16, 15, 38, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 17, 15, 17, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 18, 16, 15, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 16, 15, 17, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 17, 15, 15, 23, 15, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 19, 15, 16, 15, 15, 16, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 17, 17, 15, 16, 15, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 18, 16, 15, 15], "policy_red_0_reward": [1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4732812499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5063224659641419, "mean_inference_ms": 3.5626704978788015, "mean_action_processing_ms": 0.2004650489818357, "mean_env_wait_ms": 0.24073147528146369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11556065680897834, "StateBufferConnector_ms": 0.009449568494406447, "ViewRequirementAgentConnector_ms": 0.18538406917027064}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4732812499999999, "episode_reward_mean": 1.4891135859073361, "episode_len_mean": 15.482625482625483, "episodes_this_iter": 259, "policy_reward_min": {"red_0": 1.4732812499999999}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4891135859073361}, "hist_stats": {"episode_reward": [1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4732812499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125], "episode_lengths": [18, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 16, 17, 15, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 15, 17, 15, 16, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 15, 16, 15, 38, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 17, 15, 17, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 18, 16, 15, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 16, 15, 17, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 17, 15, 15, 23, 15, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 19, 15, 16, 15, 15, 16, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 17, 17, 15, 16, 15, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 18, 16, 15, 15], "policy_red_0_reward": [1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4732812499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5063224659641419, "mean_inference_ms": 3.5626704978788015, "mean_action_processing_ms": 0.2004650489818357, "mean_env_wait_ms": 0.24073147528146369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11556065680897834, "StateBufferConnector_ms": 0.009449568494406447, "ViewRequirementAgentConnector_ms": 0.18538406917027064}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.43121247106544, "num_env_steps_trained_throughput_per_sec": 103.43121247106544, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 33651.127, "sample_time_ms": 18993.535, "learn_time_ms": 14583.987, "learn_throughput": 274.273, "synch_weights_time_ms": 72.765}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 2713, "training_iteration": 44, "trial_id": "3c06e_00000", "date": "2023-09-12_14-52-10", "timestamp": 1694544730, "time_this_iter_s": 38.7029390335083, "time_total_s": 1378.2417001724243, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147bb910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1378.2417001724243, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 39.43035714285714, "ram_util_percent": 25.787499999999998}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8420305176250016, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008929870439048197, "policy_loss": -0.009488116117427125, "vf_loss": 8.241065927450109e-05, "vf_explained_var": 0.998281684021155, "kl": 0.00634446733056014, "entropy": 0.09912242253388588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.482421875, "episode_reward_mean": 1.48927648526616, "episode_len_mean": 15.250950570342205, "episode_media": {}, "episodes_this_iter": 263, "policy_reward_min": {"red_0": 1.482421875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.48927648526616}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.482421875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875], "episode_lengths": [15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 25, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 18, 17, 17, 16, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 21, 15, 15, 18, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 16, 15, 15, 15, 18, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 17], "policy_red_0_reward": [1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.482421875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5129473215831747, "mean_inference_ms": 3.588793114882038, "mean_action_processing_ms": 0.20189153010194763, "mean_env_wait_ms": 0.24332947129609142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12920455787571664, "StateBufferConnector_ms": 0.010160801528524537, "ViewRequirementAgentConnector_ms": 0.20301577709473584}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.482421875, "episode_reward_mean": 1.48927648526616, "episode_len_mean": 15.250950570342205, "episodes_this_iter": 263, "policy_reward_min": {"red_0": 1.482421875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.48927648526616}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.482421875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875], "episode_lengths": [15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 25, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 18, 17, 17, 16, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 21, 15, 15, 18, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 16, 15, 15, 15, 18, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 17], "policy_red_0_reward": [1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.482421875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5129473215831747, "mean_inference_ms": 3.588793114882038, "mean_action_processing_ms": 0.20189153010194763, "mean_env_wait_ms": 0.24332947129609142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12920455787571664, "StateBufferConnector_ms": 0.010160801528524537, "ViewRequirementAgentConnector_ms": 0.20301577709473584}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.27746153489092, "num_env_steps_trained_throughput_per_sec": 89.27746153489092, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 34866.616, "sample_time_ms": 19619.699, "learn_time_ms": 15168.207, "learn_throughput": 263.709, "synch_weights_time_ms": 77.774}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 2976, "training_iteration": 45, "trial_id": "3c06e_00000", "date": "2023-09-12_14-52-56", "timestamp": 1694544776, "time_this_iter_s": 44.85842752456665, "time_total_s": 1423.100127696991, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b8dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1423.100127696991, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 38.778125, "ram_util_percent": 25.901562499999997}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1547345649528629, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006153290834011689, "policy_loss": -0.0070522689767434105, "vf_loss": 0.0005477663688566281, "vf_explained_var": 0.9879499223083258, "kl": 0.004682823168716274, "entropy": 0.10385671869153157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4739843750000001, "episode_reward_mean": 1.4891643943050195, "episode_len_mean": 15.40926640926641, "episode_media": {}, "episodes_this_iter": 259, "policy_reward_min": {"red_0": 1.4739843750000001}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4891643943050195}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4739843750000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4782031249999998, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4788062499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 37, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 31, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 15, 19, 15, 19, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 15, 30, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4739843750000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4782031249999998, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4788062499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.521022370568756, "mean_inference_ms": 3.6238494569298014, "mean_action_processing_ms": 0.20386016770385038, "mean_env_wait_ms": 0.24667570495116894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14444133950016214, "StateBufferConnector_ms": 0.01119296983402208, "ViewRequirementAgentConnector_ms": 0.22535158400369887}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4739843750000001, "episode_reward_mean": 1.4891643943050195, "episode_len_mean": 15.40926640926641, "episodes_this_iter": 259, "policy_reward_min": {"red_0": 1.4739843750000001}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4891643943050195}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4739843750000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4782031249999998, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4788062499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 37, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 31, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 15, 19, 15, 19, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 15, 30, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4739843750000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4782031249999998, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4845312499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4788062499999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.521022370568756, "mean_inference_ms": 3.6238494569298014, "mean_action_processing_ms": 0.20386016770385038, "mean_env_wait_ms": 0.24667570495116894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14444133950016214, "StateBufferConnector_ms": 0.01119296983402208, "ViewRequirementAgentConnector_ms": 0.22535158400369887}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 92.91247130429149, "num_env_steps_trained_throughput_per_sec": 92.91247130429149, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 35253.446, "sample_time_ms": 20492.848, "learn_time_ms": 14677.814, "learn_throughput": 272.52, "synch_weights_time_ms": 81.829}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3235, "training_iteration": 46, "trial_id": "3c06e_00000", "date": "2023-09-12_14-53-39", "timestamp": 1694544819, "time_this_iter_s": 43.084118127822876, "time_total_s": 1466.1842458248138, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147ba680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1466.1842458248138, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 37.819047619047616, "ram_util_percent": 25.706349206349202}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8830922612299522, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00787067054485912, "policy_loss": -0.008240242189640413, "vf_loss": 0.0002647988588677208, "vf_explained_var": 0.9942828993623455, "kl": 0.0027939385537326905, "entropy": 0.08527075567399152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4746875, "episode_reward_mean": 1.4892866088403043, "episode_len_mean": 15.23574144486692, "episode_media": {}, "episodes_this_iter": 263, "policy_reward_min": {"red_0": 1.4746875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4892866088403043}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4746875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 17, 19, 15, 15, 15, 15, 15, 15, 15, 15, 16, 19, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 17, 15, 15, 15, 15, 36, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 17, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 17, 15, 19, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4746875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.524866764750822, "mean_inference_ms": 3.6331699253046437, "mean_action_processing_ms": 0.20444690169642993, "mean_env_wait_ms": 0.24784305075453625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10850302620079127, "StateBufferConnector_ms": 0.008955382575553632, "ViewRequirementAgentConnector_ms": 0.17608227385314246}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4746875, "episode_reward_mean": 1.4892866088403043, "episode_len_mean": 15.23574144486692, "episodes_this_iter": 263, "policy_reward_min": {"red_0": 1.4746875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4892866088403043}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4746875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 17, 19, 15, 15, 15, 15, 15, 15, 15, 15, 16, 19, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 17, 15, 15, 15, 15, 36, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 17, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 17, 15, 19, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4746875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.524866764750822, "mean_inference_ms": 3.6331699253046437, "mean_action_processing_ms": 0.20444690169642993, "mean_env_wait_ms": 0.24784305075453625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10850302620079127, "StateBufferConnector_ms": 0.008955382575553632, "ViewRequirementAgentConnector_ms": 0.17608227385314246}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 114.75367272003592, "num_env_steps_trained_throughput_per_sec": 114.75367272003592, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 35462.327, "sample_time_ms": 20657.409, "learn_time_ms": 14722.347, "learn_throughput": 271.696, "synch_weights_time_ms": 81.63}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 3498, "training_iteration": 47, "trial_id": "3c06e_00000", "date": "2023-09-12_14-54-15", "timestamp": 1694544855, "time_this_iter_s": 34.88202381134033, "time_total_s": 1501.0662696361542, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b76d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1501.0662696361542, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 34.518, "ram_util_percent": 25.114000000000004}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7732124546465153, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01059889952678835, "policy_loss": -0.01094430840773081, "vf_loss": 0.0002190776855201193, "vf_explained_var": 0.99537639139841, "kl": 0.0067376718302374645, "entropy": 0.07837489362573251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.48171875, "episode_reward_mean": 1.4892811784351148, "episode_len_mean": 15.244274809160306, "episode_media": {}, "episodes_this_iter": 262, "policy_reward_min": {"red_0": 1.48171875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4892811784351148}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.483125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48171875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 21, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 24, 15, 15, 15, 15, 15, 15, 15, 15, 21, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 20, 15, 17, 15, 15, 16, 15, 23, 15, 15, 15, 15, 15, 15, 15, 15, 21, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 26, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.483125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48171875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526071809093157, "mean_inference_ms": 3.6284357005658405, "mean_action_processing_ms": 0.204166982993148, "mean_env_wait_ms": 0.2477715287638191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0896170849108514, "StateBufferConnector_ms": 0.007751970800734659, "ViewRequirementAgentConnector_ms": 0.14807959549299632}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.48171875, "episode_reward_mean": 1.4892811784351148, "episode_len_mean": 15.244274809160306, "episodes_this_iter": 262, "policy_reward_min": {"red_0": 1.48171875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4892811784351148}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.483125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48171875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 21, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 24, 15, 15, 15, 15, 15, 15, 15, 15, 21, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 20, 15, 17, 15, 15, 16, 15, 23, 15, 15, 15, 15, 15, 15, 15, 15, 21, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 26, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.483125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.483828125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48171875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526071809093157, "mean_inference_ms": 3.6284357005658405, "mean_action_processing_ms": 0.204166982993148, "mean_env_wait_ms": 0.2477715287638191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0896170849108514, "StateBufferConnector_ms": 0.007751970800734659, "ViewRequirementAgentConnector_ms": 0.14807959549299632}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.05223502434694, "num_env_steps_trained_throughput_per_sec": 130.05223502434694, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 35348.38, "sample_time_ms": 20628.771, "learn_time_ms": 14637.572, "learn_throughput": 273.269, "synch_weights_time_ms": 81.091}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 3760, "training_iteration": 48, "trial_id": "3c06e_00000", "date": "2023-09-12_14-54-46", "timestamp": 1694544886, "time_this_iter_s": 30.783123016357422, "time_total_s": 1531.8493926525116, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b9ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1531.8493926525116, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.48409090909091, "ram_util_percent": 23.763636363636362}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8466592477091278, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008001854674027224, "policy_loss": -0.008185046159633202, "vf_loss": 5.907828683528275e-05, "vf_explained_var": 0.9988489596794049, "kl": 0.0066193896553606935, "entropy": 0.07514805587707088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.47890625, "episode_reward_mean": 1.4893650449810607, "episode_len_mean": 15.125, "episode_media": {}, "episodes_this_iter": 264, "policy_reward_min": {"red_0": 1.47890625}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4893650449810607}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.47890625, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 30, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.47890625, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5292407187683824, "mean_inference_ms": 3.635091166363266, "mean_action_processing_ms": 0.20451678965646303, "mean_env_wait_ms": 0.24864184870292352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10457327871611624, "StateBufferConnector_ms": 0.00860718163576993, "ViewRequirementAgentConnector_ms": 0.1691214062950828}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.47890625, "episode_reward_mean": 1.4893650449810607, "episode_len_mean": 15.125, "episodes_this_iter": 264, "policy_reward_min": {"red_0": 1.47890625}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4893650449810607}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.47890625, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 30, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.47890625, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5292407187683824, "mean_inference_ms": 3.635091166363266, "mean_action_processing_ms": 0.20451678965646303, "mean_env_wait_ms": 0.24864184870292352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10457327871611624, "StateBufferConnector_ms": 0.00860718163576993, "ViewRequirementAgentConnector_ms": 0.1691214062950828}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 109.69135523993899, "num_env_steps_trained_throughput_per_sec": 109.69135523993899, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 35772.417, "sample_time_ms": 20794.747, "learn_time_ms": 14894.522, "learn_throughput": 268.555, "synch_weights_time_ms": 82.191}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 4024, "training_iteration": 49, "trial_id": "3c06e_00000", "date": "2023-09-12_14-55-23", "timestamp": 1694544923, "time_this_iter_s": 36.496225118637085, "time_total_s": 1568.3456177711487, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b7a30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1568.3456177711487, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 35.9811320754717, "ram_util_percent": 25.369811320754724}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5769068330797987, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.042435816921230676, "policy_loss": -0.04401271064367999, "vf_loss": 2.3530191450997034e-05, "vf_explained_var": 0.9995582291235526, "kl": 0.0828460507158159, "entropy": 0.14695133542409167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.488046875, "episode_reward_mean": 1.4894190181902989, "episode_len_mean": 15.048507462686567, "episode_media": {}, "episodes_this_iter": 268, "policy_reward_min": {"red_0": 1.488046875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4894190181902989}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5340056670866675, "mean_inference_ms": 3.6516308029945574, "mean_action_processing_ms": 0.20547962058878033, "mean_env_wait_ms": 0.2504713301704116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1231745107850032, "StateBufferConnector_ms": 0.009885741703545869, "ViewRequirementAgentConnector_ms": 0.19630576247599588}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.488046875, "episode_reward_mean": 1.4894190181902989, "episode_len_mean": 15.048507462686567, "episodes_this_iter": 268, "policy_reward_min": {"red_0": 1.488046875}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4894190181902989}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5340056670866675, "mean_inference_ms": 3.6516308029945574, "mean_action_processing_ms": 0.20547962058878033, "mean_env_wait_ms": 0.2504713301704116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1231745107850032, "StateBufferConnector_ms": 0.009885741703545869, "ViewRequirementAgentConnector_ms": 0.19630576247599588}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 98.86645007589053, "num_env_steps_trained_throughput_per_sec": 98.86645007589053, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 36716.921, "sample_time_ms": 21351.393, "learn_time_ms": 15281.437, "learn_throughput": 261.755, "synch_weights_time_ms": 83.123}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 4292, "training_iteration": 50, "trial_id": "3c06e_00000", "date": "2023-09-12_14-56-04", "timestamp": 1694544964, "time_this_iter_s": 40.49092745780945, "time_total_s": 1608.8365452289581, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a40d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1608.8365452289581, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 39.94655172413793, "ram_util_percent": 26.339655172413792}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8458050317286203, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.02643487859547046, "policy_loss": -0.027896804963529576, "vf_loss": 0.0007536020529338808, "vf_explained_var": 0.9833515673875809, "kl": 0.025184864168498737, "entropy": 0.19611680694700528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4606249999999998, "episode_reward_mean": 1.4881490384615388, "episode_len_mean": 16.854700854700855, "episode_media": {}, "episodes_this_iter": 234, "policy_reward_min": {"red_0": 1.4606249999999998}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4881490384615388}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.4859375, 1.488046875, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.485234375, 1.488046875, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.483828125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.483828125, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.4866406250000002, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.4845312499999999, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.485234375, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4606249999999998, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4859375, 1.48875, 1.489453125, 1.488046875, 1.483125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.4859375, 1.48875, 1.489453125, 1.488046875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.48734375, 1.489453125, 1.48734375, 1.4859375, 1.4859375, 1.48734375, 1.488046875, 1.48875, 1.48875, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.4866406250000002, 1.489453125, 1.48734375, 1.489453125, 1.48734375, 1.48734375, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.488046875, 1.4866406250000002, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.4866406250000002, 1.48734375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.485234375, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48734375, 1.48875, 1.4866406250000002, 1.488046875, 1.48875, 1.483828125, 1.489453125, 1.48875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.4866406250000002, 1.48734375, 1.488046875, 1.489453125, 1.485234375, 1.488046875, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.4866406250000002, 1.488046875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.485234375, 1.489453125], "episode_lengths": [15, 20, 17, 17, 17, 18, 15, 15, 15, 15, 20, 16, 17, 15, 21, 17, 15, 18, 16, 18, 16, 23, 15, 15, 16, 17, 16, 23, 18, 15, 16, 16, 15, 16, 18, 16, 15, 18, 19, 19, 16, 17, 15, 16, 17, 17, 15, 19, 22, 15, 15, 16, 15, 17, 16, 16, 15, 21, 15, 18, 16, 18, 16, 18, 15, 15, 56, 19, 15, 19, 16, 15, 16, 15, 17, 15, 17, 15, 17, 18, 15, 16, 16, 15, 17, 20, 17, 15, 15, 19, 16, 17, 15, 17, 18, 15, 15, 17, 15, 20, 16, 15, 17, 24, 15, 18, 15, 15, 15, 17, 16, 20, 16, 15, 17, 20, 15, 15, 16, 19, 18, 15, 18, 20, 20, 18, 17, 16, 16, 19, 15, 17, 15, 18, 19, 15, 18, 15, 18, 18, 15, 17, 16, 15, 15, 15, 17, 17, 17, 19, 15, 16, 16, 15, 15, 19, 16, 16, 18, 15, 16, 18, 16, 17, 19, 18, 16, 15, 16, 16, 16, 15, 15, 15, 16, 17, 15, 17, 21, 16, 19, 15, 15, 15, 16, 15, 17, 15, 16, 18, 15, 15, 18, 16, 18, 18, 16, 19, 17, 16, 23, 15, 16, 15, 19, 15, 15, 15, 16, 15, 15, 15, 18, 15, 19, 18, 17, 15, 21, 17, 15, 16, 18, 16, 19, 17, 18, 17, 15, 16, 16, 17, 21, 15], "policy_red_0_reward": [1.489453125, 1.4859375, 1.488046875, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.485234375, 1.488046875, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.483828125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.483828125, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.4866406250000002, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.4845312499999999, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.485234375, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4606249999999998, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4859375, 1.48875, 1.489453125, 1.488046875, 1.483125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.4859375, 1.48875, 1.489453125, 1.488046875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.48734375, 1.489453125, 1.48734375, 1.4859375, 1.4859375, 1.48734375, 1.488046875, 1.48875, 1.48875, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.4866406250000002, 1.489453125, 1.48734375, 1.489453125, 1.48734375, 1.48734375, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.488046875, 1.4866406250000002, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.4866406250000002, 1.48734375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.485234375, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48734375, 1.48875, 1.4866406250000002, 1.488046875, 1.48875, 1.483828125, 1.489453125, 1.48875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.4866406250000002, 1.48734375, 1.488046875, 1.489453125, 1.485234375, 1.488046875, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.4866406250000002, 1.488046875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.485234375, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5379021508240083, "mean_inference_ms": 3.665136940216379, "mean_action_processing_ms": 0.20630573868259636, "mean_env_wait_ms": 0.25200989963609766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1216432987115322, "StateBufferConnector_ms": 0.009630887936323117, "ViewRequirementAgentConnector_ms": 0.19187754036014915}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4606249999999998, "episode_reward_mean": 1.4881490384615388, "episode_len_mean": 16.854700854700855, "episodes_this_iter": 234, "policy_reward_min": {"red_0": 1.4606249999999998}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4881490384615388}, "hist_stats": {"episode_reward": [1.489453125, 1.4859375, 1.488046875, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.485234375, 1.488046875, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.483828125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.483828125, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.4866406250000002, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.4845312499999999, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.485234375, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4606249999999998, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4859375, 1.48875, 1.489453125, 1.488046875, 1.483125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.4859375, 1.48875, 1.489453125, 1.488046875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.48734375, 1.489453125, 1.48734375, 1.4859375, 1.4859375, 1.48734375, 1.488046875, 1.48875, 1.48875, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.4866406250000002, 1.489453125, 1.48734375, 1.489453125, 1.48734375, 1.48734375, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.488046875, 1.4866406250000002, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.4866406250000002, 1.48734375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.485234375, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48734375, 1.48875, 1.4866406250000002, 1.488046875, 1.48875, 1.483828125, 1.489453125, 1.48875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.4866406250000002, 1.48734375, 1.488046875, 1.489453125, 1.485234375, 1.488046875, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.4866406250000002, 1.488046875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.485234375, 1.489453125], "episode_lengths": [15, 20, 17, 17, 17, 18, 15, 15, 15, 15, 20, 16, 17, 15, 21, 17, 15, 18, 16, 18, 16, 23, 15, 15, 16, 17, 16, 23, 18, 15, 16, 16, 15, 16, 18, 16, 15, 18, 19, 19, 16, 17, 15, 16, 17, 17, 15, 19, 22, 15, 15, 16, 15, 17, 16, 16, 15, 21, 15, 18, 16, 18, 16, 18, 15, 15, 56, 19, 15, 19, 16, 15, 16, 15, 17, 15, 17, 15, 17, 18, 15, 16, 16, 15, 17, 20, 17, 15, 15, 19, 16, 17, 15, 17, 18, 15, 15, 17, 15, 20, 16, 15, 17, 24, 15, 18, 15, 15, 15, 17, 16, 20, 16, 15, 17, 20, 15, 15, 16, 19, 18, 15, 18, 20, 20, 18, 17, 16, 16, 19, 15, 17, 15, 18, 19, 15, 18, 15, 18, 18, 15, 17, 16, 15, 15, 15, 17, 17, 17, 19, 15, 16, 16, 15, 15, 19, 16, 16, 18, 15, 16, 18, 16, 17, 19, 18, 16, 15, 16, 16, 16, 15, 15, 15, 16, 17, 15, 17, 21, 16, 19, 15, 15, 15, 16, 15, 17, 15, 16, 18, 15, 15, 18, 16, 18, 18, 16, 19, 17, 16, 23, 15, 16, 15, 19, 15, 15, 15, 16, 15, 15, 15, 18, 15, 19, 18, 17, 15, 21, 17, 15, 16, 18, 16, 19, 17, 18, 17, 15, 16, 16, 17, 21, 15], "policy_red_0_reward": [1.489453125, 1.4859375, 1.488046875, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.485234375, 1.488046875, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.483828125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.483828125, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.4866406250000002, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.4845312499999999, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.485234375, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4606249999999998, 1.4866406250000002, 1.489453125, 1.4866406250000002, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4859375, 1.48875, 1.489453125, 1.488046875, 1.483125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.4859375, 1.48875, 1.489453125, 1.488046875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.48734375, 1.489453125, 1.48734375, 1.4859375, 1.4859375, 1.48734375, 1.488046875, 1.48875, 1.48875, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.4866406250000002, 1.489453125, 1.48734375, 1.489453125, 1.48734375, 1.48734375, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.488046875, 1.4866406250000002, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.4866406250000002, 1.48734375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.485234375, 1.48875, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.48734375, 1.48875, 1.4866406250000002, 1.488046875, 1.48875, 1.483828125, 1.489453125, 1.48875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.4866406250000002, 1.48734375, 1.488046875, 1.489453125, 1.485234375, 1.488046875, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.4866406250000002, 1.488046875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.485234375, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5379021508240083, "mean_inference_ms": 3.665136940216379, "mean_action_processing_ms": 0.20630573868259636, "mean_env_wait_ms": 0.25200989963609766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1216432987115322, "StateBufferConnector_ms": 0.009630887936323117, "ViewRequirementAgentConnector_ms": 0.19187754036014915}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.1537146774859, "num_env_steps_trained_throughput_per_sec": 103.1537146774859, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 37408.964, "sample_time_ms": 21778.134, "learn_time_ms": 15545.295, "learn_throughput": 257.313, "synch_weights_time_ms": 84.548}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 4526, "training_iteration": 51, "trial_id": "3c06e_00000", "date": "2023-09-12_14-56-43", "timestamp": 1694545003, "time_this_iter_s": 38.808316469192505, "time_total_s": 1647.6448616981506, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a69e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1647.6448616981506, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 38.76428571428572, "ram_util_percent": 26.455357142857142}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6931737440405413, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.030763529023412655, "policy_loss": -0.03255735930870287, "vf_loss": 0.00011847679148786483, "vf_explained_var": 0.9975120243926843, "kl": 0.039712086139129944, "entropy": 0.09751747376673545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4859375, "episode_reward_mean": 1.488916092519685, "episode_len_mean": 15.763779527559056, "episode_media": {}, "episodes_this_iter": 254, "policy_reward_min": {"red_0": 1.4859375}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.488916092519685}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.48875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.488046875, 1.4859375, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.488046875, 1.48875, 1.488046875, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.48875, 1.48875, 1.48875], "episode_lengths": [16, 17, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 18, 16, 17, 15, 15, 15, 15, 15, 15, 15, 18, 16, 17, 15, 15, 15, 18, 16, 18, 17, 20, 17, 16, 16, 17, 15, 15, 15, 17, 16, 16, 15, 16, 16, 15, 15, 15, 15, 16, 15, 15, 17, 16, 15, 15, 16, 16, 15, 15, 15, 15, 15, 16, 18, 17, 15, 16, 16, 17, 15, 15, 16, 15, 16, 15, 15, 20, 15, 17, 15, 15, 15, 15, 16, 15, 16, 15, 16, 15, 15, 15, 19, 17, 16, 15, 17, 15, 16, 16, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 18, 15, 15, 15, 18, 15, 15, 16, 15, 16, 17, 15, 17, 17, 15, 15, 15, 18, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 16, 19, 15, 16, 17, 15, 17, 15, 15, 15, 16, 16, 15, 16, 15, 15, 18, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 17, 15, 15, 15, 15, 19, 17, 17, 16, 17, 15, 20, 15, 17, 15, 16, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 16, 16, 15, 16, 16, 15, 18, 15, 16, 15, 15, 16, 15, 16, 18, 17, 19, 16, 15, 15, 16, 17, 15, 15, 16, 15, 18, 15, 15, 15, 17, 16, 15, 15, 18, 15, 16, 15, 17, 15, 15, 16, 16, 16, 15, 15, 15, 16, 16, 15, 18, 17, 16, 16, 16, 16], "policy_red_0_reward": [1.48875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.488046875, 1.4859375, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.488046875, 1.48875, 1.488046875, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.48875, 1.48875, 1.48875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5424689320101073, "mean_inference_ms": 3.6809575791472446, "mean_action_processing_ms": 0.20731266620845168, "mean_env_wait_ms": 0.25387419703852465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1238359241035041, "StateBufferConnector_ms": 0.00973836643489327, "ViewRequirementAgentConnector_ms": 0.19903567832285965}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4859375, "episode_reward_mean": 1.488916092519685, "episode_len_mean": 15.763779527559056, "episodes_this_iter": 254, "policy_reward_min": {"red_0": 1.4859375}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.488916092519685}, "hist_stats": {"episode_reward": [1.48875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.488046875, 1.4859375, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.488046875, 1.48875, 1.488046875, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.48875, 1.48875, 1.48875], "episode_lengths": [16, 17, 16, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 18, 16, 17, 15, 15, 15, 15, 15, 15, 15, 18, 16, 17, 15, 15, 15, 18, 16, 18, 17, 20, 17, 16, 16, 17, 15, 15, 15, 17, 16, 16, 15, 16, 16, 15, 15, 15, 15, 16, 15, 15, 17, 16, 15, 15, 16, 16, 15, 15, 15, 15, 15, 16, 18, 17, 15, 16, 16, 17, 15, 15, 16, 15, 16, 15, 15, 20, 15, 17, 15, 15, 15, 15, 16, 15, 16, 15, 16, 15, 15, 15, 19, 17, 16, 15, 17, 15, 16, 16, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 18, 15, 15, 15, 18, 15, 15, 16, 15, 16, 17, 15, 17, 17, 15, 15, 15, 18, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 16, 19, 15, 16, 17, 15, 17, 15, 15, 15, 16, 16, 15, 16, 15, 15, 18, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 17, 15, 15, 15, 15, 19, 17, 17, 16, 17, 15, 20, 15, 17, 15, 16, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 16, 16, 15, 16, 16, 15, 18, 15, 16, 15, 15, 16, 15, 16, 18, 17, 19, 16, 15, 15, 16, 17, 15, 15, 16, 15, 18, 15, 15, 15, 17, 16, 15, 15, 18, 15, 16, 15, 17, 15, 15, 16, 16, 16, 15, 15, 15, 16, 16, 15, 18, 17, 16, 16, 16, 16], "policy_red_0_reward": [1.48875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48734375, 1.488046875, 1.4859375, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4866406250000002, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.488046875, 1.488046875, 1.48875, 1.488046875, 1.489453125, 1.4859375, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.48875, 1.48875, 1.48875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5424689320101073, "mean_inference_ms": 3.6809575791472446, "mean_action_processing_ms": 0.20731266620845168, "mean_env_wait_ms": 0.25387419703852465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1238359241035041, "StateBufferConnector_ms": 0.00973836643489327, "ViewRequirementAgentConnector_ms": 0.19903567832285965}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 98.38968473235659, "num_env_steps_trained_throughput_per_sec": 98.38968473235659, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 38379.927, "sample_time_ms": 22309.7, "learn_time_ms": 15983.368, "learn_throughput": 250.26, "synch_weights_time_ms": 85.863}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 4780, "training_iteration": 52, "trial_id": "3c06e_00000", "date": "2023-09-12_14-57-24", "timestamp": 1694545044, "time_this_iter_s": 40.68340039253235, "time_total_s": 1688.328262090683, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b6710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1688.328262090683, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 40.371186440677974, "ram_util_percent": 26.671186440677968}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5553043581002082, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015114317123819394, "policy_loss": -0.016807154754254348, "vf_loss": 6.397335802243257e-05, "vf_explained_var": 0.9987011595318714, "kl": 0.025740077497651163, "entropy": 0.09843213129788637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.483828125, "episode_reward_mean": 1.489301886792453, "episode_len_mean": 15.215094339622642, "episode_media": {}, "episodes_this_iter": 265, "policy_reward_min": {"red_0": 1.483828125}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.489301886792453}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.48734375, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.483828125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [18, 15, 16, 15, 16, 16, 15, 16, 15, 23, 18, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 17, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 15], "policy_red_0_reward": [1.48734375, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.483828125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5458363307787472, "mean_inference_ms": 3.6904888857740015, "mean_action_processing_ms": 0.2078815956890135, "mean_env_wait_ms": 0.25510950562930723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11423677768347398, "StateBufferConnector_ms": 0.0090296763294148, "ViewRequirementAgentConnector_ms": 0.18195854043060877}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.483828125, "episode_reward_mean": 1.489301886792453, "episode_len_mean": 15.215094339622642, "episodes_this_iter": 265, "policy_reward_min": {"red_0": 1.483828125}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.489301886792453}, "hist_stats": {"episode_reward": [1.48734375, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.483828125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [18, 15, 16, 15, 16, 16, 15, 16, 15, 23, 18, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 17, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 15], "policy_red_0_reward": [1.48734375, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.483828125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5458363307787472, "mean_inference_ms": 3.6904888857740015, "mean_action_processing_ms": 0.2078815956890135, "mean_env_wait_ms": 0.25510950562930723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11423677768347398, "StateBufferConnector_ms": 0.0090296763294148, "ViewRequirementAgentConnector_ms": 0.18195854043060877}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 108.40357161553538, "num_env_steps_trained_throughput_per_sec": 108.40357161553538, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 38539.764, "sample_time_ms": 22553.661, "learn_time_ms": 15899.538, "learn_throughput": 251.58, "synch_weights_time_ms": 85.59}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 5045, "training_iteration": 53, "trial_id": "3c06e_00000", "date": "2023-09-12_14-58-01", "timestamp": 1694545081, "time_this_iter_s": 36.92739224433899, "time_total_s": 1725.255654335022, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a4430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1725.255654335022, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 36.7188679245283, "ram_util_percent": 26.284905660377362}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.861054644268006, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.023572427511559604, "policy_loss": -0.026681075473121988, "vf_loss": 0.0004563042165803684, "vf_explained_var": 0.9902482556800047, "kl": 0.027942382334822595, "entropy": 0.1508658014781152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4739843750000001, "episode_reward_mean": 1.4885813643292687, "episode_len_mean": 16.239837398373982, "episode_media": {}, "episodes_this_iter": 246, "policy_reward_min": {"red_0": 1.4739843750000001}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4885813643292687}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.4746875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4866406250000002, 1.48734375, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.48875, 1.4866406250000002, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.4739843750000001, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.4859375, 1.488046875, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.485234375, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4859375, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875], "episode_lengths": [15, 15, 15, 17, 17, 16, 15, 16, 15, 16, 16, 15, 18, 16, 15, 16, 15, 15, 15, 20, 16, 17, 15, 15, 15, 16, 16, 16, 16, 20, 16, 17, 15, 16, 17, 17, 15, 19, 15, 17, 15, 15, 19, 15, 17, 15, 16, 16, 18, 17, 15, 15, 15, 16, 16, 16, 16, 16, 18, 15, 15, 15, 16, 16, 15, 18, 16, 15, 15, 17, 36, 16, 16, 15, 15, 17, 15, 17, 15, 15, 15, 16, 15, 15, 17, 15, 15, 17, 16, 15, 15, 18, 15, 16, 17, 17, 17, 15, 15, 15, 15, 17, 16, 15, 15, 17, 15, 17, 15, 19, 15, 15, 16, 15, 15, 15, 15, 18, 16, 19, 18, 15, 17, 17, 15, 15, 15, 15, 15, 15, 18, 16, 16, 18, 15, 15, 20, 15, 16, 16, 19, 16, 15, 17, 15, 37, 17, 15, 17, 16, 15, 16, 18, 17, 15, 15, 18, 16, 20, 15, 15, 16, 18, 16, 19, 15, 16, 15, 17, 15, 17, 16, 16, 16, 15, 15, 16, 15, 15, 21, 15, 20, 17, 19, 16, 17, 15, 16, 15, 15, 16, 15, 18, 21, 17, 15, 15, 15, 17, 15, 16, 16, 17, 15, 16, 15, 16, 17, 16, 16, 15, 16, 17, 18, 16, 15, 18, 15, 17, 16, 15, 16, 16, 15, 15, 18, 15, 16, 15, 16, 15, 15, 18, 16, 15, 15, 15, 15, 16, 20, 17, 15, 17, 15, 15, 16], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.4746875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4866406250000002, 1.48734375, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.48875, 1.4866406250000002, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.4739843750000001, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.4859375, 1.488046875, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.485234375, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4859375, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5472432247482732, "mean_inference_ms": 3.6894959146558683, "mean_action_processing_ms": 0.20782410678229504, "mean_env_wait_ms": 0.25531675436539586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0981353162749996, "StateBufferConnector_ms": 0.0082088679802127, "ViewRequirementAgentConnector_ms": 0.15921893158579262}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4739843750000001, "episode_reward_mean": 1.4885813643292687, "episode_len_mean": 16.239837398373982, "episodes_this_iter": 246, "policy_reward_min": {"red_0": 1.4739843750000001}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4885813643292687}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.4746875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4866406250000002, 1.48734375, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.48875, 1.4866406250000002, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.4739843750000001, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.4859375, 1.488046875, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.485234375, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4859375, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875], "episode_lengths": [15, 15, 15, 17, 17, 16, 15, 16, 15, 16, 16, 15, 18, 16, 15, 16, 15, 15, 15, 20, 16, 17, 15, 15, 15, 16, 16, 16, 16, 20, 16, 17, 15, 16, 17, 17, 15, 19, 15, 17, 15, 15, 19, 15, 17, 15, 16, 16, 18, 17, 15, 15, 15, 16, 16, 16, 16, 16, 18, 15, 15, 15, 16, 16, 15, 18, 16, 15, 15, 17, 36, 16, 16, 15, 15, 17, 15, 17, 15, 15, 15, 16, 15, 15, 17, 15, 15, 17, 16, 15, 15, 18, 15, 16, 17, 17, 17, 15, 15, 15, 15, 17, 16, 15, 15, 17, 15, 17, 15, 19, 15, 15, 16, 15, 15, 15, 15, 18, 16, 19, 18, 15, 17, 17, 15, 15, 15, 15, 15, 15, 18, 16, 16, 18, 15, 15, 20, 15, 16, 16, 19, 16, 15, 17, 15, 37, 17, 15, 17, 16, 15, 16, 18, 17, 15, 15, 18, 16, 20, 15, 15, 16, 18, 16, 19, 15, 16, 15, 17, 15, 17, 16, 16, 16, 15, 15, 16, 15, 15, 21, 15, 20, 17, 19, 16, 17, 15, 16, 15, 15, 16, 15, 18, 21, 17, 15, 15, 15, 17, 15, 16, 16, 17, 15, 16, 15, 16, 17, 16, 16, 15, 16, 17, 18, 16, 15, 18, 15, 17, 16, 15, 16, 16, 15, 15, 18, 15, 16, 15, 16, 15, 15, 18, 16, 15, 15, 15, 15, 16, 20, 17, 15, 17, 15, 15, 16], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.4859375, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.4746875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4866406250000002, 1.48734375, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.4859375, 1.489453125, 1.48875, 1.48875, 1.4866406250000002, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.4739843750000001, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.4859375, 1.489453125, 1.489453125, 1.48875, 1.48734375, 1.48875, 1.4866406250000002, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.4859375, 1.488046875, 1.4866406250000002, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48734375, 1.485234375, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.48734375, 1.48875, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4859375, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5472432247482732, "mean_inference_ms": 3.6894959146558683, "mean_action_processing_ms": 0.20782410678229504, "mean_env_wait_ms": 0.25531675436539586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0981353162749996, "StateBufferConnector_ms": 0.0082088679802127, "ViewRequirementAgentConnector_ms": 0.15921893158579262}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 121.83197022031311, "num_env_steps_trained_throughput_per_sec": 121.83197022031311, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 37955.67, "sample_time_ms": 22250.087, "learn_time_ms": 15619.955, "learn_throughput": 256.083, "synch_weights_time_ms": 84.642}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 5291, "training_iteration": 54, "trial_id": "3c06e_00000", "date": "2023-09-12_14-58-35", "timestamp": 1694545115, "time_this_iter_s": 32.859469413757324, "time_total_s": 1758.1151237487793, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc441a7e20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1758.1151237487793, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 29.517021276595738, "ram_util_percent": 24.84468085106383}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6270485941786319, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011787390974798957, "policy_loss": -0.013632758241146802, "vf_loss": 4.80766337394319e-05, "vf_explained_var": 0.9989791654671232, "kl": 0.012622950074483297, "entropy": 0.11512096530447403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4866406250000002, "episode_reward_mean": 1.489231370192308, "episode_len_mean": 15.315384615384616, "episode_media": {}, "episodes_this_iter": 260, "policy_reward_min": {"red_0": 1.4866406250000002}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.489231370192308}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875], "episode_lengths": [19, 15, 15, 15, 15, 15, 17, 16, 15, 17, 15, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 15, 16, 17, 15, 15, 15, 16, 16, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 17, 15, 15, 17, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 16, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 17, 15, 17, 15, 16, 15, 16, 16, 15, 15, 15, 17, 15, 17, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 16, 15, 16, 15, 16, 15, 15, 17, 16, 15, 15, 15, 15, 15, 17, 15, 15, 16], "policy_red_0_reward": [1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5484005961680051, "mean_inference_ms": 3.687614687463252, "mean_action_processing_ms": 0.207700377735369, "mean_env_wait_ms": 0.255359854657185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09404622591458835, "StateBufferConnector_ms": 0.007947041438176082, "ViewRequirementAgentConnector_ms": 0.15314404781048113}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4866406250000002, "episode_reward_mean": 1.489231370192308, "episode_len_mean": 15.315384615384616, "episodes_this_iter": 260, "policy_reward_min": {"red_0": 1.4866406250000002}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.489231370192308}, "hist_stats": {"episode_reward": [1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875], "episode_lengths": [19, 15, 15, 15, 15, 15, 17, 16, 15, 17, 15, 15, 15, 15, 15, 17, 17, 15, 15, 15, 15, 15, 16, 17, 15, 15, 15, 16, 16, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 17, 15, 15, 17, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 17, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 16, 15, 15, 15, 15, 16, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 17, 15, 17, 15, 16, 15, 16, 16, 15, 15, 15, 17, 15, 17, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 16, 15, 16, 15, 16, 15, 15, 17, 16, 15, 15, 15, 15, 15, 17, 15, 15, 16], "policy_red_0_reward": [1.4866406250000002, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5484005961680051, "mean_inference_ms": 3.687614687463252, "mean_action_processing_ms": 0.207700377735369, "mean_env_wait_ms": 0.255359854657185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09404622591458835, "StateBufferConnector_ms": 0.007947041438176082, "ViewRequirementAgentConnector_ms": 0.15314404781048113}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 119.31677775624236, "num_env_steps_trained_throughput_per_sec": 119.31677775624236, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 36827.678, "sample_time_ms": 21654.377, "learn_time_ms": 15092.05, "learn_throughput": 265.04, "synch_weights_time_ms": 80.357}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 5551, "training_iteration": 55, "trial_id": "3c06e_00000", "date": "2023-09-12_14-59-09", "timestamp": 1694545149, "time_this_iter_s": 33.55381798744202, "time_total_s": 1791.6689417362213, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147bb130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1791.6689417362213, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 30.439583333333335, "ram_util_percent": 24.412500000000005}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6806094552079838, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07112657529093364, "policy_loss": -0.057026381705266735, "vf_loss": 0.10344648455890516, "vf_explained_var": 0.4234748203928272, "kl": 0.17352145420747978, "entropy": 0.7827737683740755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.2719906250000002, "episode_reward_mean": 1.4832995000000004, "episode_len_mean": 23.36, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {"red_0": 1.2719906250000002}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4832995000000004}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.4887000000000001, 1.4887000000000001, 1.48875, 1.4887000000000001, 1.489453125, 1.487946875, 1.488046875, 1.480815625, 1.4887000000000001, 1.489453125, 1.48875, 1.4859375, 1.487946875, 1.4887000000000001, 1.487946875, 1.489453125, 1.489453125, 1.48724375, 1.489453125, 1.489453125, 1.291009375, 1.4887000000000001, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.4866406250000002, 1.48875, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.4866406250000002, 1.4864406250000002, 1.48875, 1.488046875, 1.3498062499999999, 1.4887000000000001, 1.489453125, 1.4866406250000002, 1.487946875, 1.2719906250000002, 1.489453125, 1.48875, 1.489453125], "episode_lengths": [15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 16, 15, 16, 15, 16, 15, 15, 17, 16, 15, 15, 15, 15, 15, 17, 15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 16, 15, 15, 16, 16, 16, 16, 15, 17, 17, 27, 16, 15, 16, 20, 17, 16, 17, 15, 15, 18, 15, 15, 285, 16, 15, 15, 17, 16, 19, 16, 16, 15, 16, 19, 19, 16, 17, 206, 16, 15, 19, 17, 307, 15, 16, 15], "policy_red_0_reward": [1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.4887000000000001, 1.4887000000000001, 1.48875, 1.4887000000000001, 1.489453125, 1.487946875, 1.488046875, 1.480815625, 1.4887000000000001, 1.489453125, 1.48875, 1.4859375, 1.487946875, 1.4887000000000001, 1.487946875, 1.489453125, 1.489453125, 1.48724375, 1.489453125, 1.489453125, 1.291009375, 1.4887000000000001, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.4866406250000002, 1.48875, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.4866406250000002, 1.4864406250000002, 1.48875, 1.488046875, 1.3498062499999999, 1.4887000000000001, 1.489453125, 1.4866406250000002, 1.487946875, 1.2719906250000002, 1.489453125, 1.48875, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538184736494565, "mean_inference_ms": 3.7209504374345723, "mean_action_processing_ms": 0.2094006170082107, "mean_env_wait_ms": 0.2577270674901459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0973060131072998, "StateBufferConnector_ms": 0.008200645446777344, "ViewRequirementAgentConnector_ms": 0.15668392181396484}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.2719906250000002, "episode_reward_mean": 1.4832995000000004, "episode_len_mean": 23.36, "episodes_this_iter": 54, "policy_reward_min": {"red_0": 1.2719906250000002}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4832995000000004}, "hist_stats": {"episode_reward": [1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.4887000000000001, 1.4887000000000001, 1.48875, 1.4887000000000001, 1.489453125, 1.487946875, 1.488046875, 1.480815625, 1.4887000000000001, 1.489453125, 1.48875, 1.4859375, 1.487946875, 1.4887000000000001, 1.487946875, 1.489453125, 1.489453125, 1.48724375, 1.489453125, 1.489453125, 1.291009375, 1.4887000000000001, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.4866406250000002, 1.48875, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.4866406250000002, 1.4864406250000002, 1.48875, 1.488046875, 1.3498062499999999, 1.4887000000000001, 1.489453125, 1.4866406250000002, 1.487946875, 1.2719906250000002, 1.489453125, 1.48875, 1.489453125], "episode_lengths": [15, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 16, 15, 16, 15, 16, 15, 15, 17, 16, 15, 15, 15, 15, 15, 17, 15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 16, 15, 15, 16, 16, 16, 16, 15, 17, 17, 27, 16, 15, 16, 20, 17, 16, 17, 15, 15, 18, 15, 15, 285, 16, 15, 15, 17, 16, 19, 16, 16, 15, 16, 19, 19, 16, 17, 206, 16, 15, 19, 17, 307, 15, 16, 15], "policy_red_0_reward": [1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.4887000000000001, 1.4887000000000001, 1.48875, 1.4887000000000001, 1.489453125, 1.487946875, 1.488046875, 1.480815625, 1.4887000000000001, 1.489453125, 1.48875, 1.4859375, 1.487946875, 1.4887000000000001, 1.487946875, 1.489453125, 1.489453125, 1.48724375, 1.489453125, 1.489453125, 1.291009375, 1.4887000000000001, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.4866406250000002, 1.48875, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.4866406250000002, 1.4864406250000002, 1.48875, 1.488046875, 1.3498062499999999, 1.4887000000000001, 1.489453125, 1.4866406250000002, 1.487946875, 1.2719906250000002, 1.489453125, 1.48875, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538184736494565, "mean_inference_ms": 3.7209504374345723, "mean_action_processing_ms": 0.2094006170082107, "mean_env_wait_ms": 0.2577270674901459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0973060131072998, "StateBufferConnector_ms": 0.008200645446777344, "ViewRequirementAgentConnector_ms": 0.15668392181396484}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 123.05067994508477, "num_env_steps_trained_throughput_per_sec": 123.05067994508477, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 35773.245, "sample_time_ms": 20807.222, "learn_time_ms": 14888.494, "learn_throughput": 268.664, "synch_weights_time_ms": 76.659}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 5605, "training_iteration": 56, "trial_id": "3c06e_00000", "date": "2023-09-12_14-59-42", "timestamp": 1694545182, "time_this_iter_s": 32.521870136260986, "time_total_s": 1824.1908118724823, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147ba7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1824.1908118724823, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 29.593617021276593, "ram_util_percent": 24.661702127659577}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8763412880400816, "cur_kl_coeff": 0.21357421874999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00031336852528814535, "policy_loss": -0.05498293770045469, "vf_loss": 0.04013920872869979, "vf_explained_var": 0.8560319232443968, "kl": 0.07096875958977325, "entropy": 0.6898827280849218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.1917843750000001, "episode_reward_mean": 1.478987679303279, "episode_len_mean": 29.25409836065574, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {"red_0": 1.1917843750000001}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.478987679303279}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.201828125, 1.4744375, 1.4887000000000001, 1.489453125, 1.48438125, 1.489453125, 1.489453125, 1.489453125, 1.48729375, 1.489453125, 1.486540625, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.489453125, 1.489453125, 1.4879968749999999, 1.489453125, 1.489453125, 1.450384375, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4871937499999999, 1.489453125, 1.489453125, 1.489453125, 1.1917843750000001, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.4879968749999999, 1.3019, 1.489453125, 1.48875, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.4879968749999999, 1.489453125, 1.487946875, 1.485234375, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.4887000000000001, 1.48438125, 1.48875, 1.3981656249999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48448125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.4879968749999999, 1.4887000000000001, 1.489453125, 1.489453125, 1.484984375, 1.489453125, 1.489453125, 1.4856875, 1.215653125, 1.489453125, 1.48875, 1.4859375, 1.488046875, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.483678125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.485234375, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [407, 36, 16, 15, 22, 15, 15, 15, 18, 15, 19, 16, 15, 15, 15, 15, 15, 17, 15, 15, 17, 15, 15, 69, 15, 16, 15, 16, 15, 16, 15, 15, 15, 16, 15, 18, 15, 15, 15, 421, 15, 16, 15, 16, 15, 15, 15, 16, 15, 16, 15, 15, 15, 16, 16, 16, 15, 16, 16, 15, 15, 16, 17, 272, 15, 16, 16, 16, 15, 17, 15, 17, 21, 18, 15, 15, 15, 15, 17, 16, 22, 16, 139, 15, 15, 15, 15, 15, 16, 22, 16, 16, 15, 15, 17, 16, 15, 15, 21, 15, 15, 20, 383, 15, 16, 20, 17, 16, 15, 15, 16, 23, 15, 15, 16, 15, 15, 17, 21, 15, 15, 15], "policy_red_0_reward": [1.201828125, 1.4744375, 1.4887000000000001, 1.489453125, 1.48438125, 1.489453125, 1.489453125, 1.489453125, 1.48729375, 1.489453125, 1.486540625, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.489453125, 1.489453125, 1.4879968749999999, 1.489453125, 1.489453125, 1.450384375, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4871937499999999, 1.489453125, 1.489453125, 1.489453125, 1.1917843750000001, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.4879968749999999, 1.3019, 1.489453125, 1.48875, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.4879968749999999, 1.489453125, 1.487946875, 1.485234375, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.4887000000000001, 1.48438125, 1.48875, 1.3981656249999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48448125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.4879968749999999, 1.4887000000000001, 1.489453125, 1.489453125, 1.484984375, 1.489453125, 1.489453125, 1.4856875, 1.215653125, 1.489453125, 1.48875, 1.4859375, 1.488046875, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.483678125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.485234375, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510713164755202, "mean_inference_ms": 3.701505908085759, "mean_action_processing_ms": 0.20832670346651316, "mean_env_wait_ms": 0.25671816331695413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09307196882904553, "StateBufferConnector_ms": 0.008014381908979571, "ViewRequirementAgentConnector_ms": 0.15365921083043832}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.1917843750000001, "episode_reward_mean": 1.478987679303279, "episode_len_mean": 29.25409836065574, "episodes_this_iter": 122, "policy_reward_min": {"red_0": 1.1917843750000001}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.478987679303279}, "hist_stats": {"episode_reward": [1.201828125, 1.4744375, 1.4887000000000001, 1.489453125, 1.48438125, 1.489453125, 1.489453125, 1.489453125, 1.48729375, 1.489453125, 1.486540625, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.489453125, 1.489453125, 1.4879968749999999, 1.489453125, 1.489453125, 1.450384375, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4871937499999999, 1.489453125, 1.489453125, 1.489453125, 1.1917843750000001, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.4879968749999999, 1.3019, 1.489453125, 1.48875, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.4879968749999999, 1.489453125, 1.487946875, 1.485234375, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.4887000000000001, 1.48438125, 1.48875, 1.3981656249999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48448125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.4879968749999999, 1.4887000000000001, 1.489453125, 1.489453125, 1.484984375, 1.489453125, 1.489453125, 1.4856875, 1.215653125, 1.489453125, 1.48875, 1.4859375, 1.488046875, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.483678125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.485234375, 1.489453125, 1.489453125, 1.489453125], "episode_lengths": [407, 36, 16, 15, 22, 15, 15, 15, 18, 15, 19, 16, 15, 15, 15, 15, 15, 17, 15, 15, 17, 15, 15, 69, 15, 16, 15, 16, 15, 16, 15, 15, 15, 16, 15, 18, 15, 15, 15, 421, 15, 16, 15, 16, 15, 15, 15, 16, 15, 16, 15, 15, 15, 16, 16, 16, 15, 16, 16, 15, 15, 16, 17, 272, 15, 16, 16, 16, 15, 17, 15, 17, 21, 18, 15, 15, 15, 15, 17, 16, 22, 16, 139, 15, 15, 15, 15, 15, 16, 22, 16, 16, 15, 15, 17, 16, 15, 15, 21, 15, 15, 20, 383, 15, 16, 20, 17, 16, 15, 15, 16, 23, 15, 15, 16, 15, 15, 17, 21, 15, 15, 15], "policy_red_0_reward": [1.201828125, 1.4744375, 1.4887000000000001, 1.489453125, 1.48438125, 1.489453125, 1.489453125, 1.489453125, 1.48729375, 1.489453125, 1.486540625, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.489453125, 1.489453125, 1.4879968749999999, 1.489453125, 1.489453125, 1.450384375, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.4871937499999999, 1.489453125, 1.489453125, 1.489453125, 1.1917843750000001, 1.489453125, 1.48875, 1.489453125, 1.4887000000000001, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.4887000000000001, 1.4879968749999999, 1.3019, 1.489453125, 1.48875, 1.4887000000000001, 1.4887000000000001, 1.489453125, 1.4879968749999999, 1.489453125, 1.487946875, 1.485234375, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.487946875, 1.4887000000000001, 1.48438125, 1.48875, 1.3981656249999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4887000000000001, 1.48448125, 1.4887000000000001, 1.48875, 1.489453125, 1.489453125, 1.4879968749999999, 1.4887000000000001, 1.489453125, 1.489453125, 1.484984375, 1.489453125, 1.489453125, 1.4856875, 1.215653125, 1.489453125, 1.48875, 1.4859375, 1.488046875, 1.4887000000000001, 1.489453125, 1.489453125, 1.48875, 1.483678125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.485234375, 1.489453125, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510713164755202, "mean_inference_ms": 3.701505908085759, "mean_action_processing_ms": 0.20832670346651316, "mean_env_wait_ms": 0.25671816331695413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09307196882904553, "StateBufferConnector_ms": 0.008014381908979571, "ViewRequirementAgentConnector_ms": 0.15365921083043832}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 120.76925418067009, "num_env_steps_trained_throughput_per_sec": 120.76925418067009, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 35599.619, "sample_time_ms": 20515.475, "learn_time_ms": 15005.308, "learn_throughput": 266.572, "synch_weights_time_ms": 77.956}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 5727, "training_iteration": 57, "trial_id": "3c06e_00000", "date": "2023-09-12_15-00-15", "timestamp": 1694545215, "time_this_iter_s": 33.13912868499756, "time_total_s": 1857.3299405574799, "pid": 24535, "hostname": "str-win-3219", "node_ip": "172.26.127.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 5e-05}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7fdc147b7eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1857.3299405574799, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 30.3875, "ram_util_percent": 24.739583333333332}}
